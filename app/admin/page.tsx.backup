'use client'

import { useState, useEffect } from 'react'
import { useRouter } from 'next/navigation'
import {
  BuildingOfficeIcon,
  HomeModernIcon,
  HomeIcon,
  MapIcon,
  BuildingStorefrontIcon,
  SparklesIcon,
  CubeIcon,
  WrenchScrewdriverIcon,
  TruckIcon,
  ShoppingBagIcon,
  PlusIcon,
  PencilIcon,
  TrashIcon,
  EyeIcon,
  Bars3Icon,
  LinkIcon,
  ChevronUpIcon,
  ChevronDownIcon,
  ChevronRightIcon,
  XMarkIcon,
  ChatBubbleLeftRightIcon,
  BriefcaseIcon,
  CurrencyDollarIcon,
  PaperClipIcon,
  ArrowDownTrayIcon,
  EnvelopeIcon,
  EnvelopeOpenIcon,
  ClockIcon,
  MagnifyingGlassIcon,
} from '@heroicons/react/24/outline'
import PropertyForm from '@/components/PropertyForm'
import NavItemForm from '@/components/NavItemForm'
import CategoryForm from '@/components/CategoryForm'
import UserForm from '@/components/UserForm'
import Dashboard from '@/components/admin/Dashboard'
import Properties from '@/components/admin/Properties'
import Reports from '@/components/admin/Reports'
import Settings from '@/components/admin/Settings'
import System from '@/components/admin/System'
import SEO from '@/components/admin/SEO'
import { useAuth } from '@/contexts/AuthContext'
import { supabase } from '@/lib/supabase'

const propertyCategories = [
  {
    id: 'apartment',
    name: 'Apartment',
    icon: 'BuildingOfficeIcon',
    description: 'Residential apartments and flats',
    count: 12,
    color: 'blue',
    isActive: true,
    order: 1,
  },
  {
    id: 'villa',
    name: 'Villa',
    icon: 'HomeModernIcon',
    description: 'Luxury villas and mansions',
    count: 12,
    color: 'green',
    isActive: true,
    order: 2,
  },
  {
    id: 'townhouse',
    name: 'Townhouse',
    icon: 'HomeIcon',
    description: 'Premium townhouses',
    count: 12,
    color: 'yellow',
    isActive: true,
    order: 3,
  },
  {
    id: 'furnished-studio',
    name: 'Furnished Studio',
    icon: 'SparklesIcon',
    description: 'Fully furnished studio apartments',
    count: 12,
    color: 'purple',
    isActive: true,
    order: 4,
  },
  {
    id: 'residential-plot',
    name: 'Residential Plot',
    icon: 'MapIcon',
    description: 'Land plots for residential development',
    count: 12,
    color: 'orange',
    isActive: true,
    order: 5,
  },
  {
    id: 'commercial-plot',
    name: 'Commercial Plot',
    icon: 'MapIcon',
    description: 'Land plots for commercial development',
    count: 4,
    color: 'red',
    isActive: true,
    order: 6,
  },
  {
    id: 'industrial-plot',
    name: 'Industrial Plot',
    icon: 'BuildingStorefrontIcon',
    description: 'Land plots for industrial use',
    count: 1,
    color: 'indigo',
    isActive: false,
    order: 7,
  },
  {
    id: 'commercial',
    name: 'Commercial Property',
    icon: 'BuildingStorefrontIcon',
    description: 'Office spaces and retail properties',
    count: 5,
    color: 'pink',
    isActive: true,
    order: 8,
  },
]

const mockProperties = [
  {
    id: '1',
    title: 'Premium Residential Plot in Emirates Hills',
    category: 'residential-plot',
    price: 15000000,
    location: 'Emirates Hills, Dubai',
    status: 'active',
    featured: true,
    beds: 0,
    baths: 0,
    sqft: 10000,
    images: ['https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=800'],
    description: 'Prime residential plot in the prestigious Emirates Hills development.',
    type: 'sale',
    currency: 'AED',
    createdAt: '2024-12-01',
    updatedAt: '2024-12-05',
    views: 245,
    inquiries: 12,
  },
  {
    id: '2',
    title: 'Luxury 3BR Apartment in Downtown Dubai',
    category: 'apartment',
    price: 8500000,
    location: 'Downtown Dubai',
    status: 'active',
    featured: true,
    beds: 3,
    baths: 2,
    sqft: 1800,
    images: [
      'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=800',
      'https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=800'
    ],
    description: 'Stunning 3BR apartment with Burj Khalifa views in the heart of Dubai.',
    type: 'sale',
    currency: 'AED',
    createdAt: '2024-11-28',
    updatedAt: '2024-12-03',
    views: 189,
    inquiries: 8,
  },
  {
    id: '3',
    title: 'Executive Villa in Arabian Ranches',
    category: 'villa',
    price: 25000000,
    location: 'Arabian Ranches, Dubai',
    status: 'active',
    featured: false,
    beds: 5,
    baths: 4,
    sqft: 4500,
    images: [
      'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=800',
      'https://images.unsplash.com/photo-1600566753190-17f0baa2a6c3?w=800',
      'https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?w=800'
    ],
    description: 'Luxurious 5BR villa with private garden and swimming pool.',
    type: 'sale',
    currency: 'AED',
    createdAt: '2024-11-25',
    updatedAt: '2024-12-01',
    views: 156,
    inquiries: 6,
  },
  {
    id: '4',
    title: 'Modern 2BR Apartment for Rent',
    category: 'apartment',
    price: 120000,
    location: 'Jumeirah Beach Residence, Dubai',
    status: 'active',
    featured: true,
    beds: 2,
    baths: 2,
    sqft: 1200,
    images: ['https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800'],
    description: 'Fully furnished 2BR apartment with sea views.',
    type: 'rent',
    currency: 'AED',
    createdAt: '2024-12-02',
    updatedAt: '2024-12-04',
    views: 98,
    inquiries: 15,
  },
  {
    id: '5',
    title: 'Commercial Office Space in Business Bay',
    category: 'commercial',
    price: 500000,
    location: 'Business Bay, Dubai',
    status: 'pending',
    featured: false,
    beds: 0,
    baths: 2,
    sqft: 2500,
    images: ['https://images.unsplash.com/photo-1497366216548-37526070297c?w=800'],
    description: 'Prime commercial office space with modern amenities.',
    type: 'rent',
    currency: 'AED',
    createdAt: '2024-12-03',
    updatedAt: '2024-12-03',
    views: 67,
    inquiries: 3,
  },
]

export default function AdminPage() {
  const router = useRouter()
  const { user, profile, loading, signOut } = useAuth()
  const [activeTab, setActiveTab] = useState('dashboard')
  const [showAddProperty, setShowAddProperty] = useState(false)
  const [selectedCategory, setSelectedCategory] = useState('')
  const [editingProperty, setEditingProperty] = useState<any>(null)

  // Enhanced Properties Management State
  const [properties, setProperties] = useState(mockProperties)
  const [filteredProperties, setFilteredProperties] = useState(mockProperties)
  const [searchTerm, setSearchTerm] = useState('')
  const [statusFilter, setStatusFilter] = useState('all')
  const [categoryFilter, setCategoryFilter] = useState('all')
  const [typeFilter, setTypeFilter] = useState('all')
  const [sortBy, setSortBy] = useState('updatedAt')
  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc')
  const [currentPage, setCurrentPage] = useState(1)
  const [itemsPerPage] = useState(10)
  const [selectedProperties, setSelectedProperties] = useState<string[]>([])
  const [showBulkActions, setShowBulkActions] = useState(false)
  const [showPropertyDetails, setShowPropertyDetails] = useState(false)
  const [selectedPropertyDetails, setSelectedPropertyDetails] = useState<any>(null)
  // Enhanced Categories Management State
  const [categories, setCategories] = useState(propertyCategories)
  const [showAddCategory, setShowAddCategory] = useState(false)
  const [editingCategory, setEditingCategory] = useState<any>(null)
  const [showCategoryDetails, setShowCategoryDetails] = useState(false)
  const [selectedCategoryDetails, setSelectedCategoryDetails] = useState<any>(null)

  // Users Management State
  const [users, setUsers] = useState<any[]>([
    {
      id: '1',
      name: 'Ahmed Al-Rashid',
      email: 'ahmed.alrashid@email.com',
      phone: '+971 50 123 4567',
      role: 'customer',
      status: 'active',
      avatar: 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100',
      location: 'Dubai Marina, Dubai',
      joinDate: '2024-01-15',
      lastLogin: '2024-12-06',
      totalInquiries: 12,
      totalFavorites: 8,
      verified: true,
      preferences: {
        propertyTypes: ['Apartment', 'Villa'],
        priceRange: { min: 1000000, max: 5000000 },
        locations: ['Dubai Marina', 'Jumeirah']
      },
      createdAt: '2024-01-15',
      updatedAt: '2024-12-06'
    },
    {
      id: '2',
      name: 'Fatima Al-Zahra',
      email: 'fatima.alzahra@email.com',
      phone: '+971 55 987 6543',
      role: 'agent',
      status: 'active',
      avatar: 'https://images.unsplash.com/photo-1494790108755-2616b612b786?w=100',
      location: 'Business Bay, Dubai',
      joinDate: '2024-02-20',
      lastLogin: '2024-12-05',
      totalInquiries: 45,
      totalFavorites: 0,
      verified: true,
      agency: 'Dubai Luxury Realty',
      licenseNumber: 'AGT-2024-001',
      specialties: ['Luxury Properties', 'Investment Properties'],
      createdAt: '2024-02-20',
      updatedAt: '2024-12-05'
    },
    {
      id: '3',
      name: 'Mohammed Al-Mansoori',
      email: 'mohammed.almansoori@email.com',
      phone: '+971 52 456 7890',
      role: 'customer',
      status: 'inactive',
      avatar: 'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=100',
      location: 'Jumeirah, Dubai',
      joinDate: '2024-03-10',
      lastLogin: '2024-11-15',
      totalInquiries: 3,
      totalFavorites: 15,
      verified: false,
      preferences: {
        propertyTypes: ['Townhouse', 'Villa'],
        priceRange: { min: 2000000, max: 8000000 },
        locations: ['Jumeirah', 'Palm Jumeirah']
      },
      createdAt: '2024-03-10',
      updatedAt: '2024-11-15'
    },
    {
      id: '4',
      name: 'Sarah Johnson',
      email: 'sarah.johnson@email.com',
      phone: '+971 58 321 0987',
      role: 'customer',
      status: 'active',
      avatar: 'https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=100',
      location: 'Dubai Silicon Oasis',
      joinDate: '2024-04-05',
      lastLogin: '2024-12-06',
      totalInquiries: 8,
      totalFavorites: 22,
      verified: true,
      preferences: {
        propertyTypes: ['Apartment', 'Penthouse'],
        priceRange: { min: 1500000, max: 10000000 },
        locations: ['Dubai Marina', 'Business Bay']
      },
      createdAt: '2024-04-05',
      updatedAt: '2024-12-06'
    },
    {
      id: '5',
      name: 'Omar Al-Khalidi',
      email: 'omar.alkhalidi@email.com',
      phone: '+971 56 654 3210',
      role: 'agent',
      status: 'active',
      avatar: 'https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=100',
      location: 'Al Barsha, Dubai',
      joinDate: '2024-05-12',
      lastLogin: '2024-12-04',
      totalInquiries: 67,
      totalFavorites: 0,
      verified: true,
      agency: 'Emirates Property Group',
      licenseNumber: 'AGT-2024-015',
      specialties: ['Commercial Properties', 'Office Spaces'],
      createdAt: '2024-05-12',
      updatedAt: '2024-12-04'
    },
    {
      id: '6',
      name: 'Layla Al-Hamad',
      email: 'layla.alhamad@email.com',
      phone: '+971 50 789 0123',
      role: 'customer',
      status: 'pending',
      avatar: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=100',
      location: 'Dubai Festival City',
      joinDate: '2024-11-28',
      lastLogin: null,
      totalInquiries: 0,
      totalFavorites: 0,
      verified: false,
      preferences: {
        propertyTypes: ['Apartment'],
        priceRange: { min: 800000, max: 3000000 },
        locations: ['Dubai Festival City', 'Dubai Silicon Oasis']
      },
      createdAt: '2024-11-28',
      updatedAt: '2024-11-28'
    }
  ])
  const [filteredUsers, setFilteredUsers] = useState<any[]>([])
  const [userSearchTerm, setUserSearchTerm] = useState('')
  const [userRoleFilter, setUserRoleFilter] = useState('all')
  const [userStatusFilter, setUserStatusFilter] = useState('all')
  const [userSortBy, setUserSortBy] = useState('joinDate')
  const [userSortOrder, setUserSortOrder] = useState<'asc' | 'desc'>('desc')
  const [userCurrentPage, setUserCurrentPage] = useState(1)
  const [userItemsPerPage] = useState(10)
  const [selectedUsers, setSelectedUsers] = useState<string[]>([])
  const [showUserBulkActions, setShowUserBulkActions] = useState(false)
  const [showAddUser, setShowAddUser] = useState(false)
  const [editingUser, setEditingUser] = useState<any>(null)
  const [showUserDetails, setShowUserDetails] = useState(false)
  const [selectedUserDetails, setSelectedUserDetails] = useState<any>(null)

  // Forms Management State
  const [formSubmissions, setFormSubmissions] = useState<any[]>([
    {
      id: '1',
      name: 'Ahmed Al-Rashid',
      email: 'ahmed.alrashid@email.com',
      phone: '+971 50 123 4567',
      formType: 'contact',
      subject: 'Property Inquiry - Dubai Marina',
      message: 'I am interested in luxury apartments in Dubai Marina. Please provide more information about availability and pricing. I would like to schedule a viewing for next week.',
      status: 'unread',
      priority: 'normal',
      date: '2024-12-06',
      readAt: null,
      respondedAt: null,
      response: '',
      attachments: [],
      ipAddress: '192.168.1.100',
      userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',
      source: 'website',
      additionalData: {
        propertyType: 'Apartment',
        budget: '2M-5M',
        timeline: 'Within 3 months'
      },
      createdAt: '2024-12-06T10:30:00Z',
      updatedAt: '2024-12-06T10:30:00Z'
    },
    {
      id: '2',
      name: 'Sarah Johnson',
      email: 'sarah.johnson@email.com',
      phone: '+971 58 321 0987',
      formType: 'career',
      subject: 'Real Estate Agent Position Application',
      message: 'I have 5 years of experience in luxury real estate sales in London and Dubai. I am RERA licensed and have a proven track record of closing AED 50M+ in transactions annually.',
      status: 'read',
      priority: 'high',
      date: '2024-12-05',
      readAt: '2024-12-05T14:20:00Z',
      respondedAt: '2024-12-05T16:45:00Z',
      response: 'Thank you for your application. We are impressed with your experience. We will contact you within 48 hours for an interview.',
      attachments: ['CV_Sarah_Johnson.pdf', 'Portfolio_Sarah_Johnson.pdf'],
      ipAddress: '192.168.1.101',
      userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
      source: 'website',
      additionalData: {
        experience: '5 years',
        currentLocation: 'Dubai',
        expectedSalary: 'AED 25,000-35,000',
        availability: 'Immediate'
      },
      createdAt: '2024-12-05T09:15:00Z',
      updatedAt: '2024-12-05T16:45:00Z'
    },
    {
      id: '3',
      name: 'Mohammed Al-Khalidi',
      email: 'mohammed.alkhalidi@email.com',
      phone: '+971 52 456 7890',
      formType: 'valuation',
      subject: 'Villa Valuation Request - Emirates Hills',
      message: 'I need a professional valuation for my villa in Emirates Hills. The property is 5,000 sq ft with 6 bedrooms, 7 bathrooms, private pool, and garden. Built in 2018.',
      status: 'unread',
      priority: 'normal',
      date: '2024-12-04',
      readAt: null,
      respondedAt: null,
      response: '',
      attachments: ['villa_photos.zip'],
      ipAddress: '192.168.1.102',
      userAgent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15',
      source: 'mobile_app',
      additionalData: {
        propertyType: 'Villa',
        location: 'Emirates Hills',
        size: '5000 sqft',
        bedrooms: 6,
        bathrooms: 7,
        yearBuilt: 2018,
        purpose: 'Sale'
      },
      createdAt: '2024-12-04T16:22:00Z',
      updatedAt: '2024-12-04T16:22:00Z'
    },
    {
      id: '4',
      name: 'Fatima Al-Zahra',
      email: 'fatima.alzahra@email.com',
      phone: '+971 55 987 6543',
      formType: 'contact',
      subject: 'Investment Consultation Request',
      message: 'I am looking to invest AED 10M+ in Dubai real estate. Can you arrange a consultation to discuss investment opportunities in the current market?',
      status: 'read',
      priority: 'high',
      date: '2024-12-03',
      readAt: '2024-12-03T11:30:00Z',
      respondedAt: '2024-12-03T15:20:00Z',
      response: 'Thank you for your interest in Dubai real estate investment. Our investment specialist will contact you tomorrow at 2 PM to discuss opportunities.',
      attachments: [],
      ipAddress: '192.168.1.103',
      userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',
      source: 'website',
      additionalData: {
        investmentAmount: '10M+',
        investmentType: 'Real Estate',
        timeline: 'Within 6 months',
        preferredAreas: ['Business Bay', 'Dubai Marina', 'Palm Jumeirah']
      },
      createdAt: '2024-12-03T10:45:00Z',
      updatedAt: '2024-12-03T15:20:00Z'
    },
    {
      id: '5',
      name: 'David Chen',
      email: 'david.chen@email.com',
      phone: '+971 50 789 0123',
      formType: 'property_inquiry',
      subject: 'Commercial Office Space in Business Bay',
      message: 'Looking for office spaces in Business Bay for our tech startup. We need 2,000-3,000 sq ft with modern amenities. Budget up to AED 500K annually.',
      status: 'unread',
      priority: 'normal',
      date: '2024-12-02',
      readAt: null,
      respondedAt: null,
      response: '',
      attachments: ['company_profile.pdf'],
      ipAddress: '192.168.1.104',
      userAgent: 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36',
      source: 'website',
      additionalData: {
        propertyType: 'Office',
        location: 'Business Bay',
        size: '2000-3000 sqft',
        budget: 'AED 500K annually',
        requirements: ['Modern amenities', 'Parking', 'Meeting rooms']
      },
      createdAt: '2024-12-02T14:10:00Z',
      updatedAt: '2024-12-02T14:10:00Z'
    },
    {
      id: '6',
      name: 'Layla Al-Hamad',
      email: 'layla.alhamad@email.com',
      phone: '+971 56 654 3210',
      formType: 'contact',
      subject: 'Mortgage Consultation',
      message: 'I am interested in purchasing my first property in Dubai. I need information about mortgage options and the application process.',
      status: 'read',
      priority: 'normal',
      date: '2024-12-01',
      readAt: '2024-12-01T09:15:00Z',
      respondedAt: '2024-12-01T11:30:00Z',
      response: 'Thank you for your inquiry. Our mortgage specialist will provide you with detailed information about financing options in Dubai.',
      attachments: [],
      ipAddress: '192.168.1.105',
      userAgent: 'Mozilla/5.0 (Android 13; Mobile) AppleWebKit/537.36',
      source: 'mobile_app',
      additionalData: {
        propertyType: 'First Home',
        financingNeeded: 'Yes',
        nationality: 'UAE Citizen',
        downPayment: '20%'
      },
      createdAt: '2024-12-01T08:30:00Z',
      updatedAt: '2024-12-01T11:30:00Z'
    },
    {
      id: '7',
      name: 'Robert Thompson',
      email: 'robert.thompson@email.com',
      phone: '+971 58 123 4567',
      formType: 'career',
      subject: 'Property Management Position',
      message: 'Experienced property manager with 8 years in luxury residential and commercial properties. Currently managing a portfolio worth AED 200M.',
      status: 'unread',
      priority: 'normal',
      date: '2024-11-30',
      readAt: null,
      respondedAt: null,
      response: '',
      attachments: ['CV_Robert_Thompson.pdf', 'References.pdf'],
      ipAddress: '192.168.1.106',
      userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36',
      source: 'website',
      additionalData: {
        position: 'Property Manager',
        experience: '8 years',
        portfolioValue: 'AED 200M',
        certifications: ['CPM', 'RERA License']
      },
      createdAt: '2024-11-30T13:45:00Z',
      updatedAt: '2024-11-30T13:45:00Z'
    },
    {
      id: '8',
      name: 'Amira Hassan',
      email: 'amira.hassan@email.com',
      phone: '+971 52 987 6543',
      formType: 'valuation',
      subject: 'Apartment Valuation - Jumeirah Beach Residence',
      message: 'Need valuation for a 2BR apartment in JBR. 1,200 sq ft, sea view, furnished. Purchased in 2020 for AED 2.5M.',
      status: 'read',
      priority: 'normal',
      date: '2024-11-29',
      readAt: '2024-11-29T10:20:00Z',
      respondedAt: '2024-11-29T14:15:00Z',
      response: 'Our valuation team will assess your property and provide a detailed report within 48 hours.',
      attachments: ['apartment_photos.zip'],
      ipAddress: '192.168.1.107',
      userAgent: 'Mozilla/5.0 (iPhone; CPU iPhone OS 17_0 like Mac OS X) AppleWebKit/605.1.15',
      source: 'mobile_app',
      additionalData: {
        propertyType: 'Apartment',
        location: 'Jumeirah Beach Residence',
        size: '1200 sqft',
        bedrooms: 2,
        purchasePrice: 'AED 2.5M',
        purchaseYear: 2020,
        view: 'Sea View'
      },
      createdAt: '2024-11-29T09:00:00Z',
      updatedAt: '2024-11-29T14:15:00Z'
    }
  ])
  const [filteredFormSubmissions, setFilteredFormSubmissions] = useState<any[]>([])
  const [formSearchTerm, setFormSearchTerm] = useState('')
  const [formTypeFilter, setFormTypeFilter] = useState('all')
  const [formStatusFilter, setFormStatusFilter] = useState('all')
  const [formPriorityFilter, setFormPriorityFilter] = useState('all')
  const [formSortBy, setFormSortBy] = useState('date')
  const [formSortOrder, setFormSortOrder] = useState<'asc' | 'desc'>('desc')
  const [formCurrentPage, setFormCurrentPage] = useState(1)
  const [formItemsPerPage, setFormItemsPerPage] = useState(10)
  const [selectedFormSubmissions, setSelectedFormSubmissions] = useState<string[]>([])
  const [showFormBulkActions, setShowFormBulkActions] = useState(false)
  const [showFormDetails, setShowFormDetails] = useState(false)
  const [selectedFormDetails, setSelectedFormDetails] = useState<any>(null)
  const [showResponseForm, setShowResponseForm] = useState(false)
  const [responseText, setResponseText] = useState('')
  const [responseSubmissionId, setResponseSubmissionId] = useState<string>('')

  // Content Management State
  const [articles, setArticles] = useState<any[]>([
    {
      id: '1',
      title: 'Dubai Marina Market Update - December 2025',
      slug: 'dubai-marina-market-update-december-2025',
      content: 'The Dubai Marina real estate market continues to show strong growth...',
      excerpt: 'Latest market analysis and trends in Dubai Marina property market.',
      category: 'Market Updates',
      tags: ['Dubai Marina', 'Market Analysis', '2025'],
      status: 'published',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=800',
      publishedAt: '2025-12-01T10:00:00Z',
      updatedAt: '2025-12-01T10:00:00Z',
      views: 1247,
      likes: 89,
      comments: 23,
      seoTitle: 'Dubai Marina Market Update December 2025 | Latest Real Estate Trends',
      seoDescription: 'Comprehensive market analysis of Dubai Marina real estate market for December 2025. Property prices, trends, and investment opportunities.',
      seoKeywords: 'Dubai Marina, real estate market, property prices, investment',
      readingTime: 5,
      isFeatured: true
    },
    {
      id: '2',
      title: 'Palm Jumeirah Investment Guide 2025',
      slug: 'palm-jumeirah-investment-guide-2025',
      content: 'Palm Jumeirah remains one of Dubai\'s most prestigious addresses...',
      excerpt: 'Complete investment guide for Palm Jumeirah properties.',
      category: 'Investment Guides',
      tags: ['Palm Jumeirah', 'Investment', 'Luxury'],
      status: 'published',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=800',
      publishedAt: '2025-11-28T14:30:00Z',
      updatedAt: '2025-11-28T14:30:00Z',
      views: 2156,
      likes: 156,
      comments: 45,
      seoTitle: 'Palm Jumeirah Investment Guide 2025 | Luxury Property Investment',
      seoDescription: 'Expert guide to investing in Palm Jumeirah properties. Market analysis, ROI expectations, and buying strategies.',
      seoKeywords: 'Palm Jumeirah, investment, luxury property, ROI',
      readingTime: 8,
      isFeatured: true
    },
    {
      id: '3',
      title: 'Commercial Property Trends in Dubai',
      slug: 'commercial-property-trends-dubai',
      content: 'The commercial real estate sector in Dubai is undergoing significant transformation...',
      excerpt: 'Analysis of current commercial property market trends.',
      category: 'Market Updates',
      tags: ['Commercial', 'Dubai', 'Trends'],
      status: 'published',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800',
      publishedAt: '2025-11-25T09:15:00Z',
      updatedAt: '2025-11-25T09:15:00Z',
      views: 892,
      likes: 67,
      comments: 12,
      seoTitle: 'Commercial Property Trends in Dubai 2025 | Market Analysis',
      seoDescription: 'Latest trends and insights in Dubai\'s commercial real estate market.',
      seoKeywords: 'commercial property, Dubai, market trends',
      readingTime: 6,
      isFeatured: false
    },
    {
      id: '4',
      title: 'Luxury Villa Market Analysis',
      slug: 'luxury-villa-market-analysis',
      content: 'Luxury villas continue to be a cornerstone of Dubai\'s high-end real estate market...',
      excerpt: 'Comprehensive analysis of the luxury villa market.',
      category: 'Market Updates',
      tags: ['Villas', 'Luxury', 'Market Analysis'],
      status: 'draft',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=800',
      publishedAt: null,
      updatedAt: '2025-12-05T16:45:00Z',
      views: 0,
      likes: 0,
      comments: 0,
      seoTitle: 'Luxury Villa Market Analysis Dubai 2025',
      seoDescription: 'In-depth analysis of Dubai\'s luxury villa market trends and pricing.',
      seoKeywords: 'luxury villas, Dubai, market analysis',
      readingTime: 7,
      isFeatured: false
    }
  ])

  const [guides, setGuides] = useState<any[]>([
    {
      id: '1',
      title: 'Buying Property in Dubai: Complete Guide',
      slug: 'buying-property-dubai-complete-guide',
      content: 'This comprehensive guide covers everything you need to know about buying property in Dubai...',
      excerpt: 'Everything you need to know about purchasing property in Dubai.',
      category: 'Buying',
      tags: ['Buying', 'Guide', 'Dubai'],
      status: 'published',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=800',
      publishedAt: '2025-10-15T11:00:00Z',
      updatedAt: '2025-10-15T11:00:00Z',
      reads: 2341,
      downloads: 456,
      rating: 4.8,
      seoTitle: 'Buying Property in Dubai: Complete Guide 2025',
      seoDescription: 'Comprehensive guide to buying property in Dubai. Legal requirements, taxes, and step-by-step process.',
      seoKeywords: 'buying property, Dubai, guide, real estate',
      readingTime: 12,
      isFeatured: true
    },
    {
      id: '2',
      title: 'Mortgage Calculator Guide',
      slug: 'mortgage-calculator-guide',
      content: 'Understanding mortgage calculations is crucial for property buyers...',
      excerpt: 'How to use mortgage calculators and understand financing options.',
      category: 'Finance',
      tags: ['Mortgage', 'Calculator', 'Finance'],
      status: 'published',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=800',
      publishedAt: '2025-11-01T13:20:00Z',
      updatedAt: '2025-11-01T13:20:00Z',
      reads: 1876,
      downloads: 234,
      rating: 4.6,
      seoTitle: 'Mortgage Calculator Guide Dubai | Property Financing',
      seoDescription: 'Complete guide to using mortgage calculators and understanding property financing in Dubai.',
      seoKeywords: 'mortgage calculator, Dubai, property finance',
      readingTime: 8,
      isFeatured: false
    },
    {
      id: '3',
      title: 'Area Guide: Dubai Marina',
      slug: 'area-guide-dubai-marina',
      content: 'Dubai Marina is one of the most sought-after residential and commercial districts...',
      excerpt: 'Complete guide to living and investing in Dubai Marina.',
      category: 'Areas',
      tags: ['Dubai Marina', 'Area Guide', 'Lifestyle'],
      status: 'published',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?w=800',
      publishedAt: '2025-11-10T10:30:00Z',
      updatedAt: '2025-11-10T10:30:00Z',
      reads: 1456,
      downloads: 189,
      rating: 4.7,
      seoTitle: 'Dubai Marina Area Guide 2025 | Living & Investment',
      seoDescription: 'Comprehensive guide to Dubai Marina - lifestyle, amenities, property market, and investment opportunities.',
      seoKeywords: 'Dubai Marina, area guide, lifestyle, investment',
      readingTime: 10,
      isFeatured: true
    },
    {
      id: '4',
      title: 'Selling Your Property in Dubai',
      slug: 'selling-property-dubai-guide',
      content: 'Selling property in Dubai requires careful planning and market knowledge...',
      excerpt: 'Step-by-step guide to selling your property in Dubai.',
      category: 'Selling',
      tags: ['Selling', 'Guide', 'Dubai'],
      status: 'draft',
      author: 'Dubai Luxury Realty',
      featuredImage: 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=800',
      publishedAt: null,
      updatedAt: '2025-12-06T09:00:00Z',
      reads: 0,
      downloads: 0,
      rating: 0,
      seoTitle: 'Selling Property in Dubai: Complete Guide 2025',
      seoDescription: 'Expert guide to selling property in Dubai. Marketing strategies, pricing, and legal requirements.',
      seoKeywords: 'selling property, Dubai, guide, real estate',
      readingTime: 9,
      isFeatured: false
    }
  ])

  const [contentType, setContentType] = useState<'articles' | 'guides'>('articles')
  const [contentSearchTerm, setContentSearchTerm] = useState('')
  const [contentStatusFilter, setContentStatusFilter] = useState('all')
  const [contentCategoryFilter, setContentCategoryFilter] = useState('all')
  const [contentSortBy, setContentSortBy] = useState('updatedAt')
  const [contentSortOrder, setContentSortOrder] = useState<'asc' | 'desc'>('desc')
  const [selectedContent, setSelectedContent] = useState<any[]>([])
  const [showAddContent, setShowAddContent] = useState(false)
  const [showEditContent, setShowEditContent] = useState(false)
  const [editingContent, setEditingContent] = useState<any>(null)
  const [showContentDetails, setShowContentDetails] = useState(false)
  const [selectedContentDetails, setSelectedContentDetails] = useState<any>(null)
  const [contentCurrentPage, setContentCurrentPage] = useState(1)
  const [contentItemsPerPage, setContentItemsPerPage] = useState(10)

  // Content Management Functions
  const getFilteredContent = () => {
    const content = contentType === 'articles' ? articles : guides
    let filtered = [...content]

    if (contentSearchTerm) {
      filtered = filtered.filter(item =>
        item.title.toLowerCase().includes(contentSearchTerm.toLowerCase()) ||
        item.content.toLowerCase().includes(contentSearchTerm.toLowerCase()) ||
        item.tags.some((tag: string) => tag.toLowerCase().includes(contentSearchTerm.toLowerCase()))
      )
    }

    if (contentStatusFilter !== 'all') {
      filtered = filtered.filter(item => item.status === contentStatusFilter)
    }

    if (contentCategoryFilter !== 'all') {
      filtered = filtered.filter(item => item.category === contentCategoryFilter)
    }

    // Sort
    filtered.sort((a, b) => {
      let aValue: any, bValue: any

      if (contentSortBy === 'title') {
        aValue = a.title.toLowerCase()
        bValue = b.title.toLowerCase()
      } else if (contentSortBy === 'status') {
        aValue = a.status
        bValue = b.status
      } else if (contentSortBy === 'category') {
        aValue = a.category
        bValue = b.category
      } else if (contentSortBy === 'views' || contentSortBy === 'reads') {
        aValue = a[contentSortBy] || 0
        bValue = b[contentSortBy] || 0
      } else if (contentSortBy === 'updatedAt' || contentSortBy === 'publishedAt') {
        aValue = new Date(a[contentSortBy] || '2020-01-01').getTime()
        bValue = new Date(b[contentSortBy] || '2020-01-01').getTime()
      } else {
        aValue = a[contentSortBy]
        bValue = b[contentSortBy]
      }

      if (contentSortOrder === 'asc') {
        return aValue < bValue ? -1 : aValue > bValue ? 1 : 0
      } else {
        return aValue > bValue ? -1 : aValue < bValue ? 1 : 0
      }
    })

    return filtered
  }

  const handleAddContent = (contentData: any) => {
    const newContent = {
      ...contentData,
      id: Date.now().toString(),
      updatedAt: new Date().toISOString(),
      views: 0,
      reads: 0,
      likes: 0,
      comments: 0,
      downloads: 0,
      rating: 0
    }

    if (contentType === 'articles') {
      setArticles(prev => [newContent, ...prev])
    } else {
      setGuides(prev => [newContent, ...prev])
    }
  }

  const handleEditContent = (contentData: any) => {
    const updatedContent = {
      ...contentData,
      updatedAt: new Date().toISOString()
    }

    if (contentType === 'articles') {
      setArticles(prev => prev.map(item =>
        item.id === updatedContent.id ? updatedContent : item
      ))
    } else {
      setGuides(prev => prev.map(item =>
        item.id === updatedContent.id ? updatedContent : item
      ))
    }
  }

  const handleDeleteContent = (contentId: string) => {
    if (contentType === 'articles') {
      setArticles(prev => prev.filter(item => item.id !== contentId))
    } else {
      setGuides(prev => prev.filter(item => item.id !== contentId))
    }
  }

  const handleBulkDeleteContent = () => {
    if (contentType === 'articles') {
      setArticles(prev => prev.filter(item => !selectedContent.includes(item.id)))
    } else {
      setGuides(prev => prev.filter(item => !selectedContent.includes(item.id)))
    }
    setSelectedContent([])
  }

  const handlePublishContent = (contentId: string) => {
    const now = new Date().toISOString()
    if (contentType === 'articles') {
      setArticles(prev => prev.map(item =>
        item.id === contentId
          ? { ...item, status: 'published', publishedAt: now, updatedAt: now }
          : item
      ))
    } else {
      setGuides(prev => prev.map(item =>
        item.id === contentId
          ? { ...item, status: 'published', publishedAt: now, updatedAt: now }
          : item
      ))
    }
  }

  const handleUnpublishContent = (contentId: string) => {
    if (contentType === 'articles') {
      setArticles(prev => prev.map(item =>
        item.id === contentId
          ? { ...item, status: 'draft', publishedAt: null, updatedAt: new Date().toISOString() }
          : item
      ))
    } else {
      setGuides(prev => prev.map(item =>
        item.id === contentId
          ? { ...item, status: 'draft', publishedAt: null, updatedAt: new Date().toISOString() }
          : item
      ))
    }
  }

  const filteredContent = getFilteredContent()
  const contentTotalPages = Math.ceil(filteredContent.length / contentItemsPerPage)
  const paginatedContent = filteredContent.slice(
    (contentCurrentPage - 1) * contentItemsPerPage,
    contentCurrentPage * contentItemsPerPage
  )

  // Analytics State
  const [analyticsData, setAnalyticsData] = useState({
    overview: {
      totalProperties: 156,
      totalAgents: 2,
      totalViews: 45230,
      totalInquiries: 1247,
      totalRevenue: 285000000,
      conversionRate: 2.8,
      avgPropertyPrice: 4250000,
      activeListings: 142
    },
    propertyAnalytics: {
      viewsByCategory: [
        { category: 'Apartments', views: 12500, percentage: 27.6 },
        { category: 'Villas', views: 9800, percentage: 21.6 },
        { category: 'Townhouses', views: 7200, percentage: 15.9 },
        { category: 'Commercial', views: 6800, percentage: 15.0 },
        { category: 'Plots', views: 5200, percentage: 11.5 },
        { category: 'Others', views: 3730, percentage: 8.2 }
      ],
      inquiriesByType: [
        { type: 'Sale', inquiries: 892, percentage: 71.6 },
        { type: 'Rent', inquiries: 355, percentage: 28.4 }
      ],
      priceRanges: [
        { range: 'Under 1M AED', count: 23, percentage: 14.7 },
        { range: '1M - 5M AED', count: 67, percentage: 42.9 },
        { range: '5M - 10M AED', count: 45, percentage: 28.8 },
        { range: 'Over 10M AED', count: 21, percentage: 13.5 }
      ]
    },
    agentAnalytics: {
      topAgents: [
        { name: 'Dubai Luxury Realty', properties: 45, sales: 125000000, rating: 4.8 },
        { name: 'Emirates Property Group', properties: 32, sales: 89000000, rating: 4.6 }
      ],
      performanceMetrics: {
        avgResponseTime: '2.3 hours',
        avgClosingTime: '45 days',
        clientSatisfaction: 4.7,
        repeatClients: 68
      }
    },
    revenueAnalytics: {
      monthlyRevenue: [
        { month: 'Jan', revenue: 18500000 },
        { month: 'Feb', revenue: 22100000 },
        { month: 'Mar', revenue: 19800000 },
        { month: 'Apr', revenue: 25600000 },
        { month: 'May', revenue: 28900000 },
        { month: 'Jun', revenue: 31200000 },
        { month: 'Jul', revenue: 29800000 },
        { month: 'Aug', revenue: 33400000 },
        { month: 'Sep', revenue: 35600000 },
        { month: 'Oct', revenue: 37800000 },
        { month: 'Nov', revenue: 41200000 },
        { month: 'Dec', revenue: 42500000 }
      ],
      revenueByCategory: [
        { category: 'Residential', revenue: 198000000, percentage: 69.5 },
        { category: 'Commercial', revenue: 67000000, percentage: 23.5 },
        { category: 'Land', revenue: 20000000, percentage: 7.0 }
      ]
    },
    userEngagement: {
      dailyActiveUsers: 1247,
      monthlyActiveUsers: 8920,
      sessionDuration: '4:32',
      bounceRate: 34.2,
      topPages: [
        { page: '/properties', views: 15600, percentage: 34.4 },
        { page: '/apartments', views: 8900, percentage: 19.6 },
        { page: '/villas', views: 7200, percentage: 15.9 },
        { page: '/commercial', views: 5800, percentage: 12.8 },
        { page: '/about', views: 4200, percentage: 9.3 },
        { page: '/contact', views: 3530, percentage: 7.8 }
      ]
    },
    trends: {
      propertyViewsTrend: [
        { date: '2024-12-01', views: 1200 },
        { date: '2024-12-02', views: 1350 },
        { date: '2024-12-03', views: 1180 },
        { date: '2024-12-04', views: 1420 },
        { date: '2024-12-05', views: 1680 },
        { date: '2024-12-06', views: 1520 },
        { date: '2024-12-07', views: 1890 }
      ],
      inquiriesTrend: [
        { date: '2024-12-01', inquiries: 45 },
        { date: '2024-12-02', inquiries: 52 },
        { date: '2024-12-03', inquiries: 38 },
        { date: '2024-12-04', inquiries: 67 },
        { date: '2024-12-05', inquiries: 71 },
        { date: '2024-12-06', inquiries: 59 },
        { date: '2024-12-07', inquiries: 84 }
      ]
    }
  })
  const [selectedTimeRange, setSelectedTimeRange] = useState('30d')

  // Enhanced Property Management Functions
  const filterAndSortProperties = () => {
    let filtered = [...properties]

    // Search filter
    if (searchTerm) {
      filtered = filtered.filter(property =>
        property.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
        property.location.toLowerCase().includes(searchTerm.toLowerCase()) ||
        property.id.toLowerCase().includes(searchTerm.toLowerCase())
      )
    }

    // Status filter
    if (statusFilter !== 'all') {
      filtered = filtered.filter(property => property.status === statusFilter)
    }

    // Category filter
    if (categoryFilter !== 'all') {
      filtered = filtered.filter(property => property.category === categoryFilter)
    }

    // Type filter
    if (typeFilter !== 'all') {
      filtered = filtered.filter(property => property.type === typeFilter)
    }

    // Sort
    filtered.sort((a, b) => {
      let aValue = a[sortBy as keyof typeof a]
      let bValue = b[sortBy as keyof typeof b]

      if (sortBy === 'price') {
        aValue = Number(aValue)
        bValue = Number(bValue)
      }

      if (sortOrder === 'asc') {
        return aValue < bValue ? -1 : aValue > bValue ? 1 : 0
      } else {
        return aValue > bValue ? -1 : aValue < bValue ? 1 : 0
      }
    })

    setFilteredProperties(filtered)
    setCurrentPage(1)
  }

  // Authentication check
  useEffect(() => {
    if (!loading) {
      if (!user) {
        router.push('/admin/login')
        return
      }

      if (profile && profile.role !== 'admin') {
        router.push('/')
        return
      }
    }
  }, [user, profile, loading, router])

  // Apply filters when dependencies change
  useEffect(() => {
    filterAndSortProperties()
  }, [properties, searchTerm, statusFilter, categoryFilter, typeFilter, sortBy, sortOrder])

  // Form Management Functions
  const filterAndSortForms = () => {
    let filtered = [...formSubmissions]

    // Search filter
    if (formSearchTerm) {
      filtered = filtered.filter(submission =>
        submission.name.toLowerCase().includes(formSearchTerm.toLowerCase()) ||
        submission.email.toLowerCase().includes(formSearchTerm.toLowerCase()) ||
        submission.subject.toLowerCase().includes(formSearchTerm.toLowerCase()) ||
        submission.message.toLowerCase().includes(formSearchTerm.toLowerCase())
      )
    }

    // Status filter
    if (formStatusFilter !== 'all') {
      filtered = filtered.filter(submission => submission.status === formStatusFilter)
    }

    // Sort
    filtered.sort((a, b) => {
      let aValue: any
      let bValue: any

      if (formSortBy === 'date') {
        aValue = new Date(a.date).getTime()
        bValue = new Date(b.date).getTime()
      } else if (formSortBy === 'name') {
        aValue = a.name.toLowerCase()
        bValue = b.name.toLowerCase()
      } else if (formSortBy === 'priority') {
        const priorityOrder = { high: 3, normal: 2, low: 1 }
        aValue = priorityOrder[a.priority as keyof typeof priorityOrder]
        bValue = priorityOrder[b.priority as keyof typeof priorityOrder]
      } else if (formSortBy === 'formType') {
        aValue = a.formType
        bValue = b.formType
      }

      if (formSortOrder === 'asc') {
        return aValue < bValue ? -1 : aValue > bValue ? 1 : 0
      } else {
        return aValue > bValue ? -1 : aValue < bValue ? 1 : 0
      }
    })

    setFilteredFormSubmissions(filtered)
    setFormCurrentPage(1)
  }

  // Apply form filters when dependencies change
  useEffect(() => {
    filterAndSortForms()
  }, [formSubmissions, formSearchTerm, formStatusFilter, formSortBy, formSortOrder])

  // Form Pagination
  const formTotalPages = Math.ceil(filteredFormSubmissions.length / formItemsPerPage)

  // Pagination
  const totalPages = Math.ceil(filteredProperties.length / itemsPerPage)
  const startIndex = (currentPage - 1) * itemsPerPage
  const paginatedProperties = filteredProperties.slice(startIndex, startIndex + itemsPerPage)

  // Bulk Actions
  const handleSelectProperty = (propertyId: string) => {
    setSelectedProperties(prev =>
      prev.includes(propertyId)
        ? prev.filter(id => id !== propertyId)
        : [...prev, propertyId]
    )
  }

  const handleSelectAll = () => {
    if (selectedProperties.length === paginatedProperties.length) {
      setSelectedProperties([])
    } else {
      setSelectedProperties(paginatedProperties.map(p => p.id))
    }
  }

  const handleBulkAction = (action: string) => {
    const selectedProps = properties.filter(p => selectedProperties.includes(p.id))

    switch (action) {
      case 'activate':
        setProperties(prev => prev.map(p =>
          selectedProperties.includes(p.id) ? { ...p, status: 'active' } : p
        ))
        break
      case 'deactivate':
        setProperties(prev => prev.map(p =>
          selectedProperties.includes(p.id) ? { ...p, status: 'inactive' } : p
        ))
        break
      case 'feature':
        setProperties(prev => prev.map(p =>
          selectedProperties.includes(p.id) ? { ...p, featured: true } : p
        ))
        break
      case 'unfeature':
        setProperties(prev => prev.map(p =>
          selectedProperties.includes(p.id) ? { ...p, featured: false } : p
        ))
        break
      case 'delete':
        if (confirm(`Are you sure you want to delete ${selectedProperties.length} properties?`)) {
          setProperties(prev => prev.filter(p => !selectedProperties.includes(p.id)))
        }
        break
    }
    setSelectedProperties([])
  }

  // User Filtering and Sorting
  const filterAndSortUsers = () => {
    let filtered = [...users]

    // Search filter
    if (userSearchTerm) {
      filtered = filtered.filter(user =>
        user.name.toLowerCase().includes(userSearchTerm.toLowerCase()) ||
        user.email.toLowerCase().includes(userSearchTerm.toLowerCase()) ||
        user.location.toLowerCase().includes(userSearchTerm.toLowerCase())
      )
    }

    // Role filter
    if (userRoleFilter !== 'all') {
      filtered = filtered.filter(user => user.role === userRoleFilter)
    }

    // Status filter
    if (userStatusFilter !== 'all') {
      filtered = filtered.filter(user => user.status === userStatusFilter)
    }

    // Sort
    filtered.sort((a, b) => {
      let aValue = a[userSortBy as keyof typeof a]
      let bValue = b[userSortBy as keyof typeof b]

      if (userSortBy === 'joinDate' || userSortBy === 'lastLogin' || userSortBy === 'createdAt' || userSortBy === 'updatedAt') {
        aValue = new Date(aValue as string).getTime()
        bValue = new Date(bValue as string).getTime()
      } else if (userSortBy === 'totalInquiries' || userSortBy === 'totalFavorites') {
        aValue = Number(aValue)
        bValue = Number(bValue)
      }

      if (userSortOrder === 'asc') {
        return aValue < bValue ? -1 : aValue > bValue ? 1 : 0
      } else {
        return aValue > bValue ? -1 : aValue < bValue ? 1 : 0
      }
    })

    setFilteredUsers(filtered)
    setUserCurrentPage(1)
  }

  // Apply user filters when dependencies change
  useEffect(() => {
    filterAndSortUsers()
  }, [users, userSearchTerm, userRoleFilter, userStatusFilter, userSortBy, userSortOrder])

  // User Pagination
  const userTotalPages = Math.ceil(filteredUsers.length / userItemsPerPage)
  const userStartIndex = (userCurrentPage - 1) * userItemsPerPage
  const paginatedUsers = filteredUsers.slice(userStartIndex, userStartIndex + userItemsPerPage)

  // User Bulk Actions
  const handleSelectUser = (userId: string) => {
    setSelectedUsers(prev =>
      prev.includes(userId)
        ? prev.filter(id => id !== userId)
        : [...prev, userId]
    )
  }

  const handleSelectAllUsers = () => {
    if (selectedUsers.length === paginatedUsers.length) {
      setSelectedUsers([])
    } else {
      setSelectedUsers(paginatedUsers.map(u => u.id))
    }
  }

  const handleUserBulkAction = (action: string) => {
    const selectedUserList = users.filter(u => selectedUsers.includes(u.id))

    switch (action) {
      case 'activate':
        setUsers(prev => prev.map(u =>
          selectedUsers.includes(u.id) ? { ...u, status: 'active' } : u
        ))
        break
      case 'deactivate':
        setUsers(prev => prev.map(u =>
          selectedUsers.includes(u.id) ? { ...u, status: 'inactive' } : u
        ))
        break
      case 'verify':
        setUsers(prev => prev.map(u =>
          selectedUsers.includes(u.id) ? { ...u, verified: true } : u
        ))
        break
      case 'suspend':
        setUsers(prev => prev.map(u =>
          selectedUsers.includes(u.id) ? { ...u, status: 'suspended' } : u
        ))
        break
      case 'delete':
        if (confirm(`Are you sure you want to delete ${selectedUsers.length} users?`)) {
          setUsers(prev => prev.filter(u => !selectedUsers.includes(u.id)))
        }
        break
    }
    setSelectedUsers([])
  }

  // Navigation management state
  const [draggedItem, setDraggedItem] = useState<any>(null)
  const [draggedOver, setDraggedOver] = useState<string | null>(null)
  const [showAddNavItem, setShowAddNavItem] = useState(false)
  const [editingNavItem, setEditingNavItem] = useState<any>(null)
  const [navigationItems, setNavigationItems] = useState<any[]>([
    {
      id: 'buy',
      label: 'Buy',
      type: 'dropdown',
      order: 1,
      categories: [
        { label: 'Property Types', href: '/properties?action=buy', order: 1 },
        {
          label: 'By Type',
          order: 2,
          subcategories: [
            { label: 'Apartments in Dubai', href: '/apartments', order: 1 },
            { label: 'Villas in Dubai', href: '/villas', order: 2 },
            { label: 'Townhouses in Dubai', href: '/townhouses', order: 3 },
            { label: 'Plots in Dubai', href: '/plots', order: 4 },
            { label: 'Properties in Dubai', href: '/properties-dubai', order: 5 },
          ]
        },
        {
          label: 'Plots in Dubai',
          order: 3,
          subcategories: [
            { label: 'All Plots', href: '/plots', order: 1 },
            { label: 'Residential Plots', href: '/residential-plots', order: 2 },
          ]
        },
        {
          label: 'Furnished Properties',
          order: 4,
          subcategories: [
            { label: 'Furnished Studios', href: '/furnished-studio', order: 1 },
            { label: 'Furnished 1-bed', href: '/properties?action=rent&furnished=true&beds=1', order: 2 },
            { label: 'Furnished 2-bed', href: '/properties?action=rent&furnished=true&beds=2', order: 3 },
            { label: 'Furnished 3-bed', href: '/properties?action=rent&furnished=true&beds=3', order: 4 },
          ]
        },
        {
          label: 'Furnished Properties for Sale',
          order: 5,
          subcategories: [
            { label: 'Furnished Studio', href: '/properties?action=buy&furnished=true&beds=studio', order: 1 },
            { label: 'Furnished 1-bed', href: '/properties?action=buy&furnished=true&beds=1', order: 2 },
            { label: 'Furnished 2-bed', href: '/properties?action=buy&furnished=true&beds=2', order: 3 },
            { label: 'Furnished 3-bed', href: '/properties?action=buy&furnished=true&beds=3', order: 4 },
          ]
        },
      ],
    },
    {
      id: 'rent',
      label: 'Rent',
      type: 'dropdown',
      order: 2,
      categories: [
        { label: 'All Properties for Rent', href: '/properties?action=rent', order: 1 },
        { label: 'Apartments for Rent', href: '/apartments', order: 2 },
        { label: 'Villas for Rent', href: '/villas', order: 3 },
        { label: 'Townhouses for Rent', href: '/townhouses', order: 4 },
        { label: 'Furnished Studio', href: '/furnished-studio', order: 5 },
        { label: 'Furnished 1-Bed', href: '/furnished-1-bed', order: 6 },
        { label: 'Properties in Dubai', href: '/properties-dubai', order: 7 },
        {
          label: 'By Type',
          order: 8,
          subcategories: [
            { label: 'Apartments in Dubai', href: '/properties?action=rent&type=apartment', order: 1 },
            { label: 'Villas in Dubai', href: '/properties?action=rent&type=villa', order: 2 },
            { label: 'Townhouses in Dubai', href: '/properties?action=rent&type=townhouse', order: 3 },
            { label: 'Properties for Rent', href: '/properties?action=rent', order: 4 },
            { label: 'Studio Apartments', href: '/properties?action=rent&type=studio', order: 5 },
            { label: 'Penthouse Apartments', href: '/properties?action=rent&type=penthouse', order: 6 },
          ]
        },
        {
          label: 'By Bedrooms',
          order: 9,
          subcategories: [
            { label: 'Studio', href: '/properties?action=rent&beds=studio', order: 1 },
            { label: '1 Bedroom', href: '/properties?action=rent&beds=1', order: 2 },
            { label: '2 Bedrooms', href: '/properties?action=rent&beds=2', order: 3 },
            { label: '3 Bedrooms', href: '/properties?action=rent&beds=3', order: 4 },
            { label: '4 Bedrooms', href: '/properties?action=rent&beds=4', order: 5 },
            { label: '5+ Bedrooms', href: '/properties?action=rent&beds=5', order: 6 },
          ]
        },
        {
          label: 'By Budget',
          order: 10,
          subcategories: [
            { label: 'Under AED 50K', href: '/properties?action=rent&maxPrice=50000', order: 1 },
            { label: 'AED 50K - 100K', href: '/properties?action=rent&minPrice=50000&maxPrice=100000', order: 2 },
            { label: 'AED 100K - 200K', href: '/properties?action=rent&minPrice=100000&maxPrice=200000', order: 3 },
            { label: 'AED 200K - 500K', href: '/properties?action=rent&minPrice=200000&maxPrice=500000', order: 4 },
            { label: 'Above AED 500K', href: '/properties?action=rent&minPrice=500000&maxPrice=1000000', order: 5 },
          ]
        },
        {
          label: 'By Location',
          order: 11,
          subcategories: [
            { label: 'Downtown Dubai', href: '/properties?action=rent&location=downtown', order: 1 },
            { label: 'Dubai Marina', href: '/properties?action=rent&location=marina', order: 2 },
            { label: 'Jumeirah', href: '/properties?action=rent&location=jumeirah', order: 3 },
            { label: 'Palm Jumeirah', href: '/properties?action=rent&location=palm', order: 4 },
            { label: 'Dubai Hills Estate', href: '/properties?action=rent&location=hills', order: 5 },
            { label: 'Arabian Ranches', href: '/properties?action=rent&location=ranches', order: 6 },
            { label: 'Emirates Hills', href: '/properties?action=rent&location=emirates-hills', order: 7 },
            { label: 'Dubai Silicon Oasis', href: '/properties?action=rent&location=silicon-oasis', order: 8 },
          ]
        },
        {
          label: 'Furnished Properties for Rent',
          order: 12,
          subcategories: [
            { label: 'Furnished Studio', href: '/properties?action=rent&furnished=true&beds=studio', order: 1 },
            { label: 'Furnished 1-bed', href: '/properties?action=rent&furnished=true&beds=1', order: 2 },
            { label: 'Furnished 2-bed', href: '/properties?action=rent&furnished=true&beds=2', order: 3 },
            { label: 'Furnished 3-bed', href: '/properties?action=rent&furnished=true&beds=3', order: 4 },
            { label: 'Furnished 4-bed', href: '/properties?action=rent&furnished=true&beds=4', order: 5 },
          ]
        },
        {
          label: 'Luxury Rentals',
          order: 13,
          subcategories: [
            { label: 'Luxury Apartments', href: '/properties?action=rent&luxury=true&type=apartment', order: 1 },
            { label: 'Luxury Villas', href: '/properties?action=rent&luxury=true&type=villa', order: 2 },
            { label: 'Penthouse Rentals', href: '/properties?action=rent&type=penthouse', order: 3 },
            { label: 'Waterfront Properties', href: '/properties?action=rent&waterfront=true', order: 4 },
          ]
        },
        {
          label: 'Special Features',
          order: 14,
          subcategories: [
            { label: 'With Pool', href: '/properties?action=rent&pool=true', order: 1 },
            { label: 'With Gym', href: '/properties?action=rent&gym=true', order: 2 },
            { label: 'With Parking', href: '/properties?action=rent&parking=true', order: 3 },
            { label: 'Pet Friendly', href: '/properties?action=rent&pets=true', order: 4 },
            { label: 'Balcony/Terrace', href: '/properties?action=rent&balcony=true', order: 5 },
          ]
        },
        {
          label: 'Commercial Rentals',
          order: 15,
          subcategories: [
            { label: 'Office Spaces', href: '/properties?action=rent&commercial=true&type=office', order: 1 },
            { label: 'Retail Spaces', href: '/properties?action=rent&commercial=true&type=retail', order: 2 },
            { label: 'Warehouses', href: '/properties?action=rent&commercial=true&type=warehouse', order: 3 },
          ]
        },
      ],
    },
    {
      id: 'luxe',
      label: 'Luxe',
      type: 'dropdown',
      order: 3,
      categories: [
        {
          label: 'Luxury Properties for Sale',
          order: 1,
          subcategories: [
            { label: 'Apartments', href: '/luxe/apartments-sale', order: 1 },
            { label: 'Villas', href: '/luxe/villas-sale', order: 2 },
            { label: 'Homes', href: '/luxe/homes-sale', order: 3 },
            { label: 'Penthouses', href: '/luxe/penthouses-sale', order: 4 },
            { label: 'Mansions', href: '/luxe/mansions-sale', order: 5 },
            { label: 'Townhouses', href: '/luxe/townhouses-sale', order: 6 },
          ]
        },
        {
          label: 'Luxury Properties for Rent',
          order: 2,
          subcategories: [
            { label: 'Luxury Apartments', href: '/luxe/apartments-rent', order: 1 },
            { label: 'Luxury Villas', href: '/luxe/villas-rent', order: 2 },
            { label: 'Penthouse Rentals', href: '/luxe/penthouses-rent', order: 3 },
            { label: 'Mansion Rentals', href: '/luxe/mansions-rent', order: 4 },
            { label: 'Waterfront Luxury', href: '/luxe/waterfront', order: 5 },
          ]
        },
        {
          label: 'By Luxury Price Range',
          order: 3,
          subcategories: [
            { label: 'AED 2M - 5M', href: '/luxe/price-2m-5m', order: 1 },
            { label: 'AED 5M - 10M', href: '/luxe/price-5m-10m', order: 2 },
            { label: 'AED 10M - 20M', href: '/luxe/price-10m-20m', order: 3 },
            { label: 'AED 20M - 50M', href: '/luxe/price-20m-50m', order: 4 },
            { label: 'Above AED 50M', href: '/luxe/price-above-50m', order: 5 },
          ]
        },
        {
          label: 'Premium Locations',
          order: 4,
          subcategories: [
            { label: 'Palm Jumeirah', href: '/luxe/palm-jumeirah', order: 1 },
            { label: 'Dubai Marina', href: '/luxe/dubai-marina', order: 2 },
            { label: 'Jumeirah Beach Residence', href: '/luxe/jumeirah-beach-residence', order: 3 },
            { label: 'Emirates Hills', href: '/luxe/emirates-hills', order: 4 },
            { label: 'Dubai Hills Estate', href: '/luxe/dubai-hills-estate', order: 5 },
            { label: 'Arabian Ranches', href: '/luxe/arabian-ranches', order: 6 },
            { label: 'Downtown Dubai', href: '/luxe/downtown-dubai', order: 7 },
            { label: 'Business Bay', href: '/luxe/business-bay', order: 8 },
          ]
        },
        {
          label: 'Dubai Branded Residences',
          order: 5,
          subcategories: [
            { label: 'DAMAC Properties', href: '/luxe/damac', order: 1 },
            { label: 'Emaar Properties', href: '/luxe/emaar', order: 2 },
            { label: 'Nakheel Properties', href: '/luxe/nakheel', order: 3 },
            { label: 'Dubai Properties', href: '/luxe/dubaiproperties', order: 4 },
            { label: 'Azizi Developments', href: '/luxe/azizi', order: 5 },
            { label: 'Sobha Realty', href: '/luxe/sobha', order: 6 },
          ]
        },
        {
          label: 'Luxury Features & Amenities',
          order: 6,
          subcategories: [
            { label: 'Private Beach Access', href: '/luxe/beach-access', order: 1 },
            { label: 'Private Pool', href: '/luxe/private-pool', order: 2 },
            { label: 'Concierge Service', href: '/luxe/concierge', order: 3 },
            { label: 'Spa & Wellness', href: '/luxe/spa-wellness', order: 4 },
            { label: 'Smart Home Technology', href: '/luxe/smart-home', order: 5 },
            { label: 'Private Cinema', href: '/luxe/private-cinema', order: 6 },
            { label: 'Wine Cellar', href: '/luxe/wine-cellar', order: 7 },
            { label: 'Private Elevator', href: '/luxe/private-elevator', order: 8 },
          ]
        },
        {
          label: 'Exclusive Collections',
          order: 7,
          subcategories: [
            { label: 'Heritage Properties', href: '/luxe/heritage', order: 1 },
            { label: 'Designer Homes', href: '/luxe/designer-homes', order: 2 },
            { label: 'Boutique Developments', href: '/luxe/boutique', order: 3 },
            { label: 'Limited Edition', href: '/luxe/limited-edition', order: 4 },
            { label: 'Award Winning', href: '/luxe/award-winning', order: 5 },
          ]
        },
        {
          label: 'Luxury Lifestyle',
          order: 8,
          subcategories: [
            { label: 'Golf Course Views', href: '/luxe/golf-views', order: 1 },
            { label: 'Marina Views', href: '/luxe/marina-views', order: 2 },
            { label: 'Burj Khalifa Views', href: '/luxe/burj-khalifa-views', order: 3 },
            { label: 'Canal Views', href: '/luxe/canal-views', order: 4 },
            { label: 'Garden Views', href: '/luxe/garden-views', order: 5 },
            { label: 'Desert Views', href: '/luxe/desert-views', order: 6 },
          ]
        },
        {
          label: 'Luxury Commercial',
          order: 9,
          subcategories: [
            { label: 'Premium Office Spaces', href: '/luxe/office-spaces', order: 1 },
            { label: 'Luxury Retail', href: '/luxe/luxury-retail', order: 2 },
            { label: 'High-End Showrooms', href: '/luxe/showrooms', order: 3 },
            { label: 'Premium Warehouses', href: '/luxe/warehouses', order: 4 },
          ]
        },
      ],
    },
    {
      id: 'commercial',
      label: 'Commercial',
      type: 'dropdown',
      order: 4,
      categories: [
        {
          label: 'Offices',
          order: 1,
          subcategories: [
            { label: 'Offices for Sale', href: '/properties?commercial=true&action=buy&type=office', order: 1 },
            { label: 'Offices for Rent', href: '/properties?commercial=true&action=rent&type=office', order: 2 },
          ]
        },
        {
          label: 'Retail',
          order: 2,
          subcategories: [
            { label: 'Shops for Sale', href: '/properties?commercial=true&action=buy&type=shop', order: 1 },
            { label: 'Shops for Rent', href: '/properties?commercial=true&action=rent&type=shop', order: 2 },
          ]
        },
        { label: 'Plots for Sale', href: '/properties?commercial=true&action=buy&type=plot', order: 3 },
      ],
    },
  ])

  // Dashboard state
  const [dashboardStats, setDashboardStats] = useState({
    totalProperties: 247,
    activeListings: 189,
    pendingApprovals: 58,
    totalUsers: 1247,
    activeUsers: 892,
    newUsersThisMonth: 156,
    totalRevenue: 245000000,
    monthlyRevenue: 12000000,
    totalInquiries: 1429,
    unreadMessages: 23,
    systemUptime: 99.9,
    avgResponseTime: 1.2
  })

  const [recentActivities, setRecentActivities] = useState([
    { id: 1, action: 'New property added', user: 'John Doe', time: '2 hours ago', type: 'property' },
    { id: 2, action: 'Property updated', user: 'Jane Smith', time: '4 hours ago', type: 'property' },
    { id: 3, action: 'User registered', user: 'Bob Johnson', time: '1 day ago', type: 'user' },
    { id: 4, action: 'Property sold', user: 'Alice Brown', time: '2 days ago', type: 'sale' },
    { id: 5, action: 'New inquiry received', user: 'Mike Wilson', time: '3 hours ago', type: 'inquiry' },
    { id: 6, action: 'Agent approved', user: 'Sarah Davis', time: '1 day ago', type: 'agent' },
  ])

  const [systemAlerts, setSystemAlerts] = useState([
    { id: 1, type: 'warning', message: 'Database backup due in 2 days', time: '2 hours ago' },
    { id: 2, type: 'info', message: 'New user registrations increased by 15%', time: '4 hours ago' },
    { id: 3, type: 'success', message: 'All system services running normally', time: '1 day ago' },
  ])

  // Dashboard functions
  const handleQuickAction = (action: string) => {
    switch (action) {
      case 'addProperty':
        setEditingProperty(null)
        setShowAddProperty(true)
        break
      case 'viewListings':
        setActiveTab('properties')
        break
      case 'manageCategories':
        setActiveTab('categories')
        break
      case 'viewUsers':
        setActiveTab('users')
        break
      case 'viewAnalytics':
        setActiveTab('analytics')
        break
      case 'manageNavigation':
        setActiveTab('navigation')
        break
      case 'viewForms':
        setActiveTab('forms')
        break
      case 'systemSettings':
        setActiveTab('settings')
        break
      default:
        break
    }
  }

  const handleViewProperty = (propertyId: string) => {
    const property = properties.find(p => p.id === propertyId)
    if (property) {
      setSelectedPropertyDetails(property)
      setShowPropertyDetails(true)
    }
  }

  const handleEditProperty = (property: any) => {
    setEditingProperty(property)
    setShowAddProperty(true)
  }

  const handleDeleteProperty = (propertyId: string) => {
    if (confirm('Are you sure you want to delete this property?')) {
      setProperties(prev => prev.filter(p => p.id !== propertyId))
      setFilteredProperties(prev => prev.filter(p => p.id !== propertyId))
      // Update dashboard stats
      setDashboardStats(prev => ({
        ...prev,
        totalProperties: prev.totalProperties - 1,
        activeListings: properties.find(p => p.id === propertyId)?.status === 'active'
          ? prev.activeListings - 1 : prev.activeListings
      }))
    }
  }

  const handleToggleFeatured = (propertyId: string) => {
    setProperties(prev => prev.map(p =>
      p.id === propertyId ? { ...p, featured: !p.featured } : p
    ))
  }

  const handleToggleStatus = (propertyId: string) => {
    setProperties(prev => prev.map(p =>
      p.id === propertyId ? {
        ...p,
        status: p.status === 'active' ? 'inactive' : 'active'
      } : p
    ))
  }

  // Category Management Functions
  const handleViewCategory = (categoryId: string) => {
    const category = categories.find(c => c.id === categoryId)
    if (category) {
      setSelectedCategoryDetails(category)
      setShowCategoryDetails(true)
    }
  }

  const handleEditCategory = (category: any) => {
    setEditingCategory(category)
    setShowAddCategory(true)
  }

  const handleDeleteCategory = (categoryId: string) => {
    const category = categories.find(c => c.id === categoryId)
    if (confirm(`Are you sure you want to delete the "${category?.name}" category? This will affect ${category?.count} properties.`)) {
      setCategories(prev => prev.filter(c => c.id !== categoryId))
    }
  }

  const handleCategorySubmit = async (categoryData: any) => {
    try {
      if (editingCategory) {
        // Update existing category
        setCategories(prev => prev.map(c =>
          c.id === editingCategory.id ? { ...c, ...categoryData } : c
        ))
      } else {
        // Add new category
        const newCategory = {
          ...categoryData,
          id: categoryData.id || Date.now().toString(),
          count: 0,
        }
        setCategories(prev => [...prev, newCategory])
      }

      alert(`Category "${categoryData.name}" ${editingCategory ? 'updated' : 'created'} successfully!`)

      // Reset form state
      setShowAddCategory(false)
      setEditingCategory(null)

    } catch (error) {
      console.error('Error saving category:', error)
      alert('Error saving category. Please try again.')
    }
  }

  const handleCloseCategoryForm = () => {
    setShowAddCategory(false)
    setEditingCategory(null)
  }

  // Agent Management Functions
  const handleViewAgent = (agentId: string) => {
    const agent = agents.find(a => a.id === agentId)
    if (agent) {
      setSelectedAgentDetails(agent)
      setShowAgentDetails(true)
    }
  }

  const handleEditAgent = (agent: any) => {
    setEditingAgent(agent)
    setShowAddAgent(true)
  }

  const handleDeleteAgent = (agentId: string) => {
    if (confirm('Are you sure you want to delete this agent? This action cannot be undone.')) {
      setAgents(prev => prev.filter(a => a.id !== agentId))
      alert('Agent deleted successfully!')
    }
  }

  const handleAgentSubmit = async (agentData: any) => {
    try {
      if (editingAgent) {
        // Update existing agent - for now just update local state
        // TODO: Implement real agent update in database
        setAgents(prev => prev.map(a =>
          a.id === editingAgent.id ? { ...a, ...agentData, updatedAt: new Date().toISOString().split('T')[0] } : a
        ))
        alert(`Agent "${agentData.name}" updated successfully!`)
      } else {
        // Create new agent with real authentication
        const result = await createAgent(agentData.email, agentData.password, {
          full_name: agentData.name,
          phone: agentData.phone,
          bio: agentData.description,
          office: agentData.location,
          license_no: agentData.licenseNumber,
          areas: agentData.specialties,
          location: agentData.location,
          linkedin_url: agentData.socialMedia?.linkedin,
          instagram_handle: agentData.socialMedia?.instagram,
          website_url: agentData.website,
          specializations: agentData.specialties,
        })

        if (result.error) {
          alert(`Error creating agent: ${result.error.message}`)
          return
        }

        // Agent record is already created by createAgent function
        // Just add to local state for display
        const agentForUI = {
          id: result.user?.id,
          name: agentData.name,
          email: agentData.email,
          phone: agentData.phone,
          location: agentData.location,
          specialties: agentData.specialties,
          isActive: agentData.isActive,
          verified: false,
          totalProperties: 0,
          totalSales: 0,
          rating: 0,
          createdAt: new Date().toISOString().split('T')[0],
          updatedAt: new Date().toISOString().split('T')[0]
        }

        setAgents(prev => [...prev, agentForUI])
        alert(`Agent "${agentData.name}" created successfully! They can now login with email: ${agentData.email}`)
      }

      setShowAddAgent(false)
      setEditingAgent(null)
    } catch (error) {
      console.error('Error saving agent:', error)
      alert('Error saving agent. Please try again.')
    }
  }

  const handleCloseAgentForm = () => {
    setShowAddAgent(false)
    setEditingAgent(null)
  }

  const handleToggleAgentStatus = (agentId: string) => {
    setAgents(prev => prev.map(a =>
      a.id === agentId ? { ...a, isActive: !a.isActive } : a
    ))
  }

  const handleVerifyAgent = (agentId: string) => {
    setAgents(prev => prev.map(a =>
      a.id === agentId ? { ...a, verified: !a.verified } : a
    ))
  }

  // User Management Functions
  const handleViewUser = (userId: string) => {
    const user = users.find(u => u.id === userId)
    if (user) {
      setSelectedUserDetails(user)
      setShowUserDetails(true)
    }
  }

  const handleEditUser = (user: any) => {
    setEditingUser(user)
    setShowAddUser(true)
  }

  const handleDeleteUser = (userId: string) => {
    const user = users.find(u => u.id === userId)
    if (confirm(`Are you sure you want to delete user "${user?.name}"? This action cannot be undone.`)) {
      setUsers(prev => prev.filter(u => u.id !== userId))
      setFilteredUsers(prev => prev.filter(u => u.id !== userId))
    }
  }

  const handleUserSubmit = async (userData: any) => {
    try {
      if (editingUser) {
        // Update existing user
        setUsers(prev => prev.map(u =>
          u.id === editingUser.id ? { ...u, ...userData, updatedAt: new Date().toISOString().split('T')[0] } : u
        ))
        alert(`User "${userData.name}" updated successfully!`)
      } else {
        // Add new user
        const newUser = {
          ...userData,
          id: Date.now().toString(),
          createdAt: new Date().toISOString().split('T')[0],
          updatedAt: new Date().toISOString().split('T')[0],
          joinDate: new Date().toISOString().split('T')[0],
          lastLogin: null,
          totalInquiries: 0,
          totalFavorites: 0,
          verified: false
        }
        setUsers(prev => [...prev, newUser])
        alert(`User "${userData.name}" created successfully!`)
      }

      setShowAddUser(false)
      setEditingUser(null)
    } catch (error) {
      console.error('Error saving user:', error)
      alert('Error saving user. Please try again.')
    }
  }

  const handleCloseUserForm = () => {
    setShowAddUser(false)
    setEditingUser(null)
  }

  const handleToggleUserStatus = (userId: string) => {
    setUsers(prev => prev.map(u =>
      u.id === userId ? {
        ...u,
        status: u.status === 'active' ? 'inactive' : 'active'
      } : u
    ))
  }

  const handleVerifyUser = (userId: string) => {
    setUsers(prev => prev.map(u =>
      u.id === userId ? { ...u, verified: !u.verified } : u
    ))
  }

  // Form Management Functions
  const handleViewFormSubmission = (submissionId: string) => {
    const submission = formSubmissions.find(s => s.id === submissionId)
    if (submission) {
      setSelectedFormDetails(submission)
      setShowFormDetails(true)
      // Mark as read if it wasn't already
      if (submission.status === 'unread') {
        handleMarkFormAsRead(submissionId)
      }
    }
  }

  const handleMarkFormAsRead = (submissionId: string) => {
    setFormSubmissions(prev => prev.map(s =>
      s.id === submissionId ? {
        ...s,
        status: 'read',
        readAt: new Date().toISOString(),
        updatedAt: new Date().toISOString()
      } : s
    ))
  }

  const handleMarkFormAsUnread = (submissionId: string) => {
    setFormSubmissions(prev => prev.map(s =>
      s.id === submissionId ? {
        ...s,
        status: 'unread',
        readAt: null,
        updatedAt: new Date().toISOString()
      } : s
    ))
  }

  const handleRespondToForm = (submissionId: string, response: string) => {
    setFormSubmissions(prev => prev.map(s =>
      s.id === submissionId ? {
        ...s,
        response: response,
        respondedAt: new Date().toISOString(),
        status: 'responded',
        updatedAt: new Date().toISOString()
      } : s
    ))
    setShowResponseForm(false)
  }

  const handleDeleteFormSubmission = (submissionId: string) => {
    const submission = formSubmissions.find(s => s.id === submissionId)
    if (confirm(`Are you sure you want to delete this ${submission?.formType} submission from ${submission?.name}?`)) {
      setFormSubmissions(prev => prev.filter(s => s.id !== submissionId))
      setFilteredFormSubmissions(prev => prev.filter(s => s.id !== submissionId))
    }
  }

  const handleUpdateFormPriority = (submissionId: string, priority: 'low' | 'normal' | 'high') => {
    setFormSubmissions(prev => prev.map(s =>
      s.id === submissionId ? {
        ...s,
        priority: priority,
        updatedAt: new Date().toISOString()
      } : s
    ))
  }

  const handleExportFormSubmissions = (format: 'csv' | 'json' | 'pdf' = 'csv') => {
    const dataToExport = filteredFormSubmissions.length > 0 ? filteredFormSubmissions : formSubmissions

    if (format === 'csv') {
      const csvContent = [
        ['ID', 'Name', 'Email', 'Phone', 'Form Type', 'Subject', 'Status', 'Priority', 'Date', 'Message'],
        ...dataToExport.map(submission => [
          submission.id,
          submission.name,
          submission.email,
          submission.phone,
          submission.formType,
          submission.subject,
          submission.status,
          submission.priority,
          submission.date,
          submission.message.replace(/"/g, '""') // Escape quotes for CSV
        ])
      ].map(row => row.map(cell => `"${cell}"`).join(',')).join('\n')

      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' })
      const link = document.createElement('a')
      link.href = URL.createObjectURL(blob)
      link.download = `form_submissions_${new Date().toISOString().split('T')[0]}.csv`
      link.click()
    } else if (format === 'json') {
      const jsonContent = JSON.stringify(dataToExport, null, 2)
      const blob = new Blob([jsonContent], { type: 'application/json;charset=utf-8;' })
      const link = document.createElement('a')
      link.href = URL.createObjectURL(blob)
      link.download = `form_submissions_${new Date().toISOString().split('T')[0]}.json`
      link.click()
    }

    alert(`Exported ${dataToExport.length} form submissions as ${format.toUpperCase()}`)
  }

  const handleMarkActivityRead = (activityId: number) => {
    setRecentActivities(prev =>
      prev.map(activity =>
        activity.id === activityId ? { ...activity, read: true } : activity
      )
    )
  }

  const handleDismissAlert = (alertId: number) => {
    setSystemAlerts(prev => prev.filter(alert => alert.id !== alertId))
  }

  const refreshDashboard = () => {
    // In a real app, this would fetch fresh data from APIs
    console.log('Refreshing dashboard data...')
    // Simulate data refresh
    setDashboardStats(prev => ({
      ...prev,
      totalProperties: prev.totalProperties + Math.floor(Math.random() * 5),
      activeListings: prev.activeListings + Math.floor(Math.random() * 3),
    }))
  }

  const handlePropertySubmit = async (propertyData: any) => {
    try {
      console.log('Saving property:', propertyData)

      if (editingProperty) {
        // Update existing property
        setProperties(prev => prev.map(p =>
          p.id === editingProperty.id ? {
            ...p,
            ...propertyData,
            updatedAt: new Date().toISOString().split('T')[0]
          } : p
        ))
      } else {
        // Add new property
        const newProperty = {
          ...propertyData,
          id: Date.now().toString(),
          createdAt: new Date().toISOString().split('T')[0],
          updatedAt: new Date().toISOString().split('T')[0],
          views: 0,
          inquiries: 0,
        }
        setProperties(prev => [...prev, newProperty])

        // Update dashboard stats
        setDashboardStats(prev => ({
          ...prev,
          totalProperties: prev.totalProperties + 1,
          activeListings: propertyData.status === 'active' ? prev.activeListings + 1 : prev.activeListings
        }))
      }

      alert(`Property "${propertyData.title}" ${editingProperty ? 'updated' : 'created'} successfully!`)

      // Reset form state
      setShowAddProperty(false)
      setEditingProperty(null)
      setSelectedCategory('')

    } catch (error) {
      console.error('Error saving property:', error)
      alert('Error saving property. Please try again.')
    }
  }

  const handleCloseForm = () => {
    setShowAddProperty(false)
    setEditingProperty(null)
    setSelectedCategory('')
  }

  // Navigation management functions
  const handleDragStart = (e: React.DragEvent, item: any, type: string, parentId?: string) => {
    setDraggedItem({ item, type, parentId })
    e.dataTransfer.effectAllowed = 'move'
  }

  const handleDragOver = (e: React.DragEvent, itemId?: string) => {
    e.preventDefault()
    e.dataTransfer.dropEffect = 'move'
    if (itemId) {
      setDraggedOver(itemId)
    }
  }

  const handleDragLeave = () => {
    setDraggedOver(null)
  }

  const handleDrop = (e: React.DragEvent, targetItem: any, targetType: string, targetParentId?: string) => {
    e.preventDefault()
    if (!draggedItem) return

    const { item: dragged, type: draggedType, parentId: draggedParentId } = draggedItem

    // Prevent dropping on itself
    if (dragged.id === targetItem.id && draggedType === targetType) return

    setNavigationItems(prevItems => {
      const newItems = [...prevItems]

      // Remove dragged item from its current position
      if (draggedType === 'nav-item') {
        const draggedIndex = newItems.findIndex(item => item.id === dragged.id)
        if (draggedIndex !== -1) {
          newItems.splice(draggedIndex, 1)
        }
      } else if (draggedType === 'category') {
        const parentItem = newItems.find(item => item.id === draggedParentId)
        if (parentItem) {
          parentItem.categories = parentItem.categories.filter((cat: any) => cat.label !== dragged.label)
        }
      } else if (draggedType === 'subcategory') {
        const parentItem = newItems.find(item => item.id === draggedParentId)
        if (parentItem) {
          parentItem.categories.forEach((cat: any) => {
            if (cat.subcategories) {
              cat.subcategories = cat.subcategories.filter((sub: any) => sub.label !== dragged.label)
            }
          })
        }
      }

      // Add dragged item to new position
      if (targetType === 'nav-item') {
        const targetIndex = newItems.findIndex(item => item.id === targetItem.id)
        if (draggedType === 'nav-item') {
          newItems.splice(targetIndex, 0, dragged)
        }
      } else if (targetType === 'category') {
        const parentItem = newItems.find(item => item.id === targetParentId)
        if (parentItem) {
          const targetIndex = parentItem.categories.findIndex((cat: any) => cat.label === targetItem.label)
          if (draggedType === 'category') {
            parentItem.categories.splice(targetIndex, 0, dragged)
          } else if (draggedType === 'subcategory') {
            // Convert subcategory to category
            parentItem.categories.splice(targetIndex, 0, {
              label: dragged.label,
              href: dragged.href,
              order: targetIndex + 1
            })
          }
        }
      } else if (targetType === 'subcategory') {
        const parentItem = newItems.find(item => item.id === targetParentId)
        if (parentItem) {
          const category = parentItem.categories.find((cat: any) => cat.label === targetItem.categoryLabel)
          if (category && category.subcategories) {
            const targetIndex = category.subcategories.findIndex((sub: any) => sub.label === targetItem.label)
            if (draggedType === 'subcategory') {
              category.subcategories.splice(targetIndex, 0, dragged)
            } else if (draggedType === 'category') {
              // Convert category to subcategory
              category.subcategories.splice(targetIndex, 0, {
                label: dragged.label,
                href: dragged.href,
                order: targetIndex + 1
              })
            }
          }
        }
      }

      // Reorder items
      newItems.forEach((item, index) => {
        item.order = index + 1
        if (item.categories) {
          item.categories.forEach((cat: any, catIndex: number) => {
            cat.order = catIndex + 1
            if (cat.subcategories) {
              cat.subcategories.forEach((sub: any, subIndex: number) => {
                sub.order = subIndex + 1
              })
            }
          })
        }
      })

      return newItems
    })

    setDraggedItem(null)
    setDraggedOver(null)
  }

  const addNavItem = (itemData: any) => {
    const newItem = {
      id: itemData.id || `nav-${Date.now()}`,
      label: itemData.label,
      type: itemData.type || 'link',
      order: navigationItems.length + 1,
      href: itemData.type === 'link' ? itemData.href : undefined,
      categories: itemData.type === 'dropdown' ? [] : undefined,
    }

    setNavigationItems(prev => [...prev, newItem])
    setShowAddNavItem(false)
  }

  const updateNavItem = (itemId: string, itemData: any) => {
    setNavigationItems(prev => prev.map(item =>
      item.id === itemId
        ? { ...item, ...itemData }
        : item
    ))
    setEditingNavItem(null)
  }

  const deleteNavItem = (itemId: string) => {
    if (confirm('Are you sure you want to delete this navigation item?')) {
      setNavigationItems(prev => prev.filter(item => item.id !== itemId))
    }
  }

  const addCategory = (navItemId: string, categoryData: any) => {
    setNavigationItems(prev => prev.map(item =>
      item.id === navItemId
        ? {
            ...item,
            categories: [
              ...(item.categories || []),
              {
                label: categoryData.label,
                href: categoryData.href,
                order: (item.categories?.length || 0) + 1,
                subcategories: categoryData.hasSubcategories ? [] : undefined,
              }
            ]
          }
        : item
    ))
  }

  const addSubcategory = (navItemId: string, categoryLabel: string, subcategoryData: any) => {
    setNavigationItems(prev => prev.map(item =>
      item.id === navItemId
        ? {
            ...item,
            categories: item.categories?.map((cat: any) =>
              cat.label === categoryLabel
                ? {
                    ...cat,
                    subcategories: [
                      ...(cat.subcategories || []),
                      {
                        label: subcategoryData.label,
                        href: subcategoryData.href,
                        order: (cat.subcategories?.length || 0) + 1,
                      }
                    ]
                  }
                : cat
            )
          }
        : item
    ))
  }

  const exportNavigation = () => {
    const dataStr = JSON.stringify(navigationItems, null, 2)
    const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr)

    const exportFileDefaultName = 'navigation-structure.json'

    const linkElement = document.createElement('a')
    linkElement.setAttribute('href', dataUri)
    linkElement.setAttribute('download', exportFileDefaultName)
    linkElement.click()
  }

  const resetToDefault = () => {
    if (confirm('Are you sure you want to reset to the default navigation structure? All changes will be lost.')) {
      // Reset to default navigation items (you would load this from a default config)
      setNavigationItems([
        {
          id: 'buy',
          label: 'Buy',
          type: 'dropdown',
          order: 1,
          categories: [
            { label: 'Property Types', href: '/properties?action=buy', order: 1 },
            {
              label: 'By Type',
              order: 2,
              subcategories: [
                { label: 'Apartments in Dubai', href: '/apartments', order: 1 },
                { label: 'Villas in Dubai', href: '/villas', order: 2 },
                { label: 'Townhouses in Dubai', href: '/townhouses', order: 3 },
                { label: 'Plots in Dubai', href: '/plots', order: 4 },
                { label: 'Properties in Dubai', href: '/properties-dubai', order: 5 },
              ]
            },
          ],
        },
        {
          id: 'rent',
          label: 'Rent',
          type: 'dropdown',
          order: 2,
          categories: [
            { label: 'Property Types', href: '/properties?action=rent', order: 1 },
            {
              label: 'By Type',
              order: 2,
              subcategories: [
                { label: 'Apartments in Dubai', href: '/properties?action=rent&type=apartment', order: 1 },
                { label: 'Villas in Dubai', href: '/properties?action=rent&type=villa', order: 2 },
                { label: 'Townhouses in Dubai', href: '/properties?action=rent&type=townhouse', order: 3 },
                { label: 'Properties for Rent', href: '/properties?action=rent', order: 4 },
              ]
            },
          ],
        },
      ])
    }
  }

  const getCategoryIcon = (categoryId: string) => {
    const category = propertyCategories.find(cat => cat.id === categoryId)
    const iconName = category?.icon || 'BuildingOfficeIcon'

    const iconMap: { [key: string]: any } = {
      BuildingOfficeIcon,
      HomeModernIcon,
      HomeIcon,
      MapIcon,
      BuildingStorefrontIcon,
      SparklesIcon,
    }

    return iconMap[iconName] || BuildingOfficeIcon
  }

  const getCategoryName = (categoryId: string) => {
    const category = propertyCategories.find(cat => cat.id === categoryId)
    return category?.name || 'Unknown'
  }

  // Loading check
  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-red-600"></div>
      </div>
    )
  }

  if (!user || !profile || profile.role !== 'admin') {
    return null
  }

  return (
    <div className="min-h-screen bg-background flex">
      {/* Sidebar */}
      <aside className="w-64 bg-card border-r border-border shrink-0">
        <div className="p-6">
          <h2 className="text-xl font-bold text-foreground mb-6">Admin Panel</h2>
          <nav className="space-y-2">
            <button
              onClick={() => setActiveTab('dashboard')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'dashboard'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <HomeIcon className="w-5 h-5" />
              Dashboard
            </button>
            <button
              onClick={() => setActiveTab('properties')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'properties'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <BuildingOfficeIcon className="w-5 h-5" />
              Properties
            </button>
            <button
              onClick={() => setActiveTab('categories')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'categories'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <MapIcon className="w-5 h-5" />
              Categories
            </button>
            <button
              onClick={() => setActiveTab('analytics')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'analytics'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <SparklesIcon className="w-5 h-5" />
              Analytics
            </button>
            <button
              onClick={() => setActiveTab('navigation')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'navigation'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <LinkIcon className="w-5 h-5" />
              Navigation
            </button>
            <button
              onClick={() => setActiveTab('users')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'users'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <EyeIcon className="w-5 h-5" />
              Users
            </button>
            <button
              onClick={() => setActiveTab('forms')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'forms'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <PencilIcon className="w-5 h-5" />
              Forms
            </button>
            <button
              onClick={() => setActiveTab('content')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'content'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <PencilIcon className="w-5 h-5" />
              Content
            </button>
            <button
              onClick={() => setActiveTab('reports')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'reports'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <Bars3Icon className="w-5 h-5" />
              Reports
            </button>
            <button
              onClick={() => setActiveTab('seo')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'seo'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <MagnifyingGlassIcon className="w-5 h-5" />
              SEO
            </button>
            <button
              onClick={() => setActiveTab('settings')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'settings'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <ChevronRightIcon className="w-5 h-5" />
              Settings
            </button>
            <button
              onClick={() => setActiveTab('system')}
              className={`w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 ${
                activeTab === 'system'
                  ? 'bg-primary text-primary-foreground'
                  : 'hover:bg-muted text-foreground'
              }`}
            >
              <ChevronUpIcon className="w-5 h-5" />
              System
            </button>
          </nav>
        </div>
      </aside>

      {/* Main Content */}
      <div className="flex-1 flex flex-col">
        {/* Admin Header */}
        <header className="bg-card border-b border-border">
          <div className="px-6 py-4">
            <div className="flex items-center justify-between">
              <h1 className="text-2xl font-bold text-foreground">
                {activeTab.charAt(0).toUpperCase() + activeTab.slice(1)} Management
              </h1>
              <div className="flex items-center gap-4">
                <span className="text-sm text-muted-foreground">Welcome, {profile?.full_name || 'Admin'}</span>
                <button
                  onClick={signOut}
                  className="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                >
                  Logout
                </button>
              </div>
            </div>
          </div>
        </header>

        {/* Page Content */}
        <main className="flex-1 p-6 overflow-auto">
            {activeTab === 'dashboard' && (
              <div className="space-y-8">
                {/* Welcome Header */}
                <div className="flex items-center justify-between">
                  <div>
                    <h1 className="text-3xl font-bold text-foreground">Dashboard Overview</h1>
                    <p className="text-muted-foreground mt-1">Welcome back! Here's what's happening with your real estate platform.</p>
                  </div>
                  <div className="flex gap-3">
                    <button
                      onClick={refreshDashboard}
                      className="flex items-center gap-2 px-4 py-2 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <EyeIcon className="h-4 w-4" />
                      Refresh
                    </button>
                    <button className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors">
                      <PlusIcon className="h-4 w-4" />
                      Quick Add
                    </button>
                  </div>
                </div>

                {/* Key Metrics */}
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center justify-between mb-4">
                      <div className="p-3 bg-blue-500/10 rounded-lg">
                        <BuildingOfficeIcon className="h-6 w-6 text-blue-500" />
                      </div>
                      <span className="text-sm text-green-500 font-medium">+12%</span>
                    </div>
                    <div className="space-y-1">
                      <p className="text-2xl font-bold text-foreground">{dashboardStats.totalProperties.toLocaleString()}</p>
                      <p className="text-sm text-muted-foreground">Total Properties</p>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center justify-between mb-4">
                      <div className="p-3 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-green-500" />
                      </div>
                      <span className="text-sm text-green-500 font-medium">+8%</span>
                    </div>
                    <div className="space-y-1">
                      <p className="text-2xl font-bold text-foreground">{dashboardStats.activeListings.toLocaleString()}</p>
                      <p className="text-sm text-muted-foreground">Active Listings</p>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center justify-between mb-4">
                      <div className="p-3 bg-yellow-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-yellow-500" />
                      </div>
                      <span className="text-sm text-red-500 font-medium">-5%</span>
                    </div>
                    <div className="space-y-1">
                      <p className="text-2xl font-bold text-foreground">{dashboardStats.pendingApprovals}</p>
                      <p className="text-sm text-muted-foreground">Pending Approvals</p>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center justify-between mb-4">
                      <div className="p-3 bg-purple-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-purple-500" />
                      </div>
                      <span className="text-sm text-green-500 font-medium">+15%</span>
                    </div>
                    <div className="space-y-1">
                      <p className="text-2xl font-bold text-foreground">AED {(dashboardStats.monthlyRevenue / 1000000).toFixed(1)}M</p>
                      <p className="text-sm text-muted-foreground">Monthly Revenue</p>
                    </div>
                  </div>
                </div>

                {/* Secondary Metrics */}
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-primary/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-primary" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">{dashboardStats.totalUsers.toLocaleString()}</p>
                        <p className="text-sm text-muted-foreground">Total Users</p>
                        <p className="text-xs text-green-500 mt-1">+{dashboardStats.newUsersThisMonth} this month</p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-orange-500/10 rounded-lg">
                        <PencilIcon className="h-6 w-6 text-orange-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">{dashboardStats.totalInquiries}</p>
                        <p className="text-sm text-muted-foreground">Property Inquiries</p>
                        <p className="text-xs text-red-500 mt-1">{dashboardStats.unreadMessages} unread</p>
                      </div>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-green-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">{dashboardStats.systemUptime}%</p>
                        <p className="text-sm text-muted-foreground">System Uptime</p>
                        <p className="text-xs text-muted-foreground mt-1">{dashboardStats.avgResponseTime}s avg response</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Quick Actions */}
                <div className="bg-card border border-border rounded-xl p-6">
                  <h2 className="text-xl font-bold text-foreground mb-6">Quick Actions</h2>
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <button
                      onClick={() => handleQuickAction('addProperty')}
                      className="flex items-center gap-3 p-4 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors"
                    >
                      <PlusIcon className="h-6 w-6 text-primary" />
                      <div className="text-left">
                        <div className="font-semibold text-primary">Add Property</div>
                        <div className="text-sm text-primary/80">Create new listing</div>
                      </div>
                    </button>
                    <button
                      onClick={() => handleQuickAction('viewListings')}
                      className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <EyeIcon className="h-6 w-6 text-muted-foreground" />
                      <div className="text-left">
                        <div className="font-semibold text-foreground">View Listings</div>
                        <div className="text-sm text-muted-foreground">Browse all properties</div>
                      </div>
                    </button>
                    <button
                      onClick={() => handleQuickAction('manageCategories')}
                      className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <PencilIcon className="h-6 w-6 text-muted-foreground" />
                      <div className="text-left">
                        <div className="font-semibold text-foreground">Manage Categories</div>
                        <div className="text-sm text-muted-foreground">Edit property types</div>
                      </div>
                    </button>
                    <button
                      onClick={() => handleQuickAction('viewUsers')}
                      className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <EyeIcon className="h-6 w-6 text-muted-foreground" />
                      <div className="text-left">
                        <div className="font-semibold text-foreground">View Users</div>
                        <div className="text-sm text-muted-foreground">Manage user accounts</div>
                      </div>
                    </button>
                    <button
                      onClick={() => handleQuickAction('viewAnalytics')}
                      className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <SparklesIcon className="h-6 w-6 text-muted-foreground" />
                      <div className="text-left">
                        <div className="font-semibold text-foreground">View Analytics</div>
                        <div className="text-sm text-muted-foreground">Performance reports</div>
                      </div>
                    </button>
                    <button
                      onClick={() => handleQuickAction('manageNavigation')}
                      className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <LinkIcon className="h-6 w-6 text-muted-foreground" />
                      <div className="text-left">
                        <div className="font-semibold text-foreground">Navigation</div>
                        <div className="text-sm text-muted-foreground">Manage menu structure</div>
                      </div>
                    </button>
                    <button
                      onClick={() => handleQuickAction('viewForms')}
                      className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <PencilIcon className="h-6 w-6 text-muted-foreground" />
                      <div className="text-left">
                        <div className="font-semibold text-foreground">Form Applications</div>
                        <div className="text-sm text-muted-foreground">Review submissions</div>
                      </div>
                    </button>
                    <button
                      onClick={() => handleQuickAction('systemSettings')}
                      className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      <ChevronRightIcon className="h-6 w-6 text-muted-foreground" />
                      <div className="text-left">
                        <div className="font-semibold text-foreground">System Settings</div>
                        <div className="text-sm text-muted-foreground">Configure platform</div>
                      </div>
                    </button>
                  </div>
                </div>

                {/* Recent Activity & System Alerts */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  {/* Recent Activity */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center justify-between mb-6">
                      <h2 className="text-xl font-bold text-foreground">Recent Activity</h2>
                      <button className="text-sm text-primary hover:text-primary/80">View All</button>
                    </div>
                    <div className="space-y-4">
                      {recentActivities.map((activity) => (
                        <div key={activity.id} className="flex items-start gap-4 p-3 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors">
                          <div className={`p-2 rounded-lg ${
                            activity.type === 'property' ? 'bg-blue-500/10' :
                            activity.type === 'user' ? 'bg-green-500/10' :
                            activity.type === 'sale' ? 'bg-purple-500/10' :
                            activity.type === 'inquiry' ? 'bg-orange-500/10' :
                            'bg-gray-500/10'
                          }`}>
                            {activity.type === 'property' && <BuildingOfficeIcon className="h-4 w-4 text-blue-500" />}
                            {activity.type === 'user' && <EyeIcon className="h-4 w-4 text-green-500" />}
                            {activity.type === 'sale' && <SparklesIcon className="h-4 w-4 text-purple-500" />}
                            {activity.type === 'inquiry' && <PencilIcon className="h-4 w-4 text-orange-500" />}
                            {activity.type === 'agent' && <BuildingStorefrontIcon className="h-4 w-4 text-yellow-500" />}
                          </div>
                          <div className="flex-1 min-w-0">
                            <p className="font-medium text-foreground">{activity.action}</p>
                            <p className="text-sm text-muted-foreground">by {activity.user}  {activity.time}</p>
                          </div>
                          <button
                            onClick={() => handleMarkActivityRead(activity.id)}
                            className="p-1 hover:bg-background rounded transition-colors opacity-0 group-hover:opacity-100"
                          >
                            <EyeIcon className="h-4 w-4 text-muted-foreground" />
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* System Alerts */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center justify-between mb-6">
                      <h2 className="text-xl font-bold text-foreground">System Alerts</h2>
                      <button className="text-sm text-primary hover:text-primary/80">View All</button>
                    </div>
                    <div className="space-y-4">
                      {systemAlerts.map((alert) => (
                        <div key={alert.id} className="flex items-start gap-4 p-3 bg-muted/30 rounded-lg">
                          <div className={`p-2 rounded-lg ${
                            alert.type === 'warning' ? 'bg-yellow-500/10' :
                            alert.type === 'error' ? 'bg-red-500/10' :
                            alert.type === 'success' ? 'bg-green-500/10' :
                            'bg-blue-500/10'
                          }`}>
                            {alert.type === 'warning' && <EyeIcon className="h-4 w-4 text-yellow-500" />}
                            {alert.type === 'error' && <TrashIcon className="h-4 w-4 text-red-500" />}
                            {alert.type === 'success' && <EyeIcon className="h-4 w-4 text-green-500" />}
                            {alert.type === 'info' && <EyeIcon className="h-4 w-4 text-blue-500" />}
                          </div>
                          <div className="flex-1 min-w-0">
                            <p className="font-medium text-foreground">{alert.message}</p>
                            <p className="text-sm text-muted-foreground">{alert.time}</p>
                          </div>
                          <button
                            onClick={() => handleDismissAlert(alert.id)}
                            className="p-1 hover:bg-background rounded transition-colors"
                          >
                            <TrashIcon className="h-4 w-4 text-muted-foreground" />
                          </button>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>

                {/* Recent Properties */}
                <div className="bg-card border border-border rounded-xl p-6">
                  <div className="flex items-center justify-between mb-6">
                    <h2 className="text-xl font-bold text-foreground">Recent Properties</h2>
                    <button
                      onClick={() => handleQuickAction('viewListings')}
                      className="text-sm text-primary hover:text-primary/80"
                    >
                      View All Properties
                    </button>
                  </div>
                  <div className="space-y-4">
                    {mockProperties.map((property) => {
                      const IconComponent = getCategoryIcon(property.category)
                      return (
                        <div key={property.id} className="flex items-center justify-between p-4 bg-muted/50 rounded-lg hover:bg-muted/70 transition-colors">
                          <div className="flex items-center gap-4">
                            <IconComponent className="h-8 w-8 text-primary" />
                            <div>
                              <h3 className="font-semibold text-foreground">{property.title}</h3>
                              <p className="text-sm text-muted-foreground">
                                {getCategoryName(property.category)}  {property.location}
                              </p>
                            </div>
                          </div>
                          <div className="flex items-center gap-4">
                            <span className="font-semibold text-primary">
                              AED {property.price.toLocaleString()}
                            </span>
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                              property.status === 'active' ? 'bg-green-500/10 text-green-500' :
                              property.status === 'pending' ? 'bg-yellow-500/10 text-yellow-500' :
                              'bg-red-500/10 text-red-500'
                            }`}>
                              {property.status}
                            </span>
                            <div className="flex gap-2">
                              <button
                                onClick={() => handleViewProperty(property.id)}
                                className="p-2 hover:bg-background rounded-lg transition-colors"
                                title="View Property"
                              >
                                <EyeIcon className="h-4 w-4 text-muted-foreground" />
                              </button>
                              <button
                                onClick={() => handleEditProperty(property)}
                                className="p-2 hover:bg-background rounded-lg transition-colors"
                                title="Edit Property"
                              >
                                <PencilIcon className="h-4 w-4 text-muted-foreground" />
                              </button>
                              <button
                                onClick={() => handleDeleteProperty(property.id)}
                                className="p-2 hover:bg-red-500/20 text-red-500 rounded-lg transition-colors"
                                title="Delete Property"
                              >
                                <TrashIcon className="h-4 w-4" />
                              </button>
                            </div>
                          </div>
                        </div>
                      )
                    })}
                  </div>
                </div>
              </div>
            )}

            {activeTab === 'properties' && (
              <div className="space-y-6">
                {/* Header with Stats */}
                <div className="flex items-center justify-between">
                  <div>
                    <h2 className="text-2xl font-bold text-foreground">Property Management</h2>
                    <p className="text-muted-foreground mt-1">
                      {filteredProperties.length} of {properties.length} properties
                    </p>
                  </div>
                  <button
                    onClick={() => {
                      setEditingProperty(null)
                      setShowAddProperty(true)
                    }}
                    className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                  >
                    <PlusIcon className="h-4 w-4" />
                    Add Property
                  </button>
                </div>

                {/* Property Statistics */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-blue-500/10 rounded-lg">
                        <BuildingOfficeIcon className="h-5 w-5 text-blue-500" />
                      </div>
                      <div>
                        <p className="text-xl font-bold text-foreground">{properties.length}</p>
                        <p className="text-sm text-muted-foreground">Total Properties</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-5 w-5 text-green-500" />
                      </div>
                      <div>
                        <p className="text-xl font-bold text-foreground">
                          {properties.filter(p => p.status === 'active').length}
                        </p>
                        <p className="text-sm text-muted-foreground">Active Listings</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-yellow-500/10 rounded-lg">
                        <SparklesIcon className="h-5 w-5 text-yellow-500" />
                      </div>
                      <div>
                        <p className="text-xl font-bold text-foreground">
                          {properties.filter(p => p.featured).length}
                        </p>
                        <p className="text-sm text-muted-foreground">Featured</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-purple-500/10 rounded-lg">
                        <EyeIcon className="h-5 w-5 text-purple-500" />
                      </div>
                      <div>
                        <p className="text-xl font-bold text-foreground">
                          {properties.reduce((sum, p) => sum + p.views, 0)}
                        </p>
                        <p className="text-sm text-muted-foreground">Total Views</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Filters and Search */}
                <div className="bg-card border border-border rounded-xl p-6">
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4 mb-6">
                    <div>
                      <label className="block text-sm font-medium text-foreground mb-2">Search</label>
                      <input
                        type="text"
                        placeholder="Search properties..."
                        value={searchTerm}
                        onChange={(e) => setSearchTerm(e.target.value)}
                        className="w-full px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-foreground"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-foreground mb-2">Status</label>
                      <select
                        value={statusFilter}
                        onChange={(e) => setStatusFilter(e.target.value)}
                        className="w-full px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-foreground"
                      >
                        <option value="all">All Status</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="pending">Pending</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-foreground mb-2">Category</label>
                      <select
                        value={categoryFilter}
                        onChange={(e) => setCategoryFilter(e.target.value)}
                        className="w-full px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-foreground"
                      >
                        <option value="all">All Categories</option>
                        {propertyCategories.map(cat => (
                          <option key={cat.id} value={cat.id}>{cat.name}</option>
                        ))}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-foreground mb-2">Type</label>
                      <select
                        value={typeFilter}
                        onChange={(e) => setTypeFilter(e.target.value)}
                        className="w-full px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-foreground"
                      >
                        <option value="all">All Types</option>
                        <option value="sale">For Sale</option>
                        <option value="rent">For Rent</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-foreground mb-2">Sort By</label>
                      <select
                        value={sortBy}
                        onChange={(e) => setSortBy(e.target.value)}
                        className="w-full px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-foreground"
                      >
                        <option value="updatedAt">Last Updated</option>
                        <option value="createdAt">Date Created</option>
                        <option value="price">Price</option>
                        <option value="title">Title</option>
                        <option value="views">Views</option>
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-foreground mb-2">Order</label>
                      <select
                        value={sortOrder}
                        onChange={(e) => setSortOrder(e.target.value as 'asc' | 'desc')}
                        className="w-full px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-foreground"
                      >
                        <option value="desc">Descending</option>
                        <option value="asc">Ascending</option>
                      </select>
                    </div>
                  </div>

                  {/* Bulk Actions */}
                  {selectedProperties.length > 0 && (
                    <div className="flex items-center gap-4 p-4 bg-muted/50 rounded-lg">
                      <span className="text-sm font-medium text-foreground">
                        {selectedProperties.length} selected
                      </span>
                      <div className="flex gap-2">
                        <button
                          onClick={() => handleBulkAction('activate')}
                          className="px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600 transition-colors"
                        >
                          Activate
                        </button>
                        <button
                          onClick={() => handleBulkAction('deactivate')}
                          className="px-3 py-1 bg-yellow-500 text-white rounded text-sm hover:bg-yellow-600 transition-colors"
                        >
                          Deactivate
                        </button>
                        <button
                          onClick={() => handleBulkAction('feature')}
                          className="px-3 py-1 bg-purple-500 text-white rounded text-sm hover:bg-purple-600 transition-colors"
                        >
                          Feature
                        </button>
                        <button
                          onClick={() => handleBulkAction('delete')}
                          className="px-3 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600 transition-colors"
                        >
                          Delete
                        </button>
                      </div>
                    </div>
                  )}
                </div>

                {/* Properties Table */}
                <div className="bg-card border border-border rounded-xl overflow-hidden">
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead className="bg-muted/50">
                        <tr>
                          <th className="px-6 py-3 text-left">
                            <input
                              type="checkbox"
                              checked={selectedProperties.length === paginatedProperties.length && paginatedProperties.length > 0}
                              onChange={handleSelectAll}
                              className="rounded border-border"
                            />
                          </th>
                          <th className="px-6 py-3 text-left text-sm font-semibold text-foreground">Property</th>
                          <th className="px-6 py-3 text-left text-sm font-semibold text-foreground">Category</th>
                          <th className="px-6 py-3 text-left text-sm font-semibold text-foreground">Location</th>
                          <th className="px-6 py-3 text-left text-sm font-semibold text-foreground">Price</th>
                          <th className="px-6 py-3 text-left text-sm font-semibold text-foreground">Status</th>
                          <th className="px-6 py-3 text-left text-sm font-semibold text-foreground">Stats</th>
                          <th className="px-6 py-3 text-left text-sm font-semibold text-foreground">Actions</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-border">
                        {paginatedProperties.map((property) => {
                          const IconComponent = getCategoryIcon(property.category)
                          return (
                            <tr key={property.id} className="hover:bg-muted/30">
                              <td className="px-6 py-4">
                                <input
                                  type="checkbox"
                                  checked={selectedProperties.includes(property.id)}
                                  onChange={() => handleSelectProperty(property.id)}
                                  className="rounded border-border"
                                />
                              </td>
                              <td className="px-6 py-4">
                                <div className="flex items-center gap-3">
                                  <div className="relative">
                                    <IconComponent className="h-10 w-10 text-primary" />
                                    {property.images && property.images.length > 0 && (
                                      <div className="absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-background"></div>
                                    )}
                                  </div>
                                  <div>
                                    <div className="font-semibold text-foreground flex items-center gap-2">
                                      {property.title}
                                      {property.featured && (
                                        <SparklesIcon className="h-4 w-4 text-yellow-500" />
                                      )}
                                    </div>
                                    <div className="text-sm text-muted-foreground">
                                      ID: {property.id}  {property.beds > 0 && `${property.beds}BR `}{property.sqft} sqft
                                    </div>
                                  </div>
                                </div>
                              </td>
                              <td className="px-6 py-4">
                                <span className="px-2 py-1 bg-primary/10 text-primary rounded-full text-sm">
                                  {getCategoryName(property.category)}
                                </span>
                              </td>
                              <td className="px-6 py-4 text-foreground">{property.location}</td>
                              <td className="px-6 py-4 font-semibold text-primary">
                                {property.currency} {property.price.toLocaleString()}
                                <div className="text-xs text-muted-foreground">{property.type}</div>
                              </td>
                              <td className="px-6 py-4">
                                <button
                                  onClick={() => handleToggleStatus(property.id)}
                                  className={`px-2 py-1 rounded-full text-xs font-medium ${
                                    property.status === 'active'
                                      ? 'bg-green-100 text-green-800 hover:bg-green-200'
                                      : property.status === 'pending'
                                      ? 'bg-yellow-100 text-yellow-800 hover:bg-yellow-200'
                                      : 'bg-gray-100 text-gray-800 hover:bg-gray-200'
                                  }`}
                                >
                                  {property.status}
                                </button>
                              </td>
                              <td className="px-6 py-4">
                                <div className="text-sm">
                                  <div className="flex items-center gap-1">
                                    <EyeIcon className="h-3 w-3 text-muted-foreground" />
                                    {property.views}
                                  </div>
                                  <div className="flex items-center gap-1">
                                    <PencilIcon className="h-3 w-3 text-muted-foreground" />
                                    {property.inquiries}
                                  </div>
                                </div>
                              </td>
                              <td className="px-6 py-4">
                                <div className="flex gap-2">
                                  <button
                                    onClick={() => handleViewProperty(property.id)}
                                    className="p-2 hover:bg-background rounded-lg transition-colors"
                                    title="View Details"
                                  >
                                    <EyeIcon className="h-4 w-4 text-muted-foreground" />
                                  </button>
                                  <button
                                    onClick={() => handleEditProperty(property)}
                                    className="p-2 hover:bg-background rounded-lg transition-colors"
                                    title="Edit Property"
                                  >
                                    <PencilIcon className="h-4 w-4 text-muted-foreground" />
                                  </button>
                                  <button
                                    onClick={() => handleToggleFeatured(property.id)}
                                    className="p-2 hover:bg-background rounded-lg transition-colors"
                                    title={property.featured ? "Unfeature" : "Feature"}
                                  >
                                    <SparklesIcon className={`h-4 w-4 ${property.featured ? 'text-yellow-500' : 'text-muted-foreground'}`} />
                                  </button>
                                  <button
                                    onClick={() => handleDeleteProperty(property.id)}
                                    className="p-2 hover:bg-red-500/10 text-red-500 rounded-lg transition-colors"
                                    title="Delete Property"
                                  >
                                    <TrashIcon className="h-4 w-4" />
                                  </button>
                                </div>
                              </td>
                            </tr>
                          )
                        })}
                      </tbody>
                    </table>
                  </div>

                  {/* Pagination */}
                  {totalPages > 1 && (
                    <div className="flex items-center justify-between px-6 py-4 border-t border-border">
                      <div className="text-sm text-muted-foreground">
                        Showing {startIndex + 1} to {Math.min(startIndex + itemsPerPage, filteredProperties.length)} of {filteredProperties.length} properties
                      </div>
                      <div className="flex gap-2">
                        <button
                          onClick={() => setCurrentPage(prev => Math.max(prev - 1, 1))}
                          disabled={currentPage === 1}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Previous
                        </button>
                        {Array.from({ length: totalPages }, (_, i) => i + 1).map(page => (
                          <button
                            key={page}
                            onClick={() => setCurrentPage(page)}
                            className={`px-3 py-1 border rounded ${
                              currentPage === page
                                ? 'bg-primary text-primary-foreground border-primary'
                                : 'border-border hover:bg-muted'
                            }`}
                          >
                            {page}
                          </button>
                        ))}
                        <button
                          onClick={() => setCurrentPage(prev => Math.min(prev + 1, totalPages))}
                          disabled={currentPage === totalPages}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Next
                        </button>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}

            {activeTab === 'categories' && (
              <div className="space-y-6">
                {/* Header with Stats */}
                <div className="flex items-center justify-between">
                  <div>
                    <h2 className="text-2xl font-bold text-foreground">Property Categories</h2>
                    <p className="text-muted-foreground mt-1">
                      Manage property categories and their display settings
                    </p>
                  </div>
                  <button
                    onClick={() => setShowAddCategory(true)}
                    className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                  >
                    <PlusIcon className="h-4 w-4" />
                    Add Category
                  </button>
                </div>

                {/* Category Statistics */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-primary/10 rounded-lg">
                        <BuildingOfficeIcon className="h-5 w-5 text-primary" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">{categories.length}</div>
                        <div className="text-sm text-muted-foreground">Total Categories</div>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-5 w-5 text-green-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">
                          {categories.filter(c => c.isActive !== false).length}
                        </div>
                        <div className="text-sm text-muted-foreground">Active Categories</div>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-blue-500/10 rounded-lg">
                        <HomeIcon className="h-5 w-5 text-blue-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">
                          {categories.reduce((sum, c) => sum + c.count, 0)}
                        </div>
                        <div className="text-sm text-muted-foreground">Total Properties</div>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-yellow-500/10 rounded-lg">
                        <SparklesIcon className="h-5 w-5 text-yellow-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">
                          {categories.filter(c => c.count > 0).length}
                        </div>
                        <div className="text-sm text-muted-foreground">Used Categories</div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Categories Grid */}
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                  {categories.map((category) => {
                    // Map icon string to component
                    const iconMap: { [key: string]: any } = {
                      BuildingOfficeIcon,
                      HomeModernIcon,
                      HomeIcon,
                      MapIcon,
                      BuildingStorefrontIcon,
                      SparklesIcon,
                      CubeIcon,
                      WrenchScrewdriverIcon,
                      TruckIcon,
                      ShoppingBagIcon,
                    }
                    const IconComponent = iconMap[category.icon] || BuildingOfficeIcon

                    return (
                      <div key={category.id} className="bg-card border border-border rounded-xl p-6 hover:shadow-lg transition-shadow">
                        <div className="flex items-start justify-between mb-4">
                          <div className="flex items-center gap-3">
                            <div className={`p-2 rounded-lg ${
                              category.isActive !== false ? 'bg-primary/10' : 'bg-muted'
                            }`}>
                              <IconComponent className={`h-6 w-6 ${
                                category.isActive !== false ? 'text-primary' : 'text-muted-foreground'
                              }`} />
                            </div>
                            <div>
                              <h3 className="text-lg font-semibold text-foreground">{category.name}</h3>
                              <p className="text-sm text-muted-foreground">ID: {category.id}</p>
                            </div>
                          </div>
                          <div className="flex items-center gap-2">
                            {category.isActive === false && (
                              <span className="px-2 py-1 bg-red-500/10 text-red-500 text-xs rounded-full">
                                Inactive
                              </span>
                            )}
                            <span className="text-lg font-bold text-primary">{category.count}</span>
                          </div>
                        </div>

                        <p className="text-sm text-muted-foreground mb-4 line-clamp-2">
                          {category.description}
                        </p>

                        <div className="flex gap-2">
                          <button
                            onClick={() => handleViewCategory(category.id)}
                            className="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-muted text-foreground rounded-lg hover:bg-muted/80 transition-colors text-sm"
                          >
                            <EyeIcon className="h-4 w-4" />
                            View
                          </button>
                          <button
                            onClick={() => handleEditCategory(category)}
                            className="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors text-sm"
                          >
                            <PencilIcon className="h-4 w-4" />
                            Edit
                          </button>
                          <button
                            onClick={() => handleDeleteCategory(category.id)}
                            className="px-3 py-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors"
                            title="Delete Category"
                          >
                            <TrashIcon className="h-4 w-4" />
                          </button>
                        </div>
                      </div>
                    )
                  })}
                </div>

                {/* Empty State */}
                {categories.length === 0 && (
                  <div className="bg-card border border-border rounded-xl p-12 text-center">
                    <BuildingOfficeIcon className="h-16 w-16 text-muted-foreground mx-auto mb-4" />
                    <h3 className="text-xl font-semibold text-foreground mb-2">No Categories Yet</h3>
                    <p className="text-muted-foreground mb-6">
                      Create your first property category to get started with organizing your listings.
                    </p>
                    <button
                      onClick={() => setShowAddCategory(true)}
                      className="inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      <PlusIcon className="h-5 w-5" />
                      Create First Category
                    </button>
                  </div>
                )}
              </div>
            )}

            {activeTab === 'agents' && (
              <div className="space-y-6">
                {/* Header with Stats */}
                <div className="flex items-center justify-between">
                  <div>
                    <h2 className="text-2xl font-bold text-foreground">Agent Management</h2>
                    <p className="text-muted-foreground mt-1">
                      Manage real estate agencies and their information
                    </p>
                  </div>
                  <button
                    onClick={() => setShowAddAgent(true)}
                    className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                  >
                    <PlusIcon className="h-4 w-4" />
                    Add Agent
                  </button>
                </div>

                {/* Agent Statistics */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-blue-500/10 rounded-lg">
                        <BuildingOfficeIcon className="h-5 w-5 text-blue-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">{agents.length}</div>
                        <div className="text-sm text-muted-foreground">Total Agents</div>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-5 w-5 text-green-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">
                          {agents.filter(a => a.isActive).length}
                        </div>
                        <div className="text-sm text-muted-foreground">Active Agents</div>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-yellow-500/10 rounded-lg">
                        <SparklesIcon className="h-5 w-5 text-yellow-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">
                          {agents.filter(a => a.verified).length}
                        </div>
                        <div className="text-sm text-muted-foreground">Verified Agents</div>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-4">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-purple-500/10 rounded-lg">
                        <HomeIcon className="h-5 w-5 text-purple-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">
                          {agents.reduce((sum, a) => sum + a.totalProperties, 0)}
                        </div>
                        <div className="text-sm text-muted-foreground">Total Properties</div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Agents Grid */}
                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  {agents.map((agent) => (
                    <div key={agent.id} className="bg-card border border-border rounded-xl p-6 hover:shadow-lg transition-shadow">
                      <div className="flex items-start gap-4">
                        <div className="w-16 h-16 rounded-lg overflow-hidden border border-border flex-shrink-0">
                          {agent.logo ? (
                            <img src={agent.logo} alt={agent.name} className="w-full h-full object-cover" />
                          ) : (
                            <div className="w-full h-full bg-muted flex items-center justify-center">
                              <BuildingOfficeIcon className="h-8 w-8 text-muted-foreground" />
                            </div>
                          )}
                        </div>

                        <div className="flex-1 min-w-0">
                          <div className="flex items-start justify-between mb-2">
                            <div>
                              <h3 className="text-lg font-semibold text-foreground truncate">{agent.name}</h3>
                              <p className="text-sm text-muted-foreground truncate">{agent.location}</p>
                            </div>
                            <div className="flex items-center gap-2 flex-shrink-0">
                              {agent.verified && (
                                <span className="px-2 py-1 bg-green-500/10 text-green-600 text-xs rounded-full">
                                  Verified
                                </span>
                              )}
                              {!agent.isActive && (
                                <span className="px-2 py-1 bg-red-500/10 text-red-500 text-xs rounded-full">
                                  Inactive
                                </span>
                              )}
                            </div>
                          </div>

                          <p className="text-sm text-muted-foreground mb-3 line-clamp-2">
                            {agent.description}
                          </p>

                          <div className="flex items-center gap-4 text-sm text-muted-foreground mb-4">
                            <span> {agent.email}</span>
                            <span> {agent.phone}</span>
                          </div>

                          <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4 text-sm">
                              <span className="text-muted-foreground">
                                 {agent.rating.toFixed(1)}
                              </span>
                              <span className="text-muted-foreground">
                                 {agent.totalProperties} properties
                              </span>
                            </div>

                            <div className="flex gap-2">
                              <button
                                onClick={() => handleViewAgent(agent.id)}
                                className="flex items-center justify-center gap-2 px-3 py-2 bg-muted text-foreground rounded-lg hover:bg-muted/80 transition-colors text-sm"
                              >
                                <EyeIcon className="h-4 w-4" />
                                View
                              </button>
                              <button
                                onClick={() => handleEditAgent(agent)}
                                className="flex items-center justify-center gap-2 px-3 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors text-sm"
                              >
                                <PencilIcon className="h-4 w-4" />
                                Edit
                              </button>
                              <button
                                onClick={() => handleToggleAgentStatus(agent.id)}
                                className={`px-3 py-2 rounded-lg transition-colors text-sm ${
                                  agent.isActive
                                    ? 'bg-yellow-500/10 text-yellow-600 hover:bg-yellow-500/20'
                                    : 'bg-green-500/10 text-green-600 hover:bg-green-500/20'
                                }`}
                                title={agent.isActive ? 'Deactivate Agent' : 'Activate Agent'}
                              >
                                {agent.isActive ? 'Deactivate' : 'Activate'}
                              </button>
                              <button
                                onClick={() => handleVerifyAgent(agent.id)}
                                className={`px-3 py-2 rounded-lg transition-colors text-sm ${
                                  agent.verified
                                    ? 'bg-blue-500/10 text-blue-600 hover:bg-blue-500/20'
                                    : 'bg-gray-500/10 text-gray-600 hover:bg-gray-500/20'
                                }`}
                                title={agent.verified ? 'Unverify Agent' : 'Verify Agent'}
                              >
                                {agent.verified ? 'Verified' : 'Verify'}
                              </button>
                              <button
                                onClick={() => handleDeleteAgent(agent.id)}
                                className="px-3 py-2 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors"
                                title="Delete Agent"
                              >
                                <TrashIcon className="h-4 w-4" />
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  ))}
                </div>

                {/* Empty State */}
                {agents.length === 0 && (
                  <div className="bg-card border border-border rounded-xl p-12 text-center">
                    <BuildingOfficeIcon className="h-16 w-16 text-muted-foreground mx-auto mb-4" />
                    <h3 className="text-xl font-semibold text-foreground mb-2">No Agents Yet</h3>
                    <p className="text-muted-foreground mb-6">
                      Add your first real estate agency to start managing agent information.
                    </p>
                    <button
                      onClick={() => setShowAddAgent(true)}
                      className="inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      <PlusIcon className="h-5 w-5" />
                      Add First Agent
                    </button>
                  </div>
                )}
              </div>
            )}

            {activeTab === 'analytics' && (
              <div className="space-y-6">
                {/* Header */}
                <div className="flex items-center justify-between">
                  <div>
                    <h2 className="text-2xl font-bold text-foreground">Analytics Dashboard</h2>
                    <p className="text-muted-foreground mt-1">
                      Comprehensive insights into your real estate platform performance
                    </p>
                  </div>
                  <div className="flex items-center gap-3">
                    <select
                      value={selectedTimeRange}
                      onChange={(e) => setSelectedTimeRange(e.target.value)}
                      className="px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary text-foreground"
                    >
                      <option value="7d">Last 7 days</option>
                      <option value="30d">Last 30 days</option>
                      <option value="90d">Last 90 days</option>
                      <option value="1y">Last year</option>
                    </select>
                  </div>
                </div>

                {/* Key Metrics Overview */}
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-blue-500/10 rounded-lg">
                        <HomeIcon className="h-6 w-6 text-blue-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">{analyticsData.overview.totalProperties}</div>
                        <div className="text-sm text-muted-foreground">Total Properties</div>
                      </div>
                    </div>
                    <div className="mt-3 flex items-center text-sm">
                      <span className="text-green-500">+12%</span>
                      <span className="text-muted-foreground ml-1">from last month</span>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-green-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">{analyticsData.overview.totalViews.toLocaleString()}</div>
                        <div className="text-sm text-muted-foreground">Total Views</div>
                      </div>
                    </div>
                    <div className="mt-3 flex items-center text-sm">
                      <span className="text-green-500">+8.5%</span>
                      <span className="text-muted-foreground ml-1">from last month</span>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-yellow-500/10 rounded-lg">
                        <LinkIcon className="h-6 w-6 text-yellow-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">{analyticsData.overview.totalInquiries}</div>
                        <div className="text-sm text-muted-foreground">Total Inquiries</div>
                      </div>
                    </div>
                    <div className="mt-3 flex items-center text-sm">
                      <span className="text-green-500">+15.2%</span>
                      <span className="text-muted-foreground ml-1">from last month</span>
                    </div>
                  </div>

                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-purple-500/10 rounded-lg">
                        <SparklesIcon className="h-6 w-6 text-purple-500" />
                      </div>
                      <div>
                        <div className="text-2xl font-bold text-foreground">AED {(analyticsData.overview.totalRevenue / 1000000).toFixed(0)}M</div>
                        <div className="text-sm text-muted-foreground">Total Revenue</div>
                      </div>
                    </div>
                    <div className="mt-3 flex items-center text-sm">
                      <span className="text-green-500">+22.1%</span>
                      <span className="text-muted-foreground ml-1">from last month</span>
                    </div>
                  </div>
                </div>

                {/* Charts Row */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  {/* Property Views Trend */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">Property Views Trend</h3>
                    <div className="h-64 flex items-end justify-between gap-2">
                      {analyticsData.trends.propertyViewsTrend.map((data, index) => (
                        <div key={index} className="flex flex-col items-center gap-2 flex-1">
                          <div
                            className="bg-primary/20 rounded-t w-full transition-all hover:bg-primary/30"
                            style={{
                              height: `${(data.views / 2000) * 100}%`,
                              minHeight: '20px'
                            }}
                          ></div>
                          <span className="text-xs text-muted-foreground">
                            {new Date(data.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                          </span>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Revenue by Category */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">Revenue by Category</h3>
                    <div className="space-y-4">
                      {analyticsData.revenueAnalytics.revenueByCategory.map((item, index) => (
                        <div key={index} className="flex items-center justify-between">
                          <div className="flex items-center gap-3">
                            <div className={`w-3 h-3 rounded-full ${
                              index === 0 ? 'bg-blue-500' : index === 1 ? 'bg-green-500' : 'bg-yellow-500'
                            }`}></div>
                            <span className="text-sm font-medium text-foreground">{item.category}</span>
                          </div>
                          <div className="text-right">
                            <div className="text-sm font-semibold text-foreground">
                              AED {(item.revenue / 1000000).toFixed(1)}M
                            </div>
                            <div className="text-xs text-muted-foreground">{item.percentage}%</div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>

                {/* Property Analytics */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  {/* Views by Category */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">Views by Category</h3>
                    <div className="space-y-3">
                      {analyticsData.propertyAnalytics.viewsByCategory.map((item, index) => (
                        <div key={index} className="flex items-center justify-between">
                          <span className="text-sm text-foreground">{item.category}</span>
                          <div className="flex items-center gap-3">
                            <div className="w-24 bg-muted rounded-full h-2">
                              <div
                                className="bg-primary h-2 rounded-full"
                                style={{ width: `${item.percentage}%` }}
                              ></div>
                            </div>
                            <span className="text-sm font-medium text-foreground w-12 text-right">
                              {item.views.toLocaleString()}
                            </span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Price Range Distribution */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">Property Price Distribution</h3>
                    <div className="space-y-3">
                      {analyticsData.propertyAnalytics.priceRanges.map((item, index) => (
                        <div key={index} className="flex items-center justify-between">
                          <span className="text-sm text-foreground">{item.range}</span>
                          <div className="flex items-center gap-3">
                            <div className="w-24 bg-muted rounded-full h-2">
                              <div
                                className="bg-green-500 h-2 rounded-full"
                                style={{ width: `${item.percentage}%` }}
                              ></div>
                            </div>
                            <span className="text-sm font-medium text-foreground w-8 text-right">
                              {item.count}
                            </span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>

                {/* Agent Performance & User Engagement */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  {/* Top Agents */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">Top Performing Agents</h3>
                    <div className="space-y-4">
                      {analyticsData.agentAnalytics.topAgents.map((agent, index) => (
                        <div key={index} className="flex items-center justify-between p-3 bg-muted/30 rounded-lg">
                          <div className="flex items-center gap-3">
                            <div className="w-8 h-8 bg-primary/10 rounded-full flex items-center justify-center">
                              <span className="text-sm font-semibold text-primary">{index + 1}</span>
                            </div>
                            <div>
                              <div className="text-sm font-medium text-foreground">{agent.name}</div>
                              <div className="text-xs text-muted-foreground">{agent.properties} properties</div>
                            </div>
                          </div>
                          <div className="text-right">
                            <div className="text-sm font-semibold text-foreground">
                              AED {(agent.sales / 1000000).toFixed(0)}M
                            </div>
                            <div className="flex items-center gap-1">
                              <span className="text-xs text-muted-foreground"> {agent.rating}</span>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* User Engagement */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">User Engagement</h3>
                    <div className="grid grid-cols-2 gap-4">
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-2xl font-bold text-foreground">{analyticsData.userEngagement.dailyActiveUsers}</div>
                        <div className="text-sm text-muted-foreground">Daily Active Users</div>
                      </div>
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-2xl font-bold text-foreground">{analyticsData.userEngagement.sessionDuration}</div>
                        <div className="text-sm text-muted-foreground">Avg. Session Time</div>
                      </div>
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-2xl font-bold text-foreground">{analyticsData.userEngagement.monthlyActiveUsers.toLocaleString()}</div>
                        <div className="text-sm text-muted-foreground">Monthly Active Users</div>
                      </div>
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-2xl font-bold text-foreground">{analyticsData.userEngagement.bounceRate}%</div>
                        <div className="text-sm text-muted-foreground">Bounce Rate</div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Top Pages & Performance Metrics */}
                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                  {/* Top Pages */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">Top Performing Pages</h3>
                    <div className="space-y-3">
                      {analyticsData.userEngagement.topPages.map((page, index) => (
                        <div key={index} className="flex items-center justify-between p-3 bg-muted/30 rounded-lg">
                          <div className="flex items-center gap-3">
                            <div className="w-6 h-6 bg-primary/10 rounded flex items-center justify-center">
                              <span className="text-xs font-semibold text-primary">{index + 1}</span>
                            </div>
                            <span className="text-sm font-medium text-foreground">{page.page}</span>
                          </div>
                          <div className="text-right">
                            <div className="text-sm font-semibold text-foreground">{page.views.toLocaleString()}</div>
                            <div className="text-xs text-muted-foreground">{page.percentage}%</div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>

                  {/* Performance Metrics */}
                  <div className="bg-card border border-border rounded-xl p-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">Agent Performance Metrics</h3>
                    <div className="grid grid-cols-2 gap-4">
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-lg font-semibold text-foreground">{analyticsData.agentAnalytics.performanceMetrics.avgResponseTime}</div>
                        <div className="text-sm text-muted-foreground">Avg Response Time</div>
                      </div>
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-lg font-semibold text-foreground">{analyticsData.agentAnalytics.performanceMetrics.avgClosingTime}</div>
                        <div className="text-sm text-muted-foreground">Avg Closing Time</div>
                      </div>
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-lg font-semibold text-foreground"> {analyticsData.agentAnalytics.performanceMetrics.clientSatisfaction}</div>
                        <div className="text-sm text-muted-foreground">Client Satisfaction</div>
                      </div>
                      <div className="text-center p-4 bg-muted/30 rounded-lg">
                        <div className="text-lg font-semibold text-foreground">{analyticsData.agentAnalytics.performanceMetrics.repeatClients}%</div>
                        <div className="text-sm text-muted-foreground">Repeat Clients</div>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Monthly Revenue Chart */}
                <div className="bg-card border border-border rounded-xl p-6">
                  <h3 className="text-lg font-semibold text-foreground mb-4">Monthly Revenue Trend</h3>
                  <div className="h-64 flex items-end justify-between gap-1">
                    {analyticsData.revenueAnalytics.monthlyRevenue.map((data, index) => (
                      <div key={index} className="flex flex-col items-center gap-2 flex-1">
                        <div
                          className="bg-green-500/20 rounded-t w-full transition-all hover:bg-green-500/30"
                          style={{
                            height: `${(data.revenue / 50000000) * 100}%`,
                            minHeight: '20px'
                          }}
                        ></div>
                        <span className="text-xs text-muted-foreground transform -rotate-45 origin-top-left">
                          {data.month}
                        </span>
                      </div>
                    ))}
                  </div>
                  <div className="mt-4 text-center">
                    <div className="text-sm text-muted-foreground">
                      Revenue in AED (Millions) - Last 12 Months
                    </div>
                  </div>
                </div>
              </div>
            )}

            {activeTab === 'navigation' && (
              <div className="space-y-6">
                <div className="flex items-center justify-between">
                  <h2 className="text-2xl font-bold text-foreground">Navigation Management</h2>
                  <button
                    onClick={() => setShowAddNavItem(true)}
                    className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                  >
                    <PlusIcon className="h-4 w-4" />
                    Add Navigation Item
                  </button>
                </div>

                {/* Navigation Structure */}
                <div className="bg-card border border-border rounded-xl p-6">
                  <h3 className="text-lg font-semibold text-foreground mb-4">Navbar Structure</h3>
                  <div className="space-y-4">
                    {navigationItems
                      .sort((a, b) => a.order - b.order)
                      .map((navItem) => (
                        <div
                          key={navItem.id}
                          draggable
                          onDragStart={(e) => handleDragStart(e, navItem, 'nav-item')}
                          onDragOver={(e) => handleDragOver(e, navItem.id)}
                          onDragLeave={handleDragLeave}
                          onDrop={(e) => handleDrop(e, navItem, 'nav-item')}
                          className={`border border-border rounded-lg p-4 cursor-move hover:bg-muted/50 transition-colors ${
                            draggedOver === navItem.id ? 'ring-2 ring-primary bg-primary/5' : 'bg-muted/30'
                          }`}
                        >
                          <div className="flex items-center justify-between mb-3">
                            <div className="flex items-center gap-3">
                              <Bars3Icon className="h-5 w-5 text-muted-foreground" />
                              <span className="font-semibold text-foreground">{navItem.label}</span>
                              <span className="px-2 py-1 bg-primary/10 text-primary text-xs rounded">
                                {navItem.type}
                              </span>
                            </div>
                            <div className="flex gap-2">
                              <button
                                onClick={() => setEditingNavItem(navItem)}
                                className="p-2 hover:bg-background rounded-lg transition-colors"
                              >
                                <PencilIcon className="h-4 w-4 text-muted-foreground" />
                              </button>
                              <button
                                onClick={() => deleteNavItem(navItem.id)}
                                className="p-2 hover:bg-background rounded-lg transition-colors"
                              >
                                <TrashIcon className="h-4 w-4 text-muted-foreground" />
                              </button>
                            </div>
                          </div>

                          {navItem.type === 'dropdown' && navItem.categories && (
                            <div className="ml-8 space-y-3">
                              {navItem.categories
                                .sort((a: any, b: any) => a.order - b.order)
                                .map((category: any) => (
                                  <div
                                    key={category.label}
                                    draggable
                                    onDragStart={(e) => handleDragStart(e, category, 'category', navItem.id)}
                                    onDragOver={(e) => handleDragOver(e, `${navItem.id}-${category.label}`)}
                                    onDragLeave={handleDragLeave}
                                    onDrop={(e) => handleDrop(e, { ...category, categoryLabel: category.label }, 'category', navItem.id)}
                                    className={`border border-border rounded p-3 cursor-move hover:bg-muted/30 transition-colors ${
                                      draggedOver === `${navItem.id}-${category.label}` ? 'ring-2 ring-primary bg-primary/5' : 'bg-background'
                                    }`}
                                  >
                                    <div className="flex items-center justify-between mb-2">
                                      <span className="font-medium text-foreground">{category.label}</span>
                                      <div className="flex gap-1">
                                        <button
                                          onClick={() => addSubcategory(navItem.id, category.label, {
                                            label: 'New Subcategory',
                                            href: '#',
                                          })}
                                          className="p-1 hover:bg-muted rounded transition-colors"
                                          title="Add subcategory"
                                        >
                                          <PlusIcon className="h-3 w-3 text-muted-foreground" />
                                        </button>
                                      </div>
                                    </div>

                                    {category.subcategories && category.subcategories.length > 0 && (
                                      <div className="ml-4 space-y-2">
                                        {category.subcategories
                                          .sort((a: any, b: any) => a.order - b.order)
                                          .map((subcategory: any) => (
                                            <div
                                              key={subcategory.label}
                                              draggable
                                              onDragStart={(e) => handleDragStart(e, subcategory, 'subcategory', navItem.id)}
                                              onDragOver={(e) => handleDragOver(e, `${navItem.id}-${category.label}-${subcategory.label}`)}
                                              onDragLeave={handleDragLeave}
                                              onDrop={(e) => handleDrop(e, { ...subcategory, categoryLabel: category.label }, 'subcategory', navItem.id)}
                                              className={`flex items-center justify-between p-2 rounded cursor-move hover:bg-muted/70 transition-colors ${
                                                draggedOver === `${navItem.id}-${category.label}-${subcategory.label}` ? 'ring-2 ring-primary bg-primary/5' : 'bg-muted/50'
                                              }`}
                                            >
                                              <span className="text-sm text-muted-foreground">{subcategory.label}</span>
                                              <LinkIcon className="h-3 w-3 text-muted-foreground" />
                                            </div>
                                          ))}
                                      </div>
                                    )}
                                  </div>
                                ))}

                              <button
                                onClick={() => addCategory(navItem.id, {
                                  label: 'New Category',
                                  href: '#',
                                  hasSubcategories: false,
                                })}
                                className="w-full flex items-center justify-center gap-2 p-3 border-2 border-dashed border-border rounded-lg hover:border-primary hover:bg-primary/5 transition-colors text-muted-foreground"
                              >
                                <PlusIcon className="h-4 w-4" />
                                Add Category
                              </button>
                            </div>
                          )}
                        </div>
                      ))}
                  </div>
                </div>

                {/* Quick Actions */}
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <button className="flex items-center gap-3 p-4 bg-primary/10 border border-primary/20 rounded-lg hover:bg-primary/20 transition-colors">
                    <EyeIcon className="h-6 w-6 text-primary" />
                    <div className="text-left">
                      <div className="font-semibold text-primary">Preview Navbar</div>
                      <div className="text-sm text-primary/80">See how it looks</div>
                    </div>
                  </button>
                  <button
                    onClick={exportNavigation}
                    className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                  >
                    <LinkIcon className="h-6 w-6 text-muted-foreground" />
                    <div className="text-left">
                      <div className="font-semibold text-foreground">Export Structure</div>
                      <div className="text-sm text-muted-foreground">Download JSON</div>
                    </div>
                  </button>
                  <button
                    onClick={resetToDefault}
                    className="flex items-center gap-3 p-4 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                  >
                    <Bars3Icon className="h-6 w-6 text-muted-foreground" />
                    <div className="text-left">
                      <div className="font-semibold text-foreground">Reset to Default</div>
                      <div className="text-sm text-muted-foreground">Restore original</div>
                    </div>
                  </button>
                </div>
              </div>
            )}

            {activeTab === 'users' && (
              <div className="space-y-6">
                <div className="flex items-center justify-between">
                  <h2 className="text-2xl font-bold text-foreground">User Management</h2>
                  <button
                    onClick={() => setShowAddUser(true)}
                    className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                  >
                    <PlusIcon className="h-4 w-4" />
                    Add User
                  </button>
                </div>

                {/* User Statistics */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-blue-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-blue-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">{users.length}</p>
                        <p className="text-sm text-muted-foreground">Total Users</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-green-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {users.filter(u => u.status === 'active').length}
                        </p>
                        <p className="text-sm text-muted-foreground">Active Users</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-blue-500/10 rounded-lg">
                        <BuildingStorefrontIcon className="h-6 w-6 text-blue-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {users.filter(u => u.role === 'agent').length}
                        </p>
                        <p className="text-sm text-muted-foreground">Agents</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-orange-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-orange-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {users.filter(u => u.verified).length}
                        </p>
                        <p className="text-sm text-muted-foreground">Verified Users</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Filters and Search */}
                <div className="bg-card border border-border rounded-xl p-6">
                  <div className="flex flex-col lg:flex-row gap-4 mb-6">
                    {/* Search */}
                    <div className="flex-1">
                      <input
                        type="text"
                        placeholder="Search users by name, email, or location..."
                        value={userSearchTerm}
                        onChange={(e) => setUserSearchTerm(e.target.value)}
                        className="w-full px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                      />
                    </div>

                    {/* Role Filter */}
                    <select
                      value={userRoleFilter}
                      onChange={(e) => setUserRoleFilter(e.target.value)}
                      className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                    >
                      <option value="all">All Roles</option>
                      <option value="customer">Customers</option>
                      <option value="agent">Agents</option>
                      <option value="admin">Admins</option>
                    </select>

                    {/* Status Filter */}
                    <select
                      value={userStatusFilter}
                      onChange={(e) => setUserStatusFilter(e.target.value)}
                      className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                    >
                      <option value="all">All Status</option>
                      <option value="active">Active</option>
                      <option value="inactive">Inactive</option>
                      <option value="pending">Pending</option>
                      <option value="suspended">Suspended</option>
                    </select>

                    {/* Sort By */}
                    <select
                      value={userSortBy}
                      onChange={(e) => setUserSortBy(e.target.value)}
                      className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                    >
                      <option value="joinDate">Join Date</option>
                      <option value="name">Name</option>
                      <option value="email">Email</option>
                      <option value="totalInquiries">Inquiries</option>
                      <option value="lastLogin">Last Login</option>
                    </select>

                    {/* Sort Order */}
                    <button
                      onClick={() => setUserSortOrder(userSortOrder === 'asc' ? 'desc' : 'asc')}
                      className="p-2 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      {userSortOrder === 'asc' ? <ChevronUpIcon className="h-4 w-4" /> : <ChevronDownIcon className="h-4 w-4" />}
                    </button>
                  </div>

                  {/* Bulk Actions */}
                  {selectedUsers.length > 0 && (
                    <div className="flex items-center gap-4 p-4 bg-muted/30 rounded-lg">
                      <span className="text-sm font-medium text-foreground">
                        {selectedUsers.length} user{selectedUsers.length > 1 ? 's' : ''} selected
                      </span>
                      <div className="flex gap-2">
                        <button
                          onClick={() => handleUserBulkAction('activate')}
                          className="px-3 py-1 bg-green-500/10 text-green-600 text-sm rounded hover:bg-green-500/20 transition-colors"
                        >
                          Activate
                        </button>
                        <button
                          onClick={() => handleUserBulkAction('deactivate')}
                          className="px-3 py-1 bg-red-500/10 text-red-600 text-sm rounded hover:bg-red-500/20 transition-colors"
                        >
                          Deactivate
                        </button>
                        <button
                          onClick={() => handleUserBulkAction('verify')}
                          className="px-3 py-1 bg-blue-500/10 text-blue-600 text-sm rounded hover:bg-blue-500/20 transition-colors"
                        >
                          Verify
                        </button>
                        <button
                          onClick={() => handleUserBulkAction('delete')}
                          className="px-3 py-1 bg-red-500/10 text-red-600 text-sm rounded hover:bg-red-500/20 transition-colors"
                        >
                          Delete
                        </button>
                      </div>
                    </div>
                  )}
                </div>

                {/* Users Table */}
                <div className="bg-card border border-border rounded-xl overflow-hidden">
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead className="bg-muted/30">
                        <tr>
                          <th className="px-6 py-4 text-left">
                            <input
                              type="checkbox"
                              checked={selectedUsers.length === paginatedUsers.length && paginatedUsers.length > 0}
                              onChange={handleSelectAllUsers}
                              className="rounded border-border text-primary focus:ring-primary/50"
                            />
                          </th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">User</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Role</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Status</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Location</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Join Date</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Last Login</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Activity</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Actions</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-border">
                        {paginatedUsers.map((user) => (
                          <tr key={user.id} className="hover:bg-muted/30">
                            <td className="px-6 py-4">
                              <input
                                type="checkbox"
                                checked={selectedUsers.includes(user.id)}
                                onChange={() => handleSelectUser(user.id)}
                                className="rounded border-border text-primary focus:ring-primary/50"
                              />
                            </td>
                            <td className="px-6 py-4">
                              <div className="flex items-center gap-3">
                                <div className="w-10 h-10 rounded-full overflow-hidden flex-shrink-0">
                                  {user.avatar ? (
                                    <img src={user.avatar} alt={user.name} className="w-full h-full object-cover" />
                                  ) : (
                                    <div className="w-full h-full bg-primary/10 flex items-center justify-center">
                                      <span className="text-sm font-semibold text-primary">
                                        {user.name.split(' ').map((n: string) => n[0]).join('')}
                                      </span>
                                    </div>
                                  )}
                                </div>
                                <div>
                                  <div className="font-semibold text-foreground flex items-center gap-2">
                                    {user.name}
                                    {user.verified && (
                                      <span className="text-blue-500"></span>
                                    )}
                                  </div>
                                  <div className="text-sm text-muted-foreground">{user.email}</div>
                                  <div className="text-sm text-muted-foreground">{user.phone}</div>
                                </div>
                              </div>
                            </td>
                            <td className="px-6 py-4">
                              <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                user.role === 'admin' ? 'bg-purple-500/10 text-purple-600' :
                                user.role === 'agent' ? 'bg-blue-500/10 text-blue-600' :
                                'bg-gray-500/10 text-gray-600'
                              }`}>
                                {user.role.charAt(0).toUpperCase() + user.role.slice(1)}
                              </span>
                            </td>
                            <td className="px-6 py-4">
                              <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                user.status === 'active' ? 'bg-green-500/10 text-green-600' :
                                user.status === 'inactive' ? 'bg-red-500/10 text-red-600' :
                                user.status === 'pending' ? 'bg-yellow-500/10 text-yellow-600' :
                                'bg-orange-500/10 text-orange-600'
                              }`}>
                                {user.status.charAt(0).toUpperCase() + user.status.slice(1)}
                              </span>
                            </td>
                            <td className="px-6 py-4 text-sm text-foreground">{user.location}</td>
                            <td className="px-6 py-4 text-sm text-foreground">{user.joinDate}</td>
                            <td className="px-6 py-4 text-sm text-foreground">
                              {user.lastLogin || 'Never'}
                            </td>
                            <td className="px-6 py-4">
                              <div className="text-sm">
                                <div className="text-foreground">{user.totalInquiries} inquiries</div>
                                <div className="text-muted-foreground">{user.totalFavorites} favorites</div>
                              </div>
                            </td>
                            <td className="px-6 py-4">
                              <div className="flex items-center gap-2">
                                <button
                                  onClick={() => handleViewUser(user.id)}
                                  className="p-2 hover:bg-muted rounded-lg transition-colors"
                                  title="View Details"
                                >
                                  <EyeIcon className="h-4 w-4 text-muted-foreground" />
                                </button>
                                <button
                                  onClick={() => handleEditUser(user)}
                                  className="p-2 hover:bg-muted rounded-lg transition-colors"
                                  title="Edit User"
                                >
                                  <PencilIcon className="h-4 w-4 text-muted-foreground" />
                                </button>
                                <button
                                  onClick={() => handleToggleUserStatus(user.id)}
                                  className={`p-2 hover:bg-muted rounded-lg transition-colors ${
                                    user.status === 'active' ? 'text-green-500' : 'text-red-500'
                                  }`}
                                  title={user.status === 'active' ? 'Deactivate' : 'Activate'}
                                >
                                  {user.status === 'active' ? '' : ''}
                                </button>
                                {user.role !== 'admin' && (
                                  <button
                                    onClick={() => handleDeleteUser(user.id)}
                                    className="p-2 hover:bg-red-500/10 rounded-lg transition-colors"
                                    title="Delete User"
                                  >
                                    <TrashIcon className="h-4 w-4 text-red-500" />
                                  </button>
                                )}
                              </div>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>

                  {/* Pagination */}
                  {userTotalPages > 1 && (
                    <div className="px-6 py-4 border-t border-border flex items-center justify-between">
                      <div className="text-sm text-muted-foreground">
                        Showing {userStartIndex + 1} to {Math.min(userStartIndex + userItemsPerPage, filteredUsers.length)} of {filteredUsers.length} users
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => setUserCurrentPage(prev => Math.max(1, prev - 1))}
                          disabled={userCurrentPage === 1}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Previous
                        </button>
                        <span className="px-3 py-1 text-sm">
                          Page {userCurrentPage} of {userTotalPages}
                        </span>
                        <button
                          onClick={() => setUserCurrentPage(prev => Math.min(userTotalPages, prev + 1))}
                          disabled={userCurrentPage === userTotalPages}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Next
                        </button>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}

            {activeTab === 'forms' && (
              <div className="space-y-6">
                <div className="flex items-center justify-between">
                  <h2 className="text-2xl font-bold text-foreground">Form Applications</h2>
                  <div className="flex gap-2">
                    <select
                      value={formStatusFilter}
                      onChange={(e) => setFormStatusFilter(e.target.value)}
                      className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                    >
                      <option value="all">All Status</option>
                      <option value="unread">Unread</option>
                      <option value="read">Read</option>
                      <option value="responded">Responded</option>
                    </select>
                    <select
                      value={formSortBy}
                      onChange={(e) => setFormSortBy(e.target.value)}
                      className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                    >
                      <option value="date">Sort by Date</option>
                      <option value="name">Sort by Name</option>
                      <option value="priority">Sort by Priority</option>
                      <option value="formType">Sort by Type</option>
                    </select>
                    <button
                      onClick={() => setFormSortOrder(formSortOrder === 'asc' ? 'desc' : 'asc')}
                      className="px-4 py-2 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                    >
                      {formSortOrder === 'asc' ? '' : ''}
                    </button>
                    <button
                      onClick={() => handleExportFormSubmissions('csv')}
                      className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      <ArrowDownTrayIcon className="h-4 w-4" />
                      Export CSV
                    </button>
                  </div>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-blue-500/10 rounded-lg">
                        <PencilIcon className="h-6 w-6 text-blue-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">{formSubmissions.length}</p>
                        <p className="text-sm text-muted-foreground">Total Applications</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-green-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-green-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {formSubmissions.filter(s => s.status === 'unread').length}
                        </p>
                        <p className="text-sm text-muted-foreground">Unread</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-yellow-500/10 rounded-lg">
                        <ClockIcon className="h-6 w-6 text-yellow-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {formSubmissions.filter(s => {
                            const submissionDate = new Date(s.date)
                            const weekAgo = new Date()
                            weekAgo.setDate(weekAgo.getDate() - 7)
                            return submissionDate >= weekAgo
                          }).length}
                        </p>
                        <p className="text-sm text-muted-foreground">This Week</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-orange-500/10 rounded-lg">
                        <BriefcaseIcon className="h-6 w-6 text-orange-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {formSubmissions.filter(s => s.formType === 'career').length}
                        </p>
                        <p className="text-sm text-muted-foreground">Career Apps</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="bg-card border border-border rounded-xl overflow-hidden">
                  <div className="p-6 border-b border-border">
                    <div className="flex items-center justify-between">
                      <h3 className="text-lg font-semibold text-foreground">Form Submissions</h3>
                      <div className="flex items-center gap-4">
                        <input
                          type="text"
                          placeholder="Search submissions..."
                          value={formSearchTerm}
                          onChange={(e) => setFormSearchTerm(e.target.value)}
                          className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                        />
                        {selectedFormSubmissions.length > 0 && (
                          <div className="flex items-center gap-2">
                            <span className="text-sm text-muted-foreground">
                              {selectedFormSubmissions.length} selected
                            </span>
                            <button
                              onClick={() => {
                                selectedFormSubmissions.forEach(id => handleMarkFormAsRead(id))
                                setSelectedFormSubmissions([])
                              }}
                              className="px-3 py-1 bg-green-500/10 text-green-500 rounded-lg hover:bg-green-500/20 transition-colors text-sm"
                            >
                              Mark Read
                            </button>
                            <button
                              onClick={() => {
                                selectedFormSubmissions.forEach(id => handleDeleteFormSubmission(id))
                                setSelectedFormSubmissions([])
                              }}
                              className="px-3 py-1 bg-red-500/10 text-red-500 rounded-lg hover:bg-red-500/20 transition-colors text-sm"
                            >
                              Delete
                            </button>
                          </div>
                        )}
                      </div>
                    </div>
                  </div>
                  <div className="divide-y divide-border">
                    {filteredFormSubmissions.slice(
                      (formCurrentPage - 1) * formItemsPerPage,
                      formCurrentPage * formItemsPerPage
                    ).map((submission) => (
                      <div key={submission.id} className="p-6 hover:bg-muted/30 transition-colors">
                        <div className="flex items-start justify-between mb-4">
                          <div className="flex items-start gap-3 mb-2">
                            <input
                              type="checkbox"
                              checked={selectedFormSubmissions.includes(submission.id)}
                              onChange={(e) => {
                                if (e.target.checked) {
                                  setSelectedFormSubmissions(prev => [...prev, submission.id])
                                } else {
                                  setSelectedFormSubmissions(prev => prev.filter(id => id !== submission.id))
                                }
                              }}
                              className="mt-1"
                            />
                            <div className="flex-1">
                              <div className="flex items-center gap-3 mb-2">
                                <h4 className="font-semibold text-foreground">{submission.name}</h4>
                                <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                                  submission.formType === 'contact' ? 'bg-blue-500/10 text-blue-500' :
                                  submission.formType === 'career' ? 'bg-green-500/10 text-green-500' :
                                  submission.formType === 'property_inquiry' ? 'bg-purple-500/10 text-purple-500' :
                                  'bg-orange-500/10 text-orange-500'
                                }`}>
                                  {submission.formType.replace('_', ' ').replace(/\b\w/g, function(l: string) { return l.toUpperCase(); })}
                                </span>
                                <span className={`px-2 py-1 rounded-full text-xs ${
                                  submission.status === 'unread' ? 'bg-red-500/10 text-red-500' :
                                  submission.status === 'read' ? 'bg-gray-500/10 text-gray-500' :
                                  'bg-blue-500/10 text-blue-500'
                                }`}>
                                  {submission.status}
                                </span>
                                <span className={`px-2 py-1 rounded-full text-xs ${
                                  submission.priority === 'high' ? 'bg-red-500/10 text-red-500' :
                                  submission.priority === 'normal' ? 'bg-yellow-500/10 text-yellow-500' :
                                  'bg-gray-500/10 text-gray-500'
                                }`}>
                                  {submission.priority}
                                </span>
                              </div>
                              <p className="text-sm text-muted-foreground mb-1">{submission.email}  {submission.phone}</p>
                              <p className="font-medium text-foreground mb-2">{submission.subject}</p>
                              <p className="text-sm text-muted-foreground line-clamp-2">{submission.message}</p>
                              {submission.attachments && submission.attachments.length > 0 && (
                                <div className="flex items-center gap-2 mt-2">
                                  <PaperClipIcon className="h-4 w-4 text-muted-foreground" />
                                  <span className="text-xs text-muted-foreground">
                                    {submission.attachments.length} attachment{submission.attachments.length > 1 ? 's' : ''}
                                  </span>
                                </div>
                              )}
                            </div>
                          </div>
                          <div className="flex flex-col items-end gap-2 ml-4">
                            <span className="text-sm text-muted-foreground">
                              {new Date(submission.date).toLocaleDateString()}
                            </span>
                            <div className="flex gap-2">
                              <button
                                onClick={() => handleViewFormSubmission(submission.id)}
                                className="p-2 hover:bg-background rounded-lg transition-colors"
                                title="View Details"
                              >
                                <EyeIcon className="h-4 w-4 text-muted-foreground" />
                              </button>
                              {submission.status === 'unread' ? (
                                <button
                                  onClick={() => handleMarkFormAsRead(submission.id)}
                                  className="p-2 hover:bg-background rounded-lg transition-colors"
                                  title="Mark as Read"
                                >
                                  <EnvelopeIcon className="h-4 w-4 text-muted-foreground" />
                                </button>
                              ) : (
                                <button
                                  onClick={() => handleMarkFormAsUnread(submission.id)}
                                  className="p-2 hover:bg-background rounded-lg transition-colors"
                                  title="Mark as Unread"
                                >
                                  <EnvelopeOpenIcon className="h-4 w-4 text-muted-foreground" />
                                </button>
                              )}
                              <select
                                value={submission.priority}
                                onChange={(e) => handleUpdateFormPriority(submission.id, e.target.value as 'low' | 'normal' | 'high')}
                                className="px-2 py-1 bg-muted border border-border rounded text-xs focus:outline-none focus:ring-1 focus:ring-primary/50"
                              >
                                <option value="low">Low</option>
                                <option value="normal">Normal</option>
                                <option value="high">High</option>
                              </select>
                              <button
                                onClick={() => handleDeleteFormSubmission(submission.id)}
                                className="p-2 hover:bg-red-500/20 text-red-500 rounded-lg transition-colors"
                                title="Delete"
                              >
                                <TrashIcon className="h-4 w-4" />
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    ))}
                  </div>
                  {formTotalPages > 1 && (
                    <div className="p-6 border-t border-border flex items-center justify-between">
                      <div className="flex items-center gap-2">
                        <span className="text-sm text-muted-foreground">Show</span>
                        <select
                          value={formItemsPerPage}
                          onChange={(e) => {
                            setFormItemsPerPage(Number(e.target.value))
                            setFormCurrentPage(1)
                          }}
                          className="px-2 py-1 bg-muted border border-border rounded text-sm focus:outline-none focus:ring-1 focus:ring-primary/50"
                        >
                          <option value={10}>10</option>
                          <option value={25}>25</option>
                          <option value={50}>50</option>
                        </select>
                        <span className="text-sm text-muted-foreground">per page</span>
                      </div>
                      <div className="flex items-center gap-2">
                        <button
                          onClick={() => setFormCurrentPage(prev => Math.max(1, prev - 1))}
                          disabled={formCurrentPage === 1}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Previous
                        </button>
                        <span className="px-3 py-1 text-sm">
                          Page {formCurrentPage} of {formTotalPages}
                        </span>
                        <button
                          onClick={() => setFormCurrentPage(prev => Math.min(formTotalPages, prev + 1))}
                          disabled={formCurrentPage === formTotalPages}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Next
                        </button>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}

            {activeTab === 'content' && (
              <div className="space-y-6">
                <div className="flex items-center justify-between">
                  <h2 className="text-2xl font-bold text-foreground">Content Management</h2>
                  <div className="flex gap-2">
                    <button
                      onClick={() => {
                        setContentType('articles')
                        setShowAddContent(true)
                      }}
                      className="flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      <PlusIcon className="h-4 w-4" />
                      Add Article
                    </button>
                    <button
                      onClick={() => {
                        setContentType('guides')
                        setShowAddContent(true)
                      }}
                      className="flex items-center gap-2 px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/90 transition-colors"
                    >
                      <PlusIcon className="h-4 w-4" />
                      Add Guide
                    </button>
                  </div>
                </div>

                {/* Content Type Tabs */}
                <div className="flex gap-1 p-1 bg-muted rounded-lg w-fit">
                  <button
                    onClick={() => setContentType('articles')}
                    className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
                      contentType === 'articles'
                        ? 'bg-background text-foreground shadow-sm'
                        : 'text-muted-foreground hover:text-foreground'
                    }`}
                  >
                    Articles ({articles.length})
                  </button>
                  <button
                    onClick={() => setContentType('guides')}
                    className={`px-4 py-2 rounded-md text-sm font-medium transition-colors ${
                      contentType === 'guides'
                        ? 'bg-background text-foreground shadow-sm'
                        : 'text-muted-foreground hover:text-foreground'
                    }`}
                  >
                    Guides ({guides.length})
                  </button>
                </div>

                {/* Statistics Cards */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-blue-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-blue-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {contentType === 'articles'
                            ? articles.filter(a => a.status === 'published').length
                            : guides.filter(g => g.status === 'published').length
                          }
                        </p>
                        <p className="text-sm text-muted-foreground">Published {contentType === 'articles' ? 'Articles' : 'Guides'}</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-green-500/10 rounded-lg">
                        <PencilIcon className="h-6 w-6 text-green-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {contentType === 'articles'
                            ? articles.filter(a => a.status === 'draft').length
                            : guides.filter(g => g.status === 'draft').length
                          }
                        </p>
                        <p className="text-sm text-muted-foreground">Draft {contentType === 'articles' ? 'Articles' : 'Guides'}</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-purple-500/10 rounded-lg">
                        <EyeIcon className="h-6 w-6 text-purple-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {contentType === 'articles'
                            ? articles.reduce((sum, a) => sum + (a.views || 0), 0)
                            : guides.reduce((sum, g) => sum + (g.reads || 0), 0)
                          }
                        </p>
                        <p className="text-sm text-muted-foreground">Total {contentType === 'articles' ? 'Views' : 'Reads'}</p>
                      </div>
                    </div>
                  </div>
                  <div className="bg-card border border-border rounded-xl p-6">
                    <div className="flex items-center gap-4">
                      <div className="p-3 bg-orange-500/10 rounded-lg">
                        <ClockIcon className="h-6 w-6 text-orange-500" />
                      </div>
                      <div>
                        <p className="text-2xl font-bold text-foreground">
                          {contentType === 'articles'
                            ? articles.filter(a => {
                                const today = new Date().toDateString()
                                const publishedDate = a.publishedAt ? new Date(a.publishedAt).toDateString() : null
                                return publishedDate === today
                              }).length
                            : guides.filter(g => {
                                const today = new Date().toDateString()
                                const publishedDate = g.publishedAt ? new Date(g.publishedAt).toDateString() : null
                                return publishedDate === today
                              }).length
                          }
                        </p>
                        <p className="text-sm text-muted-foreground">Published Today</p>
                      </div>
                    </div>
                  </div>
                </div>

                {/* Filters and Search */}
                <div className="bg-card border border-border rounded-xl p-6">
                  <div className="flex flex-col lg:flex-row gap-4 items-start lg:items-center justify-between">
                    <div className="flex flex-col sm:flex-row gap-4 items-start sm:items-center">
                      <input
                        type="text"
                        placeholder={`Search ${contentType}...`}
                        value={contentSearchTerm}
                        onChange={(e) => setContentSearchTerm(e.target.value)}
                        className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 min-w-[250px]"
                      />
                      <select
                        value={contentStatusFilter}
                        onChange={(e) => setContentStatusFilter(e.target.value)}
                        className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                      >
                        <option value="all">All Status</option>
                        <option value="published">Published</option>
                        <option value="draft">Draft</option>
                      </select>
                      <select
                        value={contentCategoryFilter}
                        onChange={(e) => setContentCategoryFilter(e.target.value)}
                        className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                      >
                        <option value="all">All Categories</option>
                        {contentType === 'articles' ? (
                          <>
                            <option value="Market Updates">Market Updates</option>
                            <option value="Investment Guides">Investment Guides</option>
                            <option value="Property News">Property News</option>
                            <option value="Market Analysis">Market Analysis</option>
                          </>
                        ) : (
                          <>
                            <option value="Buying">Buying</option>
                            <option value="Selling">Selling</option>
                            <option value="Finance">Finance</option>
                            <option value="Areas">Areas</option>
                            <option value="Legal">Legal</option>
                          </>
                        )}
                      </select>
                    </div>
                    <div className="flex items-center gap-2">
                      <select
                        value={contentSortBy}
                        onChange={(e) => setContentSortBy(e.target.value)}
                        className="px-4 py-2 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                      >
                        <option value="updatedAt">Sort by Date</option>
                        <option value="title">Sort by Title</option>
                        <option value="status">Sort by Status</option>
                        <option value="category">Sort by Category</option>
                        {contentType === 'articles' ? (
                          <option value="views">Sort by Views</option>
                        ) : (
                          <option value="reads">Sort by Reads</option>
                        )}
                      </select>
                      <button
                        onClick={() => setContentSortOrder(contentSortOrder === 'asc' ? 'desc' : 'asc')}
                        className="px-4 py-2 bg-muted border border-border rounded-lg hover:bg-muted/80 transition-colors"
                      >
                        {contentSortOrder === 'asc' ? '' : ''}
                      </button>
                      {selectedContent.length > 0 && (
                        <button
                          onClick={handleBulkDeleteContent}
                          className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
                        >
                          Delete Selected ({selectedContent.length})
                        </button>
                      )}
                    </div>
                  </div>
                </div>

                {/* Content Table */}
                <div className="bg-card border border-border rounded-xl overflow-hidden">
                  <div className="overflow-x-auto">
                    <table className="w-full">
                      <thead className="bg-muted/30">
                        <tr>
                          <th className="px-6 py-4 text-left">
                            <input
                              type="checkbox"
                              checked={selectedContent.length === paginatedContent.length && paginatedContent.length > 0}
                              onChange={(e) => {
                                if (e.target.checked) {
                                  setSelectedContent(paginatedContent.map(item => item.id))
                                } else {
                                  setSelectedContent([])
                                }
                              }}
                              className="rounded border-border"
                            />
                          </th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Content</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Category</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Status</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">
                            {contentType === 'articles' ? 'Views' : 'Reads'}
                          </th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Updated</th>
                          <th className="px-6 py-4 text-left text-sm font-semibold text-foreground">Actions</th>
                        </tr>
                      </thead>
                      <tbody className="divide-y divide-border">
                        {paginatedContent.map((item) => (
                          <tr key={item.id} className="hover:bg-muted/30">
                            <td className="px-6 py-4">
                              <input
                                type="checkbox"
                                checked={selectedContent.includes(item.id)}
                                onChange={(e) => {
                                  if (e.target.checked) {
                                    setSelectedContent(prev => [...prev, item.id])
                                  } else {
                                    setSelectedContent(prev => prev.filter(id => id !== item.id))
                                  }
                                }}
                                className="rounded border-border"
                              />
                            </td>
                            <td className="px-6 py-4">
                              <div className="flex items-center gap-3">
                                {item.featuredImage && (
                                  <img
                                    src={item.featuredImage}
                                    alt={item.title}
                                    className="w-12 h-12 rounded-lg object-cover"
                                  />
                                )}
                                <div>
                                  <p className="font-semibold text-foreground line-clamp-1">{item.title}</p>
                                  <p className="text-sm text-muted-foreground line-clamp-1">{item.excerpt}</p>
                                </div>
                              </div>
                            </td>
                            <td className="px-6 py-4">
                              <span className="px-2 py-1 bg-primary/10 text-primary text-xs rounded">
                                {item.category}
                              </span>
                            </td>
                            <td className="px-6 py-4">
                              <span className={`px-2 py-1 rounded-full text-xs ${
                                item.status === 'published' ? 'bg-green-500/10 text-green-500' : 'bg-yellow-500/10 text-yellow-500'
                              }`}>
                                {item.status === 'published' ? 'Published' : 'Draft'}
                              </span>
                            </td>
                            <td className="px-6 py-4 text-sm text-muted-foreground">
                              {contentType === 'articles' ? item.views : item.reads}
                            </td>
                            <td className="px-6 py-4 text-sm text-muted-foreground">
                              {new Date(item.updatedAt).toLocaleDateString()}
                            </td>
                            <td className="px-6 py-4">
                              <div className="flex items-center gap-2">
                                <button
                                  onClick={() => {
                                    setSelectedContentDetails(item)
                                    setShowContentDetails(true)
                                  }}
                                  className="p-2 hover:bg-muted rounded-lg transition-colors"
                                  title="View Details"
                                >
                                  <EyeIcon className="h-4 w-4 text-muted-foreground" />
                                </button>
                                <button
                                  onClick={() => {
                                    setEditingContent(item)
                                    setShowEditContent(true)
                                  }}
                                  className="p-2 hover:bg-muted rounded-lg transition-colors"
                                  title="Edit"
                                >
                                  <PencilIcon className="h-4 w-4 text-muted-foreground" />
                                </button>
                                {item.status === 'draft' ? (
                                  <button
                                    onClick={() => handlePublishContent(item.id)}
                                    className="p-2 hover:bg-green-500/10 rounded-lg transition-colors"
                                    title="Publish"
                                  >
                                    <EyeIcon className="h-4 w-4 text-green-500" />
                                  </button>
                                ) : (
                                  <button
                                    onClick={() => handleUnpublishContent(item.id)}
                                    className="p-2 hover:bg-yellow-500/10 rounded-lg transition-colors"
                                    title="Unpublish"
                                  >
                                    <EyeIcon className="h-4 w-4 text-yellow-500" />
                                  </button>
                                )}
                                <button
                                  onClick={() => handleDeleteContent(item.id)}
                                  className="p-2 hover:bg-red-500/10 rounded-lg transition-colors"
                                  title="Delete"
                                >
                                  <TrashIcon className="h-4 w-4 text-red-500" />
                                </button>
                              </div>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>

                  {/* Pagination */}
                  {contentTotalPages > 1 && (
                    <div className="px-6 py-4 border-t border-border flex items-center justify-between">
                      <div className="text-sm text-muted-foreground">
                        Showing {(contentCurrentPage - 1) * contentItemsPerPage + 1} to {Math.min(contentCurrentPage * contentItemsPerPage, filteredContent.length)} of {filteredContent.length} {contentType}
                      </div>
                      <div className="flex items-center gap-2">
                        <select
                          value={contentItemsPerPage}
                          onChange={(e) => {
                            setContentItemsPerPage(Number(e.target.value))
                            setContentCurrentPage(1)
                          }}
                          className="px-2 py-1 border border-border rounded text-sm focus:outline-none focus:ring-1 focus:ring-primary/50"
                        >
                          <option value={10}>10 per page</option>
                          <option value={25}>25 per page</option>
                          <option value={50}>50 per page</option>
                        </select>
                        <button
                          onClick={() => setContentCurrentPage(prev => Math.max(1, prev - 1))}
                          disabled={contentCurrentPage === 1}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Previous
                        </button>
                        <span className="px-3 py-1 text-sm">
                          Page {contentCurrentPage} of {contentTotalPages}
                        </span>
                        <button
                          onClick={() => setContentCurrentPage(prev => Math.min(contentTotalPages, prev + 1))}
                          disabled={contentCurrentPage === contentTotalPages}
                          className="px-3 py-1 border border-border rounded hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                          Next
                        </button>
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}

            {activeTab === 'reports' && (
              <Reports />
            )}

            {activeTab === 'settings' && (
              <Settings />
            )}

            {activeTab === 'seo' && (
              <SEO />
            )}

            {activeTab === 'system' && (
              <System />
            )}

        </main>
      </div>

      {/* Property Form Modal */}
          <PropertyForm
            isOpen={showAddProperty}
            onClose={handleCloseForm}
            onSubmit={handlePropertySubmit}
            initialData={editingProperty}
            mode={editingProperty ? 'edit' : 'create'}
          />

          {/* Property Details Modal */}
          {showPropertyDetails && selectedPropertyDetails && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">Property Details</h2>
                    <button
                      onClick={() => setShowPropertyDetails(false)}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  {/* Property Images */}
                  {selectedPropertyDetails.images && selectedPropertyDetails.images.length > 0 && (
                    <div>
                      <h3 className="text-lg font-semibold text-foreground mb-4">Images</h3>
                      <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        {selectedPropertyDetails.images.map((image: string, index: number) => (
                          <div key={index} className="relative group">
                            <img
                              src={image}
                              alt={`Property image ${index + 1}`}
                              className="w-full h-32 object-cover rounded-lg border border-border"
                            />
                            {index === 0 && (
                              <div className="absolute top-2 left-2 px-2 py-1 bg-primary text-primary-foreground text-xs rounded">
                                Main
                              </div>
                            )}
                          </div>
                        ))}
                      </div>
                    </div>
                  )}

                  {/* Property Information */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div>
                        <h3 className="text-lg font-semibold text-foreground mb-2">Basic Information</h3>
                        <div className="space-y-2">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Title:</span>
                            <span className="font-medium">{selectedPropertyDetails.title}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">ID:</span>
                            <span className="font-medium">{selectedPropertyDetails.id}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Category:</span>
                            <span className="font-medium">{getCategoryName(selectedPropertyDetails.category)}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Type:</span>
                            <span className="font-medium capitalize">{selectedPropertyDetails.type}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Status:</span>
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                              selectedPropertyDetails.status === 'active'
                                ? 'bg-green-100 text-green-800'
                                : selectedPropertyDetails.status === 'pending'
                                ? 'bg-yellow-100 text-yellow-800'
                                : 'bg-gray-100 text-gray-800'
                            }`}>
                              {selectedPropertyDetails.status}
                            </span>
                          </div>
                          {selectedPropertyDetails.featured && (
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Featured:</span>
                              <span className="font-medium text-yellow-500">Yes</span>
                            </div>
                          )}
                        </div>
                      </div>

                      <div>
                        <h3 className="text-lg font-semibold text-foreground mb-2">Pricing</h3>
                        <div className="space-y-2">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Price:</span>
                            <span className="font-medium text-primary">
                              {selectedPropertyDetails.currency} {selectedPropertyDetails.price.toLocaleString()}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div className="space-y-4">
                      <div>
                        <h3 className="text-lg font-semibold text-foreground mb-2">Property Details</h3>
                        <div className="space-y-2">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Location:</span>
                            <span className="font-medium">{selectedPropertyDetails.location}</span>
                          </div>
                          {selectedPropertyDetails.beds > 0 && (
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Bedrooms:</span>
                              <span className="font-medium">{selectedPropertyDetails.beds}</span>
                            </div>
                          )}
                          {selectedPropertyDetails.baths > 0 && (
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Bathrooms:</span>
                              <span className="font-medium">{selectedPropertyDetails.baths}</span>
                            </div>
                          )}
                          {selectedPropertyDetails.sqft > 0 && (
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Area:</span>
                              <span className="font-medium">{selectedPropertyDetails.sqft} sqft</span>
                            </div>
                          )}
                        </div>
                      </div>

                      <div>
                        <h3 className="text-lg font-semibold text-foreground mb-2">Analytics</h3>
                        <div className="space-y-2">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Views:</span>
                            <span className="font-medium">{selectedPropertyDetails.views}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Inquiries:</span>
                            <span className="font-medium">{selectedPropertyDetails.inquiries}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Created:</span>
                            <span className="font-medium">{selectedPropertyDetails.createdAt}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Updated:</span>
                            <span className="font-medium">{selectedPropertyDetails.updatedAt}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Description */}
                  {selectedPropertyDetails.description && (
                    <div>
                      <h3 className="text-lg font-semibold text-foreground mb-2">Description</h3>
                      <p className="text-muted-foreground leading-relaxed">{selectedPropertyDetails.description}</p>
                    </div>
                  )}

                  {/* Actions */}
                  <div className="flex justify-end gap-3 pt-6 border-t border-border">
                    <button
                      onClick={() => setShowPropertyDetails(false)}
                      className="px-4 py-2 border border-border rounded-lg hover:bg-muted transition-colors"
                    >
                      Close
                    </button>
                    <button
                      onClick={() => {
                        handleEditProperty(selectedPropertyDetails)
                        setShowPropertyDetails(false)
                      }}
                      className="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      Edit Property
                    </button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Category Form Modal */}
          <CategoryForm
            isOpen={showAddCategory}
            onClose={handleCloseCategoryForm}
            onSubmit={handleCategorySubmit}
            initialData={editingCategory}
            mode={editingCategory ? 'edit' : 'create'}
          />

          {/* Category Details Modal */}
          {showCategoryDetails && selectedCategoryDetails && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">Category Details</h2>
                    <button
                      onClick={() => setShowCategoryDetails(false)}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  {/* Category Header */}
                  <div className="flex items-center gap-4">
                    <div className={`p-3 rounded-xl ${
                      selectedCategoryDetails.isActive !== false ? 'bg-primary/10' : 'bg-muted'
                    }`}>
                      {(() => {
                        const iconMap: { [key: string]: any } = {
                          BuildingOfficeIcon,
                          HomeModernIcon,
                          HomeIcon,
                          MapIcon,
                          BuildingStorefrontIcon,
                          SparklesIcon,
                          CubeIcon,
                          WrenchScrewdriverIcon,
                          TruckIcon,
                          ShoppingBagIcon,
                        }
                        const IconComponent = iconMap[selectedCategoryDetails.icon] || BuildingOfficeIcon
                        return <IconComponent className={`h-8 w-8 ${
                          selectedCategoryDetails.isActive !== false ? 'text-primary' : 'text-muted-foreground'
                        }`} />
                      })()}
                    </div>
                    <div>
                      <h3 className="text-xl font-bold text-foreground">{selectedCategoryDetails.name}</h3>
                      <p className="text-sm text-muted-foreground">ID: {selectedCategoryDetails.id}</p>
                    </div>
                  </div>

                  {/* Category Information */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div>
                        <h4 className="text-sm font-semibold text-foreground mb-2">Basic Information</h4>
                        <div className="space-y-2">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Name:</span>
                            <span className="font-medium">{selectedCategoryDetails.name}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">ID:</span>
                            <span className="font-medium">{selectedCategoryDetails.id}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Status:</span>
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                              selectedCategoryDetails.isActive !== false
                                ? 'bg-green-100 text-green-800'
                                : 'bg-red-100 text-red-800'
                            }`}>
                              {selectedCategoryDetails.isActive !== false ? 'Active' : 'Inactive'}
                            </span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Order:</span>
                            <span className="font-medium">{selectedCategoryDetails.order || 0}</span>
                          </div>
                        </div>
                      </div>

                      <div>
                        <h4 className="text-sm font-semibold text-foreground mb-2">Statistics</h4>
                        <div className="space-y-2">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Properties:</span>
                            <span className="font-medium text-primary">{selectedCategoryDetails.count}</span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div className="space-y-4">
                      <div>
                        <h4 className="text-sm font-semibold text-foreground mb-2">Appearance</h4>
                        <div className="space-y-2">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Icon:</span>
                            <span className="font-medium">{selectedCategoryDetails.icon}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Color:</span>
                            <span className="font-medium capitalize">{selectedCategoryDetails.color || 'blue'}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* Description */}
                  {selectedCategoryDetails.description && (
                    <div>
                      <h4 className="text-sm font-semibold text-foreground mb-2">Description</h4>
                      <p className="text-muted-foreground leading-relaxed">{selectedCategoryDetails.description}</p>
                    </div>
                  )}

                  {/* Actions */}
                  <div className="flex justify-end gap-3 pt-6 border-t border-border">
                    <button
                      onClick={() => setShowCategoryDetails(false)}
                      className="px-4 py-2 border border-border rounded-lg hover:bg-muted transition-colors"
                    >
                      Close
                    </button>
                    <button
                      onClick={() => {
                        handleEditCategory(selectedCategoryDetails)
                        setShowCategoryDetails(false)
                      }}
                      className="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      Edit Category
                    </button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Agent Form Modal */}
          <AgentForm
            isOpen={showAddAgent}
            onClose={handleCloseAgentForm}
            onSubmit={handleAgentSubmit}
            initialData={editingAgent}
            mode={editingAgent ? 'edit' : 'create'}
          />

          {/* User Form Modal */}
          <UserForm
            isOpen={showAddUser}
            onClose={handleCloseUserForm}
            onSubmit={handleUserSubmit}
            initialData={editingUser}
            mode={editingUser ? 'edit' : 'create'}
          />

          {/* Agent Details Modal */}
          {showAgentDetails && selectedAgentDetails && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">Agent Details</h2>
                    <button
                      onClick={() => setShowAgentDetails(false)}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  {/* Agent Header */}
                  <div className="flex items-center gap-6">
                    <div className="w-20 h-20 rounded-xl overflow-hidden border border-border flex-shrink-0">
                      {selectedAgentDetails.logo ? (
                        <img src={selectedAgentDetails.logo} alt={selectedAgentDetails.name} className="w-full h-full object-cover" />
                      ) : (
                        <div className="w-full h-full bg-muted flex items-center justify-center">
                          <BuildingOfficeIcon className="h-10 w-10 text-muted-foreground" />
                        </div>
                      )}
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center gap-3 mb-2">
                        <h3 className="text-2xl font-bold text-foreground">{selectedAgentDetails.name}</h3>
                        {selectedAgentDetails.verified && (
                          <span className="px-3 py-1 bg-green-500/10 text-green-600 text-sm rounded-full">
                             Verified
                          </span>
                        )}
                        {!selectedAgentDetails.isActive && (
                          <span className="px-3 py-1 bg-red-500/10 text-red-500 text-sm rounded-full">
                            Inactive
                          </span>
                        )}
                      </div>
                      <p className="text-muted-foreground mb-2">{selectedAgentDetails.location}</p>
                      <div className="flex items-center gap-4 text-sm text-muted-foreground">
                        <span> {selectedAgentDetails.rating.toFixed(1)} rating</span>
                        <span> {selectedAgentDetails.totalProperties} properties</span>
                        <span> AED {selectedAgentDetails.totalSales.toLocaleString()} sales</span>
                      </div>
                    </div>
                  </div>

                  {/* Agent Information */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div>
                        <h4 className="text-lg font-semibold text-foreground mb-3">Contact Information</h4>
                        <div className="space-y-3">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Email:</span>
                            <span className="font-medium">{selectedAgentDetails.email}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Phone:</span>
                            <span className="font-medium">{selectedAgentDetails.phone}</span>
                          </div>
                          {selectedAgentDetails.website && (
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Website:</span>
                              <a href={selectedAgentDetails.website} target="_blank" rel="noopener noreferrer" className="font-medium text-primary hover:underline">
                                {selectedAgentDetails.website}
                              </a>
                            </div>
                          )}
                        </div>
                      </div>

                      <div>
                        <h4 className="text-lg font-semibold text-foreground mb-3">Business Details</h4>
                        <div className="space-y-3">
                          {selectedAgentDetails.established && (
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Established:</span>
                              <span className="font-medium">{selectedAgentDetails.established}</span>
                            </div>
                          )}
                          {selectedAgentDetails.licenseNumber && (
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">License:</span>
                              <span className="font-medium">{selectedAgentDetails.licenseNumber}</span>
                            </div>
                          )}
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Status:</span>
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${
                              selectedAgentDetails.isActive
                                ? 'bg-green-100 text-green-800'
                                : 'bg-red-100 text-red-800'
                            }`}>
                              {selectedAgentDetails.isActive ? 'Active' : 'Inactive'}
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div className="space-y-4">
                      <div>
                        <h4 className="text-lg font-semibold text-foreground mb-3">Specialties</h4>
                        {selectedAgentDetails.specialties && selectedAgentDetails.specialties.length > 0 ? (
                          <div className="flex flex-wrap gap-2">
                            {selectedAgentDetails.specialties.map((specialty: string, index: number) => (
                              <span key={index} className="px-3 py-1 bg-primary/10 text-primary text-sm rounded-full">
                                {specialty}
                              </span>
                            ))}
                          </div>
                        ) : (
                          <p className="text-muted-foreground">No specialties specified</p>
                        )}
                      </div>

                      <div>
                        <h4 className="text-lg font-semibold text-foreground mb-3">Social Media</h4>
                        {selectedAgentDetails.socialMedia && Object.keys(selectedAgentDetails.socialMedia).length > 0 ? (
                          <div className="space-y-2">
                            {selectedAgentDetails.socialMedia.facebook && (
                              <a href={selectedAgentDetails.socialMedia.facebook} target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                                <span></span> Facebook
                              </a>
                            )}
                            {selectedAgentDetails.socialMedia.instagram && (
                              <a href={selectedAgentDetails.socialMedia.instagram} target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                                <span></span> Instagram
                              </a>
                            )}
                            {selectedAgentDetails.socialMedia.linkedin && (
                              <a href={selectedAgentDetails.socialMedia.linkedin} target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                                <span></span> LinkedIn
                              </a>
                            )}
                            {selectedAgentDetails.socialMedia.twitter && (
                              <a href={selectedAgentDetails.socialMedia.twitter} target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                                <span></span> Twitter
                              </a>
                            )}
                          </div>
                        ) : (
                          <p className="text-muted-foreground">No social media links</p>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* Description */}
                  {selectedAgentDetails.description && (
                    <div>
                      <h4 className="text-lg font-semibold text-foreground mb-3">About</h4>
                      <p className="text-muted-foreground leading-relaxed">{selectedAgentDetails.description}</p>
                    </div>
                  )}

                  {/* Actions */}
                  <div className="flex justify-end gap-3 pt-6 border-t border-border">
                    <button
                      onClick={() => setShowAgentDetails(false)}
                      className="px-4 py-2 border border-border rounded-lg hover:bg-muted transition-colors"
                    >
                      Close
                    </button>
                    <button
                      onClick={() => {
                        handleEditAgent(selectedAgentDetails)
                        setShowAgentDetails(false)
                      }}
                      className="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      Edit Agent
                    </button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* User Details Modal */}
          {showUserDetails && selectedUserDetails && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">User Details</h2>
                    <button
                      onClick={() => setShowUserDetails(false)}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  {/* User Header */}
                  <div className="flex items-center gap-6">
                    <div className="w-20 h-20 rounded-xl overflow-hidden flex-shrink-0">
                      {selectedUserDetails.avatar ? (
                        <img src={selectedUserDetails.avatar} alt={selectedUserDetails.name} className="w-full h-full object-cover" />
                      ) : (
                        <div className="w-full h-full bg-primary/10 flex items-center justify-center">
                          <span className="text-2xl font-semibold text-primary">
                            {selectedUserDetails.name.split(' ').map((n: string) => n[0]).join('')}
                          </span>
                        </div>
                      )}
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center gap-3 mb-2">
                        <h3 className="text-2xl font-bold text-foreground">{selectedUserDetails.name}</h3>
                        {selectedUserDetails.verified && (
                          <span className="px-3 py-1 bg-blue-500/10 text-blue-600 text-sm rounded-full">
                             Verified
                          </span>
                        )}
                        <span className={`px-3 py-1 rounded-full text-sm ${
                          selectedUserDetails.status === 'active' ? 'bg-green-500/10 text-green-600' :
                          selectedUserDetails.status === 'inactive' ? 'bg-red-500/10 text-red-600' :
                          selectedUserDetails.status === 'pending' ? 'bg-yellow-500/10 text-yellow-600' :
                          'bg-orange-500/10 text-orange-600'
                        }`}>
                          {selectedUserDetails.status.charAt(0).toUpperCase() + selectedUserDetails.status.slice(1)}
                        </span>
                      </div>
                      <p className="text-muted-foreground mb-2">{selectedUserDetails.location}</p>
                      <div className="flex items-center gap-4 text-sm text-muted-foreground">
                        <span> {selectedUserDetails.email}</span>
                        <span> {selectedUserDetails.phone}</span>
                        <span> {selectedUserDetails.role.charAt(0).toUpperCase() + selectedUserDetails.role.slice(1)}</span>
                        <span> Joined {selectedUserDetails.joinDate}</span>
                        {selectedUserDetails.lastLogin && (
                          <span> Last login {selectedUserDetails.lastLogin}</span>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* User Stats */}
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div className="bg-card border border-border rounded-xl p-6">
                      <div className="flex items-center gap-4">
                        <div className="p-3 bg-blue-500/10 rounded-lg">
                          <EyeIcon className="h-6 w-6 text-blue-500" />
                        </div>
                        <div>
                          <p className="text-2xl font-bold text-foreground">{selectedUserDetails.totalInquiries}</p>
                          <p className="text-sm text-muted-foreground">Total Inquiries</p>
                        </div>
                      </div>
                    </div>
                    <div className="bg-card border border-border rounded-xl p-6">
                      <div className="flex items-center gap-4">
                        <div className="p-3 bg-green-500/10 rounded-lg">
                          <EyeIcon className="h-6 w-6 text-green-500" />
                        </div>
                        <div>
                          <p className="text-2xl font-bold text-foreground">{selectedUserDetails.totalFavorites}</p>
                          <p className="text-sm text-muted-foreground">Saved Properties</p>
                        </div>
                      </div>
                    </div>
                    <div className="bg-card border border-border rounded-xl p-6">
                      <div className="flex items-center gap-4">
                        <div className="p-3 bg-orange-500/10 rounded-lg">
                          <EyeIcon className="h-6 w-6 text-orange-500" />
                        </div>
                        <div>
                          <p className="text-2xl font-bold text-foreground">
                            {Math.floor((new Date().getTime() - new Date(selectedUserDetails.joinDate).getTime()) / (1000 * 60 * 60 * 24))}
                          </p>
                          <p className="text-sm text-muted-foreground">Days Active</p>
                        </div>
                      </div>
                    </div>
                  </div>

                  {/* User Information */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <h4 className="text-lg font-semibold text-foreground">Basic Information</h4>
                      <div className="space-y-3">
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Full Name:</span>
                          <span className="font-medium">{selectedUserDetails.name}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Email:</span>
                          <span className="font-medium">{selectedUserDetails.email}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Phone:</span>
                          <span className="font-medium">{selectedUserDetails.phone}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Location:</span>
                          <span className="font-medium">{selectedUserDetails.location}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Role:</span>
                          <span className="font-medium capitalize">{selectedUserDetails.role}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Status:</span>
                          <span className={`font-medium capitalize ${
                            selectedUserDetails.status === 'active' ? 'text-green-600' :
                            selectedUserDetails.status === 'inactive' ? 'text-red-600' :
                            selectedUserDetails.status === 'pending' ? 'text-yellow-600' :
                            'text-orange-600'
                          }`}>
                            {selectedUserDetails.status}
                          </span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Verified:</span>
                          <span className={`font-medium ${selectedUserDetails.verified ? 'text-green-600' : 'text-red-600'}`}>
                            {selectedUserDetails.verified ? 'Yes' : 'No'}
                          </span>
                        </div>
                      </div>
                    </div>

                    {/* Agent Information or Customer Preferences */}
                    {selectedUserDetails.role === 'agent' ? (
                      <div className="space-y-4">
                        <h4 className="text-lg font-semibold text-foreground">Agent Information</h4>
                        <div className="space-y-3">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Agency:</span>
                            <span className="font-medium">{selectedUserDetails.agency || 'Not specified'}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">License:</span>
                            <span className="font-medium">{selectedUserDetails.licenseNumber || 'Not specified'}</span>
                          </div>
                          {selectedUserDetails.specialties && selectedUserDetails.specialties.length > 0 && (
                            <div>
                              <span className="text-muted-foreground block mb-2">Specialties:</span>
                              <div className="flex flex-wrap gap-2">
                                {selectedUserDetails.specialties.map((specialty: string, index: number) => (
                                  <span key={index} className="px-2 py-1 bg-primary/10 text-primary text-sm rounded">
                                    {specialty}
                                  </span>
                                ))}
                              </div>
                            </div>
                          )}
                        </div>
                      </div>
                    ) : (
                      <div className="space-y-4">
                        <h4 className="text-lg font-semibold text-foreground">Property Preferences</h4>
                        {selectedUserDetails.preferences ? (
                          <div className="space-y-3">
                            {selectedUserDetails.preferences.propertyTypes && selectedUserDetails.preferences.propertyTypes.length > 0 && (
                              <div>
                                <span className="text-muted-foreground block mb-2">Property Types:</span>
                                <div className="flex flex-wrap gap-2">
                                  {selectedUserDetails.preferences.propertyTypes.map((type: string, index: number) => (
                                    <span key={index} className="px-2 py-1 bg-primary/10 text-primary text-sm rounded">
                                      {type}
                                    </span>
                                  ))}
                                </div>
                              </div>
                            )}
                            {selectedUserDetails.preferences.priceRange && (
                              <div className="flex justify-between">
                                <span className="text-muted-foreground">Price Range:</span>
                                <span className="font-medium">
                                  AED {selectedUserDetails.preferences.priceRange.min.toLocaleString()} - {selectedUserDetails.preferences.priceRange.max.toLocaleString()}
                                </span>
                              </div>
                            )}
                            {selectedUserDetails.preferences.locations && selectedUserDetails.preferences.locations.length > 0 && (
                              <div>
                                <span className="text-muted-foreground block mb-2">Preferred Locations:</span>
                                <div className="flex flex-wrap gap-2">
                                  {selectedUserDetails.preferences.locations.map((location: string, index: number) => (
                                    <span key={index} className="px-2 py-1 bg-muted text-foreground text-sm rounded">
                                      {location}
                                    </span>
                                  ))}
                                </div>
                              </div>
                            )}
                          </div>
                        ) : (
                          <p className="text-muted-foreground">No preferences specified</p>
                        )}
                      </div>
                    )}
                  </div>

                  {/* Activity Timeline */}
                  <div className="space-y-4">
                    <h4 className="text-lg font-semibold text-foreground">Recent Activity</h4>
                    <div className="space-y-3">
                      <div className="flex items-center gap-3 p-3 bg-muted/30 rounded-lg">
                        <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                        <div className="flex-1">
                          <p className="text-sm font-medium text-foreground">Account created</p>
                          <p className="text-xs text-muted-foreground">{selectedUserDetails.createdAt}</p>
                        </div>
                      </div>
                      {selectedUserDetails.lastLogin && (
                        <div className="flex items-center gap-3 p-3 bg-muted/30 rounded-lg">
                          <div className="w-2 h-2 bg-blue-500 rounded-full"></div>
                          <div className="flex-1">
                            <p className="text-sm font-medium text-foreground">Last login</p>
                            <p className="text-xs text-muted-foreground">{selectedUserDetails.lastLogin}</p>
                          </div>
                        </div>
                      )}
                      {selectedUserDetails.totalInquiries > 0 && (
                        <div className="flex items-center gap-3 p-3 bg-muted/30 rounded-lg">
                          <div className="w-2 h-2 bg-orange-500 rounded-full"></div>
                          <div className="flex-1">
                            <p className="text-sm font-medium text-foreground">{selectedUserDetails.totalInquiries} property inquiries made</p>
                            <p className="text-xs text-muted-foreground">Activity summary</p>
                          </div>
                        </div>
                      )}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Form Details Modal */}
          {showFormDetails && selectedFormDetails && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">Form Submission Details</h2>
                    <button
                      onClick={() => setShowFormDetails(false)}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  {/* Form Header */}
                  <div className="flex items-center gap-6">
                    <div className={`p-4 rounded-xl ${
                      selectedFormDetails.formType === 'contact' ? 'bg-blue-500/10' :
                      selectedFormDetails.formType === 'career' ? 'bg-green-500/10' :
                      selectedFormDetails.formType === 'property_inquiry' ? 'bg-purple-500/10' :
                      'bg-orange-500/10'
                    }`}>
                      {selectedFormDetails.formType === 'contact' && <ChatBubbleLeftRightIcon className="h-8 w-8 text-blue-500" />}
                      {selectedFormDetails.formType === 'career' && <BriefcaseIcon className="h-8 w-8 text-green-500" />}
                      {selectedFormDetails.formType === 'property_inquiry' && <HomeIcon className="h-8 w-8 text-purple-500" />}
                      {selectedFormDetails.formType === 'valuation' && <CurrencyDollarIcon className="h-8 w-8 text-orange-500" />}
                    </div>
                    <div className="flex-1">
                      <div className="flex items-center gap-3 mb-2">
                        <h3 className="text-2xl font-bold text-foreground">{selectedFormDetails.name}</h3>
                        <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                          selectedFormDetails.formType === 'contact' ? 'bg-blue-500/10 text-blue-500' :
                          selectedFormDetails.formType === 'career' ? 'bg-green-500/10 text-green-500' :
                          selectedFormDetails.formType === 'property_inquiry' ? 'bg-purple-500/10 text-purple-500' :
                          'bg-orange-500/10 text-orange-500'
                        }`}>
                          {selectedFormDetails.formType.replace('_', ' ').replace(/\b\w/g, function(l: string) { return l.toUpperCase(); })}
                        </span>
                        <span className={`px-3 py-1 rounded-full text-sm ${
                          selectedFormDetails.status === 'unread' ? 'bg-red-500/10 text-red-500' :
                          selectedFormDetails.status === 'read' ? 'bg-gray-500/10 text-gray-500' :
                          'bg-blue-500/10 text-blue-500'
                        }`}>
                          {selectedFormDetails.status}
                        </span>
                        <span className={`px-3 py-1 rounded-full text-sm ${
                          selectedFormDetails.priority === 'high' ? 'bg-red-500/10 text-red-500' :
                          selectedFormDetails.priority === 'normal' ? 'bg-yellow-500/10 text-yellow-500' :
                          'bg-gray-500/10 text-gray-500'
                        }`}>
                          {selectedFormDetails.priority} priority
                        </span>
                      </div>
                      <p className="text-muted-foreground mb-2">{selectedFormDetails.email}  {selectedFormDetails.phone}</p>
                      <div className="flex items-center gap-4 text-sm text-muted-foreground">
                        <span> Submitted {new Date(selectedFormDetails.date).toLocaleDateString()}</span>
                        {selectedFormDetails.readAt && (
                          <span> Read {new Date(selectedFormDetails.readAt).toLocaleDateString()}</span>
                        )}
                        {selectedFormDetails.respondedAt && (
                          <span> Responded {new Date(selectedFormDetails.respondedAt).toLocaleDateString()}</span>
                        )}
                      </div>
                    </div>
                  </div>

                  {/* Form Information */}
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div>
                        <h4 className="text-lg font-semibold text-foreground mb-3">Contact Information</h4>
                        <div className="space-y-3">
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Name:</span>
                            <span className="font-medium">{selectedFormDetails.name}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Email:</span>
                            <span className="font-medium">{selectedFormDetails.email}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Phone:</span>
                            <span className="font-medium">{selectedFormDetails.phone}</span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Form Type:</span>
                            <span className="font-medium capitalize">
                              {selectedFormDetails.formType.replace('_', ' ')}
                            </span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Status:</span>
                            <span className={`font-medium capitalize ${
                              selectedFormDetails.status === 'unread' ? 'text-red-600' :
                              selectedFormDetails.status === 'read' ? 'text-gray-600' :
                              'text-blue-600'
                            }`}>
                              {selectedFormDetails.status}
                            </span>
                          </div>
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Priority:</span>
                            <span className={`font-medium capitalize ${
                              selectedFormDetails.priority === 'high' ? 'text-red-600' :
                              selectedFormDetails.priority === 'normal' ? 'text-yellow-600' :
                              'text-gray-600'
                            }`}>
                              {selectedFormDetails.priority}
                            </span>
                          </div>
                        </div>
                      </div>

                      {/* Form-specific fields */}
                      {selectedFormDetails.formType === 'property_inquiry' && selectedFormDetails.propertyDetails && (
                        <div>
                          <h4 className="text-lg font-semibold text-foreground mb-3">Property Details</h4>
                          <div className="space-y-3">
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Property ID:</span>
                              <span className="font-medium">{selectedFormDetails.propertyDetails.id}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Property Title:</span>
                              <span className="font-medium">{selectedFormDetails.propertyDetails.title}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Location:</span>
                              <span className="font-medium">{selectedFormDetails.propertyDetails.location}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Price:</span>
                              <span className="font-medium">
                                {selectedFormDetails.propertyDetails.currency} {selectedFormDetails.propertyDetails.price.toLocaleString()}
                              </span>
                            </div>
                          </div>
                        </div>
                      )}

                      {selectedFormDetails.formType === 'valuation' && selectedFormDetails.valuationDetails && (
                        <div>
                          <h4 className="text-lg font-semibold text-foreground mb-3">Valuation Request</h4>
                          <div className="space-y-3">
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Property Type:</span>
                              <span className="font-medium">{selectedFormDetails.valuationDetails.propertyType}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Location:</span>
                              <span className="font-medium">{selectedFormDetails.valuationDetails.location}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Estimated Value:</span>
                              <span className="font-medium">
                                AED {selectedFormDetails.valuationDetails.estimatedValue?.toLocaleString() || 'Not specified'}
                              </span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Urgency:</span>
                              <span className="font-medium">{selectedFormDetails.valuationDetails.urgency}</span>
                            </div>
                          </div>
                        </div>
                      )}

                      {selectedFormDetails.formType === 'career' && selectedFormDetails.careerDetails && (
                        <div>
                          <h4 className="text-lg font-semibold text-foreground mb-3">Career Application</h4>
                          <div className="space-y-3">
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Position:</span>
                              <span className="font-medium">{selectedFormDetails.careerDetails.position}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Experience:</span>
                              <span className="font-medium">{selectedFormDetails.careerDetails.experience} years</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Availability:</span>
                              <span className="font-medium">{selectedFormDetails.careerDetails.availability}</span>
                            </div>
                            <div className="flex justify-between">
                              <span className="text-muted-foreground">Salary Expectation:</span>
                              <span className="font-medium">
                                AED {selectedFormDetails.careerDetails.salaryExpectation?.toLocaleString() || 'Not specified'}
                              </span>
                            </div>
                          </div>
                        </div>
                      )}
                    </div>

                    <div className="space-y-4">
                      <div>
                        <h4 className="text-lg font-semibold text-foreground mb-3">Message</h4>
                        <div className="bg-muted/30 p-4 rounded-lg">
                          <p className="text-foreground leading-relaxed whitespace-pre-wrap">{selectedFormDetails.message}</p>
                        </div>
                      </div>

                      {/* Response Section */}
                      {selectedFormDetails.response && (
                        <div>
                          <h4 className="text-lg font-semibold text-foreground mb-3">Response</h4>
                          <div className="bg-green-500/10 border border-green-500/20 p-4 rounded-lg">
                            <p className="text-foreground leading-relaxed whitespace-pre-wrap">{selectedFormDetails.response}</p>
                            <p className="text-xs text-muted-foreground mt-2">
                              Responded on {new Date(selectedFormDetails.respondedAt!).toLocaleDateString()}
                            </p>
                          </div>
                        </div>
                      )}

                      {/* Attachments */}
                      {selectedFormDetails.attachments && selectedFormDetails.attachments.length > 0 && (
                        <div>
                          <h4 className="text-lg font-semibold text-foreground mb-3">Attachments</h4>
                          <div className="space-y-2">
                            {selectedFormDetails.attachments.map((attachment: any, index: number) => (
                              <div key={index} className="flex items-center gap-3 p-3 bg-muted/30 rounded-lg">
                                <PaperClipIcon className="h-5 w-5 text-muted-foreground" />
                                <div className="flex-1">
                                  <p className="text-sm font-medium text-foreground">{attachment.name}</p>
                                  <p className="text-xs text-muted-foreground">{attachment.size}</p>
                                </div>
                                <button className="p-2 hover:bg-background rounded-lg transition-colors">
                                  <ArrowDownTrayIcon className="h-4 w-4 text-muted-foreground" />
                                </button>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Actions */}
                  <div className="flex justify-end gap-3 pt-6 border-t border-border">
                    <button
                      onClick={() => setShowFormDetails(false)}
                      className="px-4 py-2 border border-border rounded-lg hover:bg-muted transition-colors"
                    >
                      Close
                    </button>
                    {!selectedFormDetails.response && (
                      <button
                        onClick={() => {
                          setShowResponseForm(true)
                          setResponseSubmissionId(selectedFormDetails.id)
                        }}
                        className="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                      >
                        Respond
                      </button>
                    )}
                    <button
                      onClick={() => {
                        handleDeleteFormSubmission(selectedFormDetails.id)
                        setShowFormDetails(false)
                      }}
                      className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
                    >
                      Delete
                    </button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Response Form Modal */}
          {showResponseForm && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-2xl w-full">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">Respond to Form Submission</h2>
                    <button
                      onClick={() => setShowResponseForm(false)}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-foreground mb-2">
                      Response Message
                    </label>
                    <textarea
                      value={responseText}
                      onChange={(e) => setResponseText(e.target.value)}
                      rows={6}
                      className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 resize-none"
                      placeholder="Type your response here..."
                    />
                  </div>

                  <div className="flex justify-end gap-3">
                    <button
                      onClick={() => setShowResponseForm(false)}
                      className="px-4 py-2 border border-border rounded-lg hover:bg-muted transition-colors"
                    >
                      Cancel
                    </button>
                    <button
                      onClick={() => {
                        if (responseSubmissionId && responseText.trim()) {
                          handleRespondToForm(responseSubmissionId, responseText.trim())
                          setResponseText('')
                          setShowResponseForm(false)
                        }
                      }}
                      disabled={!responseText.trim()}
                      className="px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      Send Response
                    </button>
                  </div>
                </div>
              </div>
            </div>
          )}

          {/* Content Add/Edit Modal */}
          {(showAddContent || showEditContent) && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">
                      {showAddContent ? `Add New ${contentType === 'articles' ? 'Article' : 'Guide'}` : `Edit ${contentType === 'articles' ? 'Article' : 'Guide'}`}
                    </h2>
                    <button
                      onClick={() => {
                        setShowAddContent(false)
                        setShowEditContent(false)
                        setEditingContent(null)
                      }}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <form onSubmit={(e) => {
                  e.preventDefault()
                  const formData = new FormData(e.target as HTMLFormElement)
                  const contentData = {
                    title: formData.get('title') as string,
                    slug: (formData.get('title') as string).toLowerCase().replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-'),
                    content: formData.get('content') as string,
                    excerpt: formData.get('excerpt') as string,
                    category: formData.get('category') as string,
                    tags: (formData.get('tags') as string).split(',').map(tag => tag.trim()).filter(tag => tag),
                    status: formData.get('status') as string,
                    author: formData.get('author') as string,
                    featuredImage: formData.get('featuredImage') as string,
                    seoTitle: formData.get('seoTitle') as string,
                    seoDescription: formData.get('seoDescription') as string,
                    seoKeywords: formData.get('seoKeywords') as string,
                    isFeatured: formData.get('isFeatured') === 'on',
                    ...(editingContent && { id: editingContent.id })
                  }

                  if (showAddContent) {
                    handleAddContent(contentData)
                    setShowAddContent(false)
                  } else {
                    handleEditContent(contentData)
                    setShowEditContent(false)
                    setEditingContent(null)
                  }
                }} className="p-6 space-y-6">
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-4">
                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          Title *
                        </label>
                        <input
                          type="text"
                          name="title"
                          defaultValue={editingContent?.title || ''}
                          required
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                          placeholder="Enter content title"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          Excerpt
                        </label>
                        <textarea
                          name="excerpt"
                          defaultValue={editingContent?.excerpt || ''}
                          rows={3}
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 resize-none"
                          placeholder="Brief description of the content"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          Category *
                        </label>
                        <select
                          name="category"
                          defaultValue={editingContent?.category || ''}
                          required
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                        >
                          <option value="">Select Category</option>
                          {contentType === 'articles' ? (
                            <>
                              <option value="Market Updates">Market Updates</option>
                              <option value="Investment Guides">Investment Guides</option>
                              <option value="Property News">Property News</option>
                              <option value="Market Analysis">Market Analysis</option>
                            </>
                          ) : (
                            <>
                              <option value="Buying">Buying</option>
                              <option value="Selling">Selling</option>
                              <option value="Finance">Finance</option>
                              <option value="Areas">Areas</option>
                              <option value="Legal">Legal</option>
                            </>
                          )}
                        </select>
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          Tags
                        </label>
                        <input
                          type="text"
                          name="tags"
                          defaultValue={editingContent?.tags?.join(', ') || ''}
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                          placeholder="Enter tags separated by commas"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          Author *
                        </label>
                        <input
                          type="text"
                          name="author"
                          defaultValue={editingContent?.author || 'Dubai Luxury Realty'}
                          required
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                        />
                      </div>
                    </div>

                    <div className="space-y-4">
                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          Featured Image URL
                        </label>
                        <input
                          type="url"
                          name="featuredImage"
                          defaultValue={editingContent?.featuredImage || ''}
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                          placeholder="https://example.com/image.jpg"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          Status *
                        </label>
                        <select
                          name="status"
                          defaultValue={editingContent?.status || 'draft'}
                          required
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                        >
                          <option value="draft">Draft</option>
                          <option value="published">Published</option>
                        </select>
                      </div>

                      <div className="flex items-center gap-2">
                        <input
                          type="checkbox"
                          name="isFeatured"
                          defaultChecked={editingContent?.isFeatured || false}
                          className="rounded border-border"
                        />
                        <label className="text-sm font-medium text-foreground">
                          Featured Content
                        </label>
                      </div>
                    </div>
                  </div>

                  <div>
                    <label className="block text-sm font-medium text-foreground mb-2">
                      Content *
                    </label>
                    <textarea
                      name="content"
                      defaultValue={editingContent?.content || ''}
                      rows={12}
                      required
                      className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 resize-none"
                      placeholder="Write your content here..."
                    />
                  </div>

                  <div className="border-t border-border pt-6">
                    <h3 className="text-lg font-semibold text-foreground mb-4">SEO Settings</h3>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          SEO Title
                        </label>
                        <input
                          type="text"
                          name="seoTitle"
                          defaultValue={editingContent?.seoTitle || ''}
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                          placeholder="Custom SEO title"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-medium text-foreground mb-2">
                          SEO Keywords
                        </label>
                        <input
                          type="text"
                          name="seoKeywords"
                          defaultValue={editingContent?.seoKeywords || ''}
                          className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50"
                          placeholder="keyword1, keyword2, keyword3"
                        />
                      </div>
                    </div>

                    <div className="mt-4">
                      <label className="block text-sm font-medium text-foreground mb-2">
                        SEO Description
                      </label>
                      <textarea
                        name="seoDescription"
                        defaultValue={editingContent?.seoDescription || ''}
                        rows={3}
                        className="w-full px-4 py-3 bg-muted border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 resize-none"
                        placeholder="Meta description for search engines"
                      />
                    </div>
                  </div>

                  <div className="flex justify-end gap-3 border-t border-border pt-6">
                    <button
                      type="button"
                      onClick={() => {
                        setShowAddContent(false)
                        setShowEditContent(false)
                        setEditingContent(null)
                      }}
                      className="px-6 py-2 border border-border rounded-lg hover:bg-muted transition-colors"
                    >
                      Cancel
                    </button>
                    <button
                      type="submit"
                      className="px-6 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors"
                    >
                      {showAddContent ? 'Create Content' : 'Update Content'}
                    </button>
                  </div>
                </form>
              </div>
            </div>
          )}

          {/* Content Details Modal */}
          {showContentDetails && selectedContentDetails && (
            <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
              <div className="bg-background rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="p-6 border-b border-border">
                  <div className="flex items-center justify-between">
                    <h2 className="text-2xl font-bold text-foreground">Content Details</h2>
                    <button
                      onClick={() => {
                        setShowContentDetails(false)
                        setSelectedContentDetails(null)
                      }}
                      className="p-2 hover:bg-muted rounded-lg transition-colors"
                    >
                      <XMarkIcon className="h-5 w-5" />
                    </button>
                  </div>
                </div>

                <div className="p-6 space-y-6">
                  <div className="flex items-start gap-6">
                    {selectedContentDetails.featuredImage && (
                      <img
                        src={selectedContentDetails.featuredImage}
                        alt={selectedContentDetails.title}
                        className="w-32 h-32 rounded-lg object-cover flex-shrink-0"
                      />
                    )}
                    <div className="flex-1">
                      <h3 className="text-2xl font-bold text-foreground mb-2">{selectedContentDetails.title}</h3>
                      <p className="text-muted-foreground mb-4">{selectedContentDetails.excerpt}</p>
                      <div className="flex flex-wrap items-center gap-4">
                        <span className={`px-3 py-1 rounded-full text-sm font-medium ${
                          selectedContentDetails.status === 'published' ? 'bg-green-500/10 text-green-500' : 'bg-yellow-500/10 text-yellow-500'
                        }`}>
                          {selectedContentDetails.status === 'published' ? 'Published' : 'Draft'}
                        </span>
                        <span className="px-3 py-1 bg-primary/10 text-primary text-sm rounded">
                          {selectedContentDetails.category}
                        </span>
                        {selectedContentDetails.isFeatured && (
                          <span className="px-3 py-1 bg-orange-500/10 text-orange-500 text-sm rounded">
                            Featured
                          </span>
                        )}
                      </div>
                    </div>
                  </div>

                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div className="bg-muted/30 rounded-lg p-4">
                      <p className="text-2xl font-bold text-foreground">
                        {contentType === 'articles' ? selectedContentDetails.views : selectedContentDetails.reads}
                      </p>
                      <p className="text-sm text-muted-foreground">
                        {contentType === 'articles' ? 'Views' : 'Reads'}
                      </p>
                    </div>
                    <div className="bg-muted/30 rounded-lg p-4">
                      <p className="text-2xl font-bold text-foreground">
                        {selectedContentDetails.likes || 0}
                      </p>
                      <p className="text-sm text-muted-foreground">Likes</p>
                    </div>
                    <div className="bg-muted/30 rounded-lg p-4">
                      <p className="text-2xl font-bold text-foreground">
                        {selectedContentDetails.comments || 0}
                      </p>
                      <p className="text-sm text-muted-foreground">Comments</p>
                    </div>
                    <div className="bg-muted/30 rounded-lg p-4">
                      <p className="text-2xl font-bold text-foreground">
                        {selectedContentDetails.readingTime || 5}
                      </p>
                      <p className="text-sm text-muted-foreground">Min Read</p>
                    </div>
                  </div>

                  <div>
                    <h4 className="text-lg font-semibold text-foreground mb-3">Content</h4>
                    <div className="bg-muted/30 rounded-lg p-4 max-h-96 overflow-y-auto">
                      <div className="prose prose-sm max-w-none text-foreground whitespace-pre-wrap">
                        {selectedContentDetails.content}
                      </div>
                    </div>
                  </div>

                  {selectedContentDetails.tags && selectedContentDetails.tags.length > 0 && (
                    <div>
                      <h4 className="text-lg font-semibold text-foreground mb-3">Tags</h4>
                      <div className="flex flex-wrap gap-2">
                        {selectedContentDetails.tags.map((tag: string, index: number) => (
                          <span key={index} className="px-3 py-1 bg-muted text-foreground text-sm rounded">
                            {tag}
                          </span>
                        ))}
                      </div>
                    </div>
                  )}

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <h4 className="text-lg font-semibold text-foreground mb-3">Publishing Info</h4>
                      <div className="space-y-2 text-sm">
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Author:</span>
                          <span className="text-foreground">{selectedContentDetails.author}</span>
                        </div>
                        <div className="flex justify-between">
                          <span className="text-muted-foreground">Created:</span>
                          <span className="text-foreground">
                            {new Date(selectedContentDetails.updatedAt).toLocaleDateString()}
                          </span>
                        </div>
                        {selectedContentDetails.publishedAt && (
                          <div className="flex justify-between">
                            <span className="text-muted-foreground">Published:</span>
                            <span className="text-foreground">
                              {new Date(selectedContentDetails.publishedAt).toLocaleDateString()}
                            </span>
                          </div>
                        )}
                      </div>
                    </div>

                    <div>
                      <h4 className="text-lg font-semibold text-foreground mb-3">SEO Information</h4>
                      <div className="space-y-2 text-sm">
                        <div>
                          <span className="text-muted-foreground">SEO Title:</span>
                          <p className="text-foreground mt-1">
                            {selectedContentDetails.seoTitle || 'Not set'}
                          </p>
                        </div>
                        <div>
                          <span className="text-muted-foreground">SEO Description:</span>
                          <p className="text-foreground mt-1">
                            {selectedContentDetails.seoDescription || 'Not set'}
                          </p>
                        </div>
                        <div>
                          <span className="text-muted-foreground">Keywords:</span>
                          <p className="text-foreground mt-1">
                            {selectedContentDetails.seoKeywords || 'Not set'}
                          </p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

      </div>
    
  )
}
